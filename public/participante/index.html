<!doctype html>
<html lang="pt-BR" class="dark">
    <head>
        <meta charset="UTF-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
        />

        <!-- ✅ META TAGS ANTI-CACHE (evita White Screen of Death) -->
        <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
        <meta http-equiv="Pragma" content="no-cache" />
        <meta http-equiv="Expires" content="0" />

        <meta name="theme-color" content="#0a0a0a" />
        <meta name="mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta
            name="apple-mobile-web-app-status-bar-style"
            content="black-translucent"
        />
        <meta name="apple-mobile-web-app-title" content="Super Cartola" />

        <title>Super Cartola - Participante</title>
        <link rel="icon" href="../favicon.png" />
        
        <!-- ✅ PWA Manifest -->
        <link rel="manifest" href="manifest.json" />
        <link rel="apple-touch-icon" href="/escudos/default.png" />

        <!-- TAILWIND CDN + CONFIG -->
        <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
        <script>
            tailwind.config = {
                darkMode: "class",
                theme: {
                    extend: {
                        colors: {
                            primary: "#FF5500", /* Padronizado com _app-tokens.css */
                            "background-light": "#f6f8f7",
                            "background-dark": "#101010",
                            "surface-dark": "#1c1c1c",
                        },
                        fontFamily: {
                            display: ["Inter", "-apple-system", "sans-serif"],
                            brand: ["Russo One", "sans-serif"],  /* Fonte brand para títulos/stats */
                            mono: ["JetBrains Mono", "monospace"],
                        },
                    },
                },
            };
        </script>

        <!-- MATERIAL ICONS -->
        <link
            rel="stylesheet"
            href="https://fonts.googleapis.com/icon?family=Material+Icons"
        />
        <link
            rel="stylesheet"
            href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
        />

        <!-- FONTS -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;600;700&display=swap"
            rel="stylesheet"
        />
        <link
            href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700;800&display=swap"
            rel="stylesheet"
        />
        <!-- TEASER 2026: Fontes Russo One e Inter -->
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Russo+One&display=swap"
            rel="stylesheet"
        />

        <!-- TEASER 2026: Phosphor Icons -->
        <script src="https://unpkg.com/@phosphor-icons/web"></script>

        <!-- TEASER 2026: Confetti -->
        <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

        <!-- Design Tokens (SEMPRE PRIMEIRO) -->
        <link rel="stylesheet" href="css/_app-tokens.css" />
        <!-- CSS BASE -->
        <link rel="stylesheet" href="css/participante.css" />

        <!-- ✅ Splash Screen CSS -->
        <link rel="stylesheet" href="css/splash-screen.css" />

        <!-- ✅ Pull-to-Refresh CSS (Bola Quicando) -->
        <link rel="stylesheet" href="css/pull-refresh.css" />

        <!-- ✅ Sistema de Versionamento -->
        <link rel="stylesheet" href="/css/app/app-version.css" />

        <!-- ✅ Quick Access Bar -->
        <link rel="stylesheet" href="css/quick-access-bar.css" />

        <!-- ✅ CSS CRÍTICO INLINE v7 - Manipulação via JS, CSS é fallback -->
        <style id="critical-splash-fix">
            /* ============================================
               SPLASH - CAMADA SUPREMA SOBRE TUDO
               ============================================ */
            #splashScreen {
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                right: 0 !important;
                bottom: 0 !important;
                z-index: 999999 !important;
                background: #0a0a0a !important;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
            }

            /* Estado: ESCONDIDO - quando JS define display:none ou .hidden */
            #splashScreen.hidden {
                display: none !important;
                opacity: 0 !important;
                visibility: hidden !important;
            }

            /* ============================================
               ESCUDOS - TAMANHO FIXO (PREVINE FOUC)
               ============================================ */
            img.escudo-mini-modern,
            #escudoTime {
                width: 40px !important;
                height: 40px !important;
                max-width: 40px !important;
                max-height: 40px !important;
                object-fit: contain;
            }

            img.escudo-coracao-modern,
            #escudoCoracao {
                width: 24px !important;
                height: 24px !important;
                max-width: 24px !important;
                max-height: 24px !important;
                object-fit: contain;
            }

            /* ============================================
               LOGO SPLASH - SEM DUPLICAÇÃO
               ============================================ */
            .splash-logo-glow {
                background: #FF4500 !important;
                background-image: none !important;
            }

            .splash-logo-img {
                filter: none !important;
                width: 180px !important;
                height: 180px !important;
            }

            /* ============================================
               iOS SAFE AREA
               ============================================ */
            @supports (padding: env(safe-area-inset-top)) {
                body {
                    padding-top: env(safe-area-inset-top);
                    padding-bottom: env(safe-area-inset-bottom);
                }
            }
        </style>

        <style>
            .material-symbols-outlined {
                font-family: "Material Symbols Outlined";
                font-weight: normal;
                font-style: normal;
                font-size: 24px;
                line-height: 1;
                letter-spacing: normal;
                text-transform: none;
                display: inline-block;
                white-space: nowrap;
                word-wrap: normal;
                direction: ltr;
                font-variation-settings:
                    "FILL" 1,
                    "wght" 400,
                    "GRAD" 0,
                    "opsz" 24;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .material-icons {
                font-family: "Material Icons";
                font-weight: normal;
                font-style: normal;
                font-size: 24px;
                line-height: 1;
                letter-spacing: normal;
                text-transform: none;
                display: inline-block;
                white-space: nowrap;
                word-wrap: normal;
                direction: ltr;
                -webkit-font-smoothing: antialiased;
            }

            ::-webkit-scrollbar {
                width: 4px;
                height: 4px;
            }
            ::-webkit-scrollbar-track {
                background: #1c1c1c;
            }
            ::-webkit-scrollbar-thumb {
                background: #ff5c00;
                border-radius: 2px;
            }

            @keyframes spin {
                to {
                    transform: rotate(360deg);
                }
            }
            .animate-spin {
                animation: spin 0.8s linear infinite;
            }

            /* HEADER STYLES */
            .header-secondary {
                max-height: 0;
                overflow: hidden;
                transition: max-height 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                background: rgba(0, 0, 0, 0.2);
            }
            .header-secondary.active {
                max-height: 120px;
            }
            .secondary-content {
                display: flex;
                align-items: center;
                justify-content: flex-start;
                flex-wrap: wrap;
                padding: 10px 12px;
                gap: 8px;
            }
            .liga-selector {
                flex: 0 1 auto;
                min-width: 120px;
                max-width: 200px;
                padding: 8px 12px;
                border-radius: 6px;
                border: 1px solid rgba(255, 255, 255, 0.2);
                background: rgba(0, 0, 0, 0.3);
                color: white;
                font-size: 12px;
                font-weight: 600;
                cursor: pointer;
                text-overflow: ellipsis;
                overflow: hidden;
                white-space: nowrap;
            }
            .btn-logout {
                padding: 8px 14px;
                border-radius: 6px;
                border: 2px solid rgba(255, 69, 0, 0.4);
                background: rgba(255, 69, 0, 0.15);
                color: white;
                font-size: 12px;
                font-weight: 600;
                cursor: pointer;
                white-space: nowrap;
                transition: all 0.2s;
                -webkit-tap-highlight-color: transparent;
            }
            .btn-logout:active {
                transform: scale(0.95);
                background: rgba(255, 69, 0, 0.25);
            }
            .btn-logout:disabled {
                opacity: 0.6;
                cursor: not-allowed;
            }

            /* LIGA BADGE - Seletor de liga inline */
            .liga-badge-container {
                margin-top: 4px;
            }
            .liga-badge {
                display: inline-flex;
                align-items: center;
                gap: 4px;
                padding: 4px 10px;
                background: linear-gradient(135deg, rgba(255, 69, 0, 0.2), rgba(255, 69, 0, 0.1));
                border: 1px solid rgba(255, 69, 0, 0.4);
                border-radius: 20px;
                color: #ff8c42;
                font-size: 11px;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.2s ease;
                -webkit-tap-highlight-color: transparent;
            }
            .liga-badge:active {
                transform: scale(0.95);
                background: linear-gradient(135deg, rgba(255, 69, 0, 0.3), rgba(255, 69, 0, 0.2));
            }
            .liga-badge .swap-icon {
                opacity: 0.7;
                animation: pulse-swap 2s infinite;
            }
            @keyframes pulse-swap {
                0%, 100% { opacity: 0.5; }
                50% { opacity: 1; }
            }

            /* Modal de seleção de liga */
            .liga-modal-overlay {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.85);
                backdrop-filter: blur(4px);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
                animation: fadeIn 0.2s ease;
            }
            .liga-modal-content {
                background: #1c1c1c;
                border-radius: 16px;
                padding: 20px;
                max-width: 340px;
                width: 90%;
                border: 1px solid rgba(255, 255, 255, 0.1);
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
                animation: slideUp 0.3s ease;
            }
            .liga-modal-header {
                display: flex;
                align-items: center;
                justify-content: space-between;
                margin-bottom: 16px;
            }
            .liga-modal-title {
                display: flex;
                align-items: center;
                gap: 8px;
                color: white;
                font-size: 16px;
                font-weight: 600;
            }
            .liga-modal-close {
                background: none;
                border: none;
                color: #666;
                cursor: pointer;
                padding: 4px;
                border-radius: 50%;
                transition: all 0.2s;
            }
            .liga-modal-close:active {
                background: rgba(255, 255, 255, 0.1);
                color: white;
            }
            .liga-option {
                display: flex;
                align-items: center;
                gap: 12px;
                padding: 14px 16px;
                background: rgba(255, 255, 255, 0.05);
                border: 1px solid rgba(255, 255, 255, 0.1);
                border-radius: 12px;
                margin-bottom: 8px;
                cursor: pointer;
                transition: all 0.2s;
            }
            .liga-option:active {
                transform: scale(0.98);
                background: rgba(255, 69, 0, 0.2);
                border-color: #ff4500;
            }
            .liga-option.atual {
                background: rgba(255, 69, 0, 0.15);
                border-color: rgba(255, 69, 0, 0.5);
            }
            .liga-option-icon {
                width: 40px;
                height: 40px;
                background: linear-gradient(135deg, #ff4500, #ff6b35);
                border-radius: 10px;
                display: flex;
                align-items: center;
                justify-content: center;
            }
            .liga-option-icon .material-symbols-outlined {
                color: white;
                font-size: 20px;
            }
            .liga-option-info {
                flex: 1;
            }
            .liga-option-nome {
                color: white;
                font-weight: 600;
                font-size: 14px;
            }
            .liga-option-atual-badge {
                display: inline-block;
                margin-left: 6px;
                padding: 2px 6px;
                background: #ff4500;
                color: white;
                font-size: 9px;
                font-weight: 700;
                border-radius: 4px;
            }
            .liga-option-times {
                color: #888;
                font-size: 11px;
                margin-top: 2px;
            }
            .liga-option-check {
                color: #22c55e;
                opacity: 0;
            }
            .liga-option.atual .liga-option-check {
                opacity: 1;
            }

            /* ============================================
               OVERLAY DE RELOAD (Vidro Fosco) - DEFINITIVO
               ============================================ */
            #reload-glass-overlay {
                position: fixed !important;
                inset: 0;
                width: 100vw;
                height: 100vh;
                background-color: rgba(20, 20, 20, 0.5);
                backdrop-filter: blur(15px);
                -webkit-backdrop-filter: blur(15px);
                z-index: 999999;
                display: flex;
                justify-content: center;
                align-items: center;
                opacity: 0;
                pointer-events: none;
                transition: opacity 0.15s ease-out;
            }

            #reload-glass-overlay.is-active {
                opacity: 1;
                pointer-events: all;
            }

            /* Bolinha Quicando CSS */
            .reload-ball-container {
                display: flex;
                flex-direction: column;
                align-items: center;
            }

            .reload-ball {
                width: 56px;
                height: 56px;
                display: flex;
                align-items: center;
                justify-content: center;
                animation: reloadBounce 0.5s infinite;
            }

            .reload-ball .material-icons {
                font-size: 56px;
                color: white;
                animation: reloadSpin 1s linear infinite;
            }

            .reload-ball-shadow {
                width: 40px;
                height: 10px;
                background: rgba(255, 69, 0, 0.6);
                border-radius: 50%;
                filter: blur(4px);
                margin-top: 8px;
                animation: reloadShadow 0.5s infinite;
            }

            @keyframes reloadBounce {
                0%, 100% {
                    transform: translateY(0);
                    animation-timing-function: cubic-bezier(0, 0, 0.2, 1);
                }
                50% {
                    transform: translateY(-25px);
                    animation-timing-function: cubic-bezier(0.8, 0, 1, 1);
                }
            }

            @keyframes reloadSpin {
                from { transform: rotate(0deg); }
                to { transform: rotate(360deg); }
            }

            @keyframes reloadShadow {
                0%, 100% { transform: scale(1); opacity: 0.6; }
                50% { transform: scale(0.5); opacity: 0.2; }
            }

            /* ============================================
               TEASER 2026 - Black & Laranja Intenso
               ============================================ */
            :root {
                --orange-primary: #FF5500;
                --orange-light: #FF8800;
                --black-bg: #050505;
            }

            .font-brand {
                font-family: 'Russo One', sans-serif;
            }

            .text-gradient-orange {
                background: linear-gradient(90deg, #FF5500, #FFAA00);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
                text-shadow: 0 0 30px rgba(255, 85, 0, 0.4);
            }

            .modal-enter {
                animation: zoomIn 0.5s cubic-bezier(0.19, 1, 0.22, 1) forwards;
            }

            @keyframes zoomIn {
                0% { opacity: 0; transform: scale(0.9) translateY(20px); }
                100% { opacity: 1; transform: scale(1) translateY(0); }
            }

            /* Scrollbar Discreta para Modal Teaser */
            .custom-scroll::-webkit-scrollbar {
                width: 3px;
            }
            .custom-scroll::-webkit-scrollbar-thumb {
                background: #333;
                border-radius: 4px;
            }
        </style>
    </head>
    <body class="bg-background-dark font-display text-white">

        <!-- ✅ FORCE CACHE CLEAR v7 - Executa após página carregar -->
        <script>
            (function() {
                var FORCE_CLEAR_KEY = 'sw_force_clear_v7';

                // Se ainda não limpou nesta versão, agenda limpeza após carregamento
                if (!localStorage.getItem(FORCE_CLEAR_KEY)) {
                    // Marcar imediatamente para evitar múltiplas execuções
                    localStorage.setItem(FORCE_CLEAR_KEY, 'pending');

                    // Executar limpeza apenas APÓS página carregar completamente
                    window.addEventListener('load', function() {
                        setTimeout(function() {
                            if ('caches' in window) {
                                caches.keys().then(function(names) {
                                    return Promise.all(names.map(function(name) {
                                        return caches.delete(name);
                                    }));
                                }).then(function() {
                                    localStorage.setItem(FORCE_CLEAR_KEY, Date.now().toString());
                                }).catch(function() {
                                    localStorage.setItem(FORCE_CLEAR_KEY, Date.now().toString());
                                });
                            } else {
                                localStorage.setItem(FORCE_CLEAR_KEY, Date.now().toString());
                            }
                        }, 2000); // Aguarda 2s após load para não interferir
                    });
                }
            })();
        </script>

        <!-- ✅ SPLASH SCREEN - PRIMEIRO ELEMENTO DO BODY (para scripts poderem manipulá-lo) -->
        <div id="splashScreen" class="splash-screen hidden">
            <!-- Fundo Tático -->
            <div class="splash-tactical-bg">
                <svg viewBox="0 0 320 640" preserveAspectRatio="xMidYMid slice">
                    <defs>
                        <pattern id="grid" width="32" height="32" patternUnits="userSpaceOnUse">
                            <rect width="32" height="32" fill="none" stroke="rgba(255,255,255,0.03)" stroke-width="0.5"/>
                        </pattern>
                        <marker id="arrow" markerWidth="8" markerHeight="8" refX="7" refY="3" orient="auto">
                            <path d="M0,0 L0,6 L8,3 z" fill="#FF4500"/>
                        </marker>
                    </defs>
                    <rect width="100%" height="100%" fill="url(#grid)"/>
                    <circle cx="160" cy="320" r="40" fill="none" stroke="rgba(255,255,255,0.08)" stroke-width="1.5"/>
                    <line x1="0" y1="320" x2="320" y2="320" stroke="rgba(255,255,255,0.08)" stroke-width="1.5"/>
                    <text x="40" y="480" fill="rgba(255,255,255,0.2)" font-size="16" font-weight="bold" class="splash-tactical-x delay-1">X</text>
                    <path class="splash-tactical-line delay-1" d="M50 470 Q 90 400 130 360" fill="none" stroke="#FF4500" stroke-width="2" stroke-dasharray="4,4" marker-end="url(#arrow)"/>
                    <circle cx="160" cy="520" r="6" fill="none" stroke="rgba(255,255,255,0.2)" stroke-width="1.5" class="splash-tactical-x delay-2"/>
                    <path class="splash-tactical-line delay-2" d="M160 510 L160 420" fill="none" stroke="rgba(255,255,255,0.15)" stroke-width="1.5"/>
                    <text x="260" y="400" fill="rgba(255,255,255,0.2)" font-size="16" font-weight="bold" class="splash-tactical-x delay-3">X</text>
                    <path class="splash-tactical-line delay-3" d="M250 390 Q 200 350 170 300" fill="none" stroke="#FF4500" stroke-width="2" stroke-dasharray="4,4" marker-end="url(#arrow)"/>
                </svg>
            </div>
            <div class="splash-glow"></div>
            <div class="splash-content">
                <div class="splash-greeting">
                    <h2>Fala aí Parça!</h2>
                </div>
                <div class="splash-logo-container">
                    <div class="splash-logo-glow"></div>
                    <img src="/escudos/default.png" alt="Super Cartola Logo" class="splash-logo-img">
                </div>
                <div class="splash-loader">
                    <div class="splash-ball-container">
                        <div class="splash-ball">
                            <span class="material-icons">sports_soccer</span>
                        </div>
                        <div class="splash-ball-shadow"></div>
                    </div>
                    <span class="splash-loader-text">Carregando meu time...</span>
                </div>
            </div>
            <div class="splash-footer">
                <p>Ano 11 • Super Cartola</p>
            </div>
        </div>
        <!-- FIM SPLASH SCREEN -->

        <!-- ✅ OVERLAY DE RELOAD (Vidro Fosco) -->
        <div id="reload-glass-overlay">
            <div class="reload-ball-container">
                <div class="reload-ball">
                    <span class="material-icons">sports_soccer</span>
                </div>
                <div class="reload-ball-shadow"></div>
            </div>
        </div>

        <!-- ✅ SCRIPT IMEDIATO - Detecção Ultra-Rápida de Reload v4 (AGORA SPLASH JÁ EXISTE NO DOM) -->
        <script>
            (function() {
                // ✅ CHAVE ESPECÍFICA do app participante (não compartilhada com login)
                var PARTICIPANTE_LOADED_KEY = 'participante_app_loaded';
                var isReload = sessionStorage.getItem(PARTICIPANTE_LOADED_KEY);
                var glassOverlay = document.getElementById('reload-glass-overlay');
                var splashScreen = document.getElementById('splashScreen');

                console.log('[RELOAD-DETECT] isReload:', !!isReload);

                if (isReload) {
                    // É RELOAD/PULL-REFRESH: Esconde Splash, mostra Vidro Fosco
                    if (splashScreen) {
                        splashScreen.style.display = 'none';
                        splashScreen.classList.add('hidden');
                        splashScreen.classList.remove('animate');
                    }
                    if (glassOverlay) glassOverlay.classList.add('is-active');

                    // ✅ v3: Revelar app via estilo inline direto (cross-platform)
                    document.body.classList.add('app-ready');
                    var container = document.querySelector('.participante-container');
                    var bottomNav = document.querySelector('.bottom-nav-modern');
                    if (container) container.style.cssText = 'display:flex !important;flex-direction:column;';
                    if (bottomNav) bottomNav.style.cssText = 'display:flex !important;';

                    console.log('[RELOAD-DETECT] App revelado (reload)');

                    // Remove o overlay assim que o conteúdo carregar
                    window.addEventListener('load', function() {
                        setTimeout(function() {
                            if (glassOverlay) glassOverlay.classList.remove('is-active');
                        }, 800);
                    });
                } else {
                    // ✅ v3: Primeira visita - exibir splash imediatamente
                    if (splashScreen) {
                        // Remover .hidden e adicionar .animate para exibir
                        splashScreen.classList.remove('hidden');
                        splashScreen.classList.add('animate');
                        // Também definir estilos inline para garantia
                        splashScreen.style.display = 'flex';
                        splashScreen.style.opacity = '1';
                        splashScreen.style.visibility = 'visible';
                        splashScreen.style.pointerEvents = 'all';
                    }
                    console.log('[RELOAD-DETECT] Primeira visita - splash EXIBIDA');
                }
            })();
        </script>

        <!-- ✅ FAILSAFE JS DE EMERGÊNCIA v3 - Força splash esconder após 6s -->
        <script>
            (function() {
                // Failsafe: Se após 6 segundos a splash ainda estiver visível, força esconder
                setTimeout(function() {
                    var splash = document.getElementById('splashScreen');
                    var overlay = document.getElementById('reload-glass-overlay');
                    var container = document.querySelector('.participante-container');
                    var bottomNav = document.querySelector('.bottom-nav-modern');

                    console.log('[FAILSAFE] Verificando estado após 6s...');

                    // Esconder splash se ainda visível
                    if (splash && (splash.classList.contains('animate') ||
                        getComputedStyle(splash).display !== 'none')) {
                        console.warn('[FAILSAFE] Forçando splash a esconder após 6s');
                        splash.style.display = 'none';
                        splash.style.opacity = '0';
                        splash.style.visibility = 'hidden';
                        splash.classList.remove('animate');
                        splash.classList.add('hidden');
                    }

                    // Esconder overlay de reload se ainda estiver ativo
                    if (overlay && overlay.classList.contains('is-active')) {
                        console.warn('[FAILSAFE] Forçando overlay a esconder após 6s');
                        overlay.classList.remove('is-active');
                    }

                    // ✅ v3: Garantir que app está revelado (estilos inline diretos)
                    if (!document.body.classList.contains('app-ready') ||
                        (container && getComputedStyle(container).display === 'none')) {
                        console.warn('[FAILSAFE] Revelando app forçado');
                        document.body.classList.add('app-ready');
                        if (container) container.style.cssText = 'display:flex !important;flex-direction:column;';
                        if (bottomNav) bottomNav.style.cssText = 'display:flex !important;';
                    }
                }, 6000);
            })();
        </script>
        <!-- ✅ FALLBACK: Estilos inline garantem que app fique oculto até estar pronto -->
        <div class="participante-container" style="display:none !important;">
            <!-- HEADER STICKY -->
            <header class="participante-header-modern">
                <div class="header-main-modern">
                    <div class="header-info-group">
                        <div class="escudos-mini-modern">
                            <!-- ✅ FALLBACK: Tamanho inline previne escudos gigantes -->
                            <img
                                id="escudoTime"
                                class="escudo-mini-modern"
                                src="/escudos/placeholder.png"
                                alt="Time"
                                style="width:40px;height:40px;max-width:40px;max-height:40px;"
                            />
                            <img
                                id="escudoCoracao"
                                class="escudo-coracao-modern"
                                src="/escudos/placeholder.png"
                                alt="Coração"
                                style="width:24px;height:24px;max-width:24px;max-height:24px;"
                            />
                        </div>
                        <div class="info-participante-modern">
                            <h1 id="nomeTime">&nbsp;</h1>
                            <p id="nomeCartoleiro">
                                <span id="nomeCartolaText">&nbsp;</span>
                                <span
                                    id="app-version-badge"
                                    class="app-version-badge text-[9px] bg-white/10 px-1.5 py-0.5 rounded"
                                    ></span
                                >
                                <span
                                    id="app-env-badge"
                                    class="text-[9px] bg-red-500/20 border border-red-500/50 text-red-400 px-1.5 py-0.5 rounded ml-1 font-bold uppercase hidden"
                                    >DEV</span
                                >
                            </p>
                            <!-- Badge de Liga Clicável -->
                            <div id="ligaBadgeContainer" class="liga-badge-container" style="display: none;">
                                <button id="ligaBadge" class="liga-badge" title="Clique para trocar de liga">
                                    <span id="ligaBadgeIcone" class="material-symbols-outlined" style="font-size: 14px;">emoji_events</span>
                                    <span id="ligaBadgeNome">Liga</span>
                                    <span class="material-symbols-outlined swap-icon" style="font-size: 12px;">swap_horiz</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <button
                        id="headerMenuToggle"
                        class="header-toggle-btn"
                        title="Menu"
                    >
                        <span class="material-icons">more_vert</span>
                    </button>
                </div>

                <!-- HEADER SECUNDÁRIO (COLLAPSED) -->
                <!-- ✅ v2.2: Seletor de temporada REMOVIDO - Hall da Fama serve para histórico -->
                <div id="headerSecondary" class="header-secondary">
                    <div class="secondary-content">
                        <select id="seletorLiga" class="liga-selector">
                            <option></option>
                        </select>
                        <button id="btnLogout" class="btn-logout">
                            <span class="material-icons text-sm mr-1"
                                >logout</span
                            >
                            Sair
                        </button>
                    </div>
                </div>
            </header>

            <script>
                document.addEventListener("DOMContentLoaded", function () {
                    const toggle = document.getElementById("headerMenuToggle");
                    const secondary =
                        document.getElementById("headerSecondary");
                    const btnLogout = document.getElementById("btnLogout");

                    // Toggle menu
                    if (toggle && secondary) {
                        toggle.addEventListener("click", () => {
                            secondary.classList.toggle("active");
                            toggle.style.transform =
                                secondary.classList.contains("active")
                                    ? "rotate(90deg)"
                                    : "rotate(0deg)";
                        });
                    }

                    // ✅ LOGOUT - Event listener no botão
                    if (btnLogout) {
                        btnLogout.addEventListener("click", logout);
                    }
                });
            </script>

            <!-- Container para módulos -->
            <main id="moduleContainer" class="module-container">
                <!-- Estado inicial vazio (será substituído pelo módulo) -->
                <div id="initial-loading" class="flex justify-center items-center min-h-[400px]">
                    <!-- Vazio - evita flash de conteúdo durante splash -->
                </div>
            </main>
        </div>

        <!-- ✅ ERROR HANDLER GLOBAL v2 - Captura erros e revela app -->
        <script>
            function __emergencyRevealApp() {
                console.warn('[ERROR-HANDLER] Revelação de emergência do app');
                var splash = document.getElementById('splashScreen');
                var overlay = document.getElementById('reload-glass-overlay');
                var container = document.querySelector('.participante-container');
                var bottomNav = document.querySelector('.bottom-nav-modern');

                // Esconder splash
                if (splash) {
                    splash.style.display = 'none';
                    splash.classList.remove('animate');
                    splash.classList.add('hidden');
                }
                // Esconder overlay
                if (overlay) overlay.classList.remove('is-active');
                // Revelar app
                document.body.classList.add('app-ready');
                if (container) container.style.cssText = 'display:flex !important;flex-direction:column;';
                if (bottomNav) bottomNav.style.cssText = 'display:flex !important;';
            }

            window.onerror = function(msg, url, line, col, error) {
                console.error('[GLOBAL ERROR]', msg, url, line, error);
                __emergencyRevealApp();
                return false;
            };
            window.addEventListener('unhandledrejection', function(event) {
                console.error('[UNHANDLED PROMISE]', event.reason);
                __emergencyRevealApp();
            });
        </script>

        <!-- ✅ LogManager PRIMEIRO (antes de todos os outros scripts) -->
        <script src="/js/core/log-manager.js"></script>

        <!-- Core Systems -->
        <script type="module" src="/js/core/cache-manager.js"></script>
        <script type="module" src="/js/core/api-client.js"></script>

        <!-- ✅ Splash Screen JS -->
        <script src="js/splash-screen.js"></script>

        <!-- ✅ Sistema de Cache Offline (IndexedDB) - ANTES do cache-manager -->
        <script src="js/participante-config.js"></script>
        <script src="js/participante-offline-cache.js"></script>

        <!-- ✅ Config opcional do auto-refresh das parciais (ajuste por ambiente) -->
        <script>
            // window.PARCIAIS_REFRESH_MIN_MS = 15000;
            // window.PARCIAIS_REFRESH_MAX_MS = 120000;
            // window.PARCIAIS_REFRESH_BASE_MS = 20000;
        </script>

        <!-- ✅ Cache Manager Participante (usa OfflineCache) -->
        <script src="js/participante-cache-manager.js"></script>

        <!-- Utils (formatação de moeda) -->
        <script src="js/participante-utils.js"></script>

        <!-- Scripts participante -->
        <script src="js/participante-auth.js"></script>
        <script src="js/participante-navigation.js"></script>
        <script src="js/participante-season-selector.js" type="module"></script>
        <script src="js/participante-status.js"></script>
        <!-- Live Results Module -->
        <script type="module" src="js/modules/participante-live-results.js"></script>

        <!-- ✅ Pull-to-Refresh (Bola Quicando) -->
        <script src="js/pull-refresh.js"></script>

        <!-- ✅ Botão de Atualização Manual (Temporada Encerrada) -->
        <script src="js/participante-refresh-button.js"></script>

        <!-- ✅ Sistema de Versionamento (com PWA) -->
        <script src="/js/app/app-version.js"></script>

        <!-- ✅ PWA Install Prompt (v1.0) -->
        <script src="js/install-prompt.js"></script>

        <!-- ✅ Quick Access Bar -->
        <script src="js/participante-quick-bar.js"></script>

        <!-- ============================================
             TEASER TEMPORADA 2026 - Botão Flutuante + Modal
             ============================================ -->

        <!-- Botão Flutuante "Vem aí" - OCULTO até admin disparar 2026 -->
        <button onclick="abrirTeaser()" style="display:none !important;" class="fixed bottom-24 right-4 z-40 flex items-center gap-3 px-5 py-3 bg-[#0a0a0a] border border-[#FF5500]/40 backdrop-blur-xl rounded-full shadow-[0_0_25px_rgba(255,85,0,0.3)] hover:scale-105 transition-transform group ring-1 ring-white/5">
            <i class="ph-fill ph-rocket-launch text-xl group-hover:animate-bounce text-[#FF5500]"></i>
            <div class="flex flex-col items-start leading-none">
                <span class="text-[9px] text-gray-400 uppercase tracking-widest font-bold">Vem aí</span>
                <span class="font-brand text-sm text-white tracking-wide">SUPER CARTOLA <span class="text-[#FF5500]">26</span></span>
            </div>
        </button>

        <!-- Modal Teaser 2026 -->
        <div id="modal-overlay" class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/95 backdrop-blur-sm hidden transition-opacity duration-300 opacity-0" style="z-index: 9999;">
            <div id="modal-card" class="relative w-full max-w-md rounded-2xl overflow-hidden text-center transform scale-95 opacity-0 shadow-2xl flex flex-col max-h-[85vh] border border-white/10 bg-[#0f1012]">
                <!-- Barra laranja superior -->
                <div class="h-1 w-full bg-gradient-to-r from-[#FF5500] to-[#FF8800] shadow-[0_0_25px_rgba(255,85,0,0.6)]"></div>

                <div class="p-6 overflow-y-auto custom-scroll relative">
                    <!-- Logo da Liga (se existir) -->
                    <div id="teaser-logo-liga" class="mb-4"></div>

                    <!-- Título -->
                    <div class="mb-6">
                        <h2 class="text-gray-500 text-[10px] font-bold tracking-[0.4em] uppercase mb-1">ROADMAP OFICIAL</h2>
                        <h1 class="text-3xl font-brand italic leading-none text-white">SUPER CARTOLA <span class="text-gradient-orange">2026</span></h1>
                    </div>

                    <!-- Card Lançamentos Exclusivos -->
                    <div class="bg-[#161618] border border-[#FF5500]/30 rounded-xl p-4 mb-5 relative overflow-hidden group shadow-[0_10px_30px_-10px_rgba(0,0,0,0.5)] text-left">
                        <div class="absolute top-0 right-0 w-40 h-40 blur-[80px] opacity-10 group-hover:opacity-20 transition bg-[#FF5500]"></div>
                        <div class="flex items-center gap-2 mb-4">
                            <i class="ph-fill ph-fire text-[#FF5500] text-lg animate-pulse"></i>
                            <span class="text-xs font-bold uppercase tracking-widest text-white">Lançamentos Exclusivos</span>
                        </div>
                        <div class="space-y-2">
                            <div class="flex items-center gap-3 p-3 rounded bg-black/40 hover:bg-black/60 transition border border-white/5 group/item">
                                <i class="ph-fill ph-crosshair text-lg text-[#FF5500]"></i>
                                <div><span class="block text-white text-xs font-bold uppercase">Liga Tiro Certo</span><span class="block text-[10px] text-gray-400">Modo Survival: Errou, caiu.</span></div>
                            </div>
                            <div class="flex items-center gap-3 p-3 rounded bg-black/40 hover:bg-black/60 transition border border-white/5 group/item">
                                <i class="ph-fill ph-globe-hemisphere-west text-lg text-[#FF5500]"></i>
                                <div><span class="block text-white text-xs font-bold uppercase">Bolão Copa & Liberta</span><span class="block text-[10px] text-gray-400">Integrados no App.</span></div>
                            </div>
                        </div>
                    </div>

                    <!-- O Retorno dos Lendas -->
                    <div class="mb-6 text-left">
                        <div class="flex items-center gap-2 mb-3 px-1">
                            <i class="ph-fill ph-arrow-u-up-left text-sm text-[#FF5500]"></i>
                            <span class="text-[10px] font-bold uppercase tracking-widest text-gray-400">O Retorno dos Lendas</span>
                        </div>
                        <div class="grid grid-cols-2 gap-2">
                            <div class="px-3 py-2 rounded border border-white/5 bg-[#161618] text-gray-300 text-[10px] font-bold uppercase flex items-center gap-2">
                                <i class="ph-bold ph-users-three text-[#FF5500]"></i> Resta Um
                            </div>
                            <div class="px-3 py-2 rounded border border-white/5 bg-[#161618] text-gray-300 text-[10px] font-bold uppercase flex items-center gap-2">
                                <i class="ph-bold ph-hand-fist text-[#FF5500]"></i> Luva de Ouro
                            </div>
                            <div class="px-3 py-2 rounded border border-white/5 bg-[#161618] text-gray-300 text-[10px] font-bold uppercase flex items-center gap-2">
                                <i class="ph-bold ph-soccer-ball text-[#FF5500]"></i> Artilheiro
                            </div>
                            <div class="px-3 py-2 rounded border border-white/5 bg-[#161618] text-gray-300 text-[10px] font-bold uppercase flex items-center gap-2">
                                <i class="ph-bold ph-crown text-[#FF5500]"></i> Capitão Luxo
                            </div>
                        </div>
                    </div>

                    <!-- Countdown Duplo: Mercado + Brasileirao -->
                    <div id="countdown-container" class="mb-4 space-y-3">
                        <!-- Countdown Mercado (principal) -->
                        <div id="countdown-market" class="p-4 rounded-xl bg-gradient-to-r from-[#FF5500]/20 to-transparent border border-[#FF5500]/40 relative overflow-hidden">
                            <div class="absolute top-0 right-0 w-32 h-32 bg-[#FF5500] blur-[60px] opacity-20"></div>
                            <div class="flex items-center justify-between relative">
                                <div class="flex items-center gap-3">
                                    <div class="w-12 h-12 rounded-full bg-[#FF5500]/20 flex items-center justify-center border border-[#FF5500]/40">
                                        <i class="ph-fill ph-shopping-cart text-2xl text-[#FF5500]"></i>
                                    </div>
                                    <div class="text-left">
                                        <p class="text-[10px] text-gray-400 uppercase tracking-widest">Mercado Cartola abre em</p>
                                        <p class="text-xs text-gray-500">12 de Janeiro, 2026</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <p id="countdown-market-days" class="text-3xl font-brand text-[#FF5500] leading-none">--</p>
                                    <p class="text-[10px] text-gray-500 uppercase">dias</p>
                                </div>
                            </div>
                        </div>
                        <!-- Countdown Brasileirao (secundario) -->
                        <div class="p-3 rounded-lg bg-black/40 border border-white/10 flex items-center justify-between">
                            <div class="flex items-center gap-2">
                                <i class="ph-fill ph-soccer-ball text-lg text-gray-500"></i>
                                <p class="text-[10px] text-gray-500 uppercase tracking-widest">Brasileirao 2026</p>
                            </div>
                            <p id="countdown-days" class="text-lg font-brand text-gray-400">-- dias</p>
                        </div>
                    </div>

                    <!-- Botao CTA -->
                    <button onclick="fecharTeaserComMarcacao()" class="w-full py-4 rounded-xl font-brand text-sm uppercase tracking-widest hover:brightness-110 shadow-[0_0_30px_rgba(255,85,0,0.2)] transition-all duration-300 group bg-gradient-to-r from-[#FF5500] to-[#FF8800] text-black font-bold">
                        <span class="group-hover:scale-105 inline-block transition-transform">Explorar o App</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Script do Teaser 2026 -->
        <script>
            const overlay = document.getElementById('modal-overlay');
            const card = document.getElementById('modal-card');

            // Atualizar countdowns (Mercado + Brasileirao)
            function atualizarCountdown() {
                const config = window.ParticipanteConfig;
                if (!config) return;

                // Countdown Mercado
                if (config.getMarketCountdown) {
                    const diasMercado = config.getMarketCountdown();
                    const marketEl = document.getElementById('countdown-market-days');
                    const marketContainer = document.getElementById('countdown-market');

                    if (marketEl && marketContainer) {
                        if (diasMercado > 0) {
                            marketEl.textContent = diasMercado;
                        } else {
                            // Mercado ja abriu - mostrar estado diferente
                            marketEl.innerHTML = '<i class="ph-fill ph-check-circle"></i>';
                            marketContainer.querySelector('p.text-\\[10px\\]').textContent = 'MERCADO ABERTO!';
                            marketContainer.classList.add('border-green-500/40');
                            marketContainer.classList.remove('border-[#FF5500]/40');
                        }
                    }
                }

                // Countdown Brasileirao
                if (config.getCountdownDays) {
                    const dias = config.getCountdownDays();
                    const countdownEl = document.getElementById('countdown-days');
                    if (countdownEl) {
                        if (dias > 0) {
                            countdownEl.textContent = dias + (dias === 1 ? ' dia' : ' dias');
                        } else {
                            countdownEl.textContent = 'Comecou!';
                        }
                    }
                }
            }

            function dispararConfetes() {
                var count = 200;
                var defaults = { origin: { y: 0.7 } };
                function fire(particleRatio, opts) {
                    confetti(Object.assign({}, defaults, opts, { particleCount: Math.floor(count * particleRatio) }));
                }
                fire(0.25, { spread: 26, startVelocity: 55, colors: ['#FF5500', '#FFFFFF'] });
                fire(0.2, { spread: 60, colors: ['#FF8800', '#FFFFFF'] });
                fire(0.35, { spread: 100, decay: 0.91, scalar: 0.8, colors: ['#FF5500', '#FF4500'] });
            }

            function abrirTeaser() {
                atualizarCountdown();

                // ✅ v2.3: Adicionar logo da liga (se existir)
                const logoContainer = document.getElementById('teaser-logo-liga');
                const ligaData = window.participanteAuth?.ligaDataCache;
                if (logoContainer && ligaData?.logo) {
                    logoContainer.innerHTML = `
                        <div class="flex flex-col items-center">
                            <img src="/${ligaData.logo}"
                                 alt="${ligaData.nome || 'Liga'}"
                                 class="w-14 h-14 object-contain rounded-lg shadow-lg border border-[#FF5500]/30"
                                 onerror="this.parentElement.parentElement.style.display='none'">
                            <p class="text-xs text-gray-500 mt-1">${ligaData.nome || ''}</p>
                        </div>
                    `;
                }

                overlay.classList.remove('hidden');
                setTimeout(() => {
                    overlay.classList.remove('opacity-0');
                    card.classList.remove('opacity-0', 'scale-95');
                    card.classList.add('modal-enter');
                    dispararConfetes();
                }, 10);
            }

            function fecharTeaser() {
                overlay.classList.add('opacity-0');
                card.classList.add('scale-95', 'opacity-0');
                setTimeout(() => {
                    overlay.classList.add('hidden');
                    card.classList.remove('modal-enter');
                }, 300);
                sessionStorage.setItem('spoiler_2026_visto', 'true');
            }

            // =====================================================================
            // ✅ FUNÇÃO INLINE: Verificar renovação (não depende de módulos carregados)
            // =====================================================================
            async function verificarRenovacaoInline(ligaId, timeId) {
                const config = window.ParticipanteConfig;
                const temporadaNova = config?.CURRENT_SEASON || 2026;

                try {
                    const url = `/api/inscricoes/${ligaId}/${temporadaNova}/${timeId}`;
                    const response = await fetch(url);

                    if (!response.ok) return { renovado: false };

                    const data = await response.json();

                    if (data.success && data.inscricao) {
                        const status = data.inscricao.status;
                        return {
                            renovado: status === 'renovado' || status === 'novo',
                            status
                        };
                    }

                    return { renovado: false, status: data.statusImplicito || 'pendente' };
                } catch (e) {
                    console.warn('[MODAL] Erro ao verificar renovação:', e);
                    return { renovado: false, error: true };
                }
            }

            // Auto-abrir quando temporada estiver em 'preparando'
            // ✅ v2.0: Verifica renovação - Se renovou, mostra boas-vindas. Senão, mostra teaser.
            // ✅ v2.1: Modal de boas-vindas só aparece até véspera da 1ª rodada (27/01/2026)
            window.addEventListener('load', () => {
                const config = window.ParticipanteConfig;
                if (config && config.isPreparando() && config.FEATURES.SHOW_VEM_AI_MODAL) {
                    // Verificar se ainda está dentro do período do modal de boas-vindas
                    // Véspera da 1ª rodada do Brasileirão 2026: 27/01/2026
                    const dataLimiteBoasVindas = new Date('2026-01-28T00:00:00-03:00'); // Meia-noite de 28/01 = fim do dia 27/01
                    const agora = new Date();
                    const dentroDoPeríodoBoasVindas = agora < dataLimiteBoasVindas;

                    // Aguardar auth estar pronto para verificar renovação
                    const verificarEAbrir = async () => {
                        // Se já viu boas-vindas ou teaser, não mostrar nada
                        if (sessionStorage.getItem('boas_vindas_2026_visto')) return;
                        if (sessionStorage.getItem('vem_ai_2026_visto')) return;

                        // Verificar se tem dados de auth
                        const ligaId = window.participanteAuth?.ligaId;
                        const timeId = window.participanteAuth?.timeId;

                        if (ligaId && timeId && dentroDoPeríodoBoasVindas) {
                            try {
                                const status = await verificarRenovacaoInline(ligaId, timeId);

                                if (status.renovado) {
                                    // ✅ v2.2: Liga estreante - não faz sentido "Bem-vindo de VOLTA"
                                    // Mostra apenas o Roadmap/Teaser
                                    if (window.isLigaEstreante) {
                                        console.log('[MODAL] Liga estreante + renovado - mostrando Roadmap (não "de volta")');
                                        abrirTeaser();
                                        return;
                                    }

                                    // Participante RENOVOU em liga existente - mostrar boas-vindas verde
                                    console.log('[MODAL] Participante renovado - mostrando boas-vindas (até 27/01/2026)');
                                    abrirBoasVindas();
                                    return;
                                }
                            } catch (e) {
                                console.warn('[MODAL] Erro ao verificar renovação:', e);
                            }
                        }

                        // Participante NÃO renovou ou erro na verificação - mostrar teaser normal
                        console.log('[MODAL] Participante não renovado - mostrando teaser');
                        abrirTeaser();
                    };

                    // Aguardar um pouco para auth carregar
                    setTimeout(verificarEAbrir, 2000);
                }
            });

            function fecharTeaserComMarcacao() {
                fecharTeaser();
                sessionStorage.setItem('vem_ai_2026_visto', 'true');
            }

            // Expor funcao globalmente para o botao flutuante
            window.abrirRoadmap2026 = abrirTeaser;

            // =====================================================================
            // ✅ MODAL BOAS-VINDAS 2026 - Para participantes RENOVADOS
            // =====================================================================
            function criarModalBoasVindas() {
                // Verificar se já existe
                if (document.getElementById('modal-boas-vindas-2026')) return;

                const modalHTML = `
                    <div id="modal-boas-vindas-2026" class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/95 backdrop-blur-sm hidden transition-opacity duration-300 opacity-0" style="z-index: 10000;">
                        <div id="boas-vindas-card" class="relative w-full max-w-sm rounded-2xl overflow-hidden text-center transform scale-95 opacity-0 shadow-2xl border border-green-500/30 bg-[#0f1012]">
                            <!-- Barra verde superior -->
                            <div class="h-1 w-full bg-gradient-to-r from-green-500 to-emerald-400 shadow-[0_0_25px_rgba(16,185,129,0.6)]"></div>

                            <div class="p-6 relative">
                                <!-- Confetti container -->
                                <div class="absolute inset-0 pointer-events-none overflow-hidden" id="confetti-container"></div>

                                <!-- Logo da Liga (se existir) -->
                                <div id="boas-vindas-logo-liga" class="relative z-10 mb-3"></div>

                                <!-- Icone Sucesso -->
                                <div class="relative z-10 mb-4">
                                    <div class="w-20 h-20 mx-auto rounded-full bg-gradient-to-br from-green-500 to-emerald-400 flex items-center justify-center shadow-[0_0_40px_rgba(16,185,129,0.4)]">
                                        <span class="material-icons text-4xl text-white">check_circle</span>
                                    </div>
                                </div>

                                <!-- Titulo -->
                                <h1 class="text-2xl font-brand text-white mb-2">Bem-vindo de volta!</h1>
                                <p class="text-gray-400 text-sm mb-6">Sua inscricao na temporada <span class="text-green-400 font-bold">2026</span> foi confirmada</p>

                                <!-- Card Status -->
                                <div class="bg-[#161618] border border-green-500/20 rounded-xl p-4 mb-5 text-left">
                                    <div class="flex items-center gap-3 mb-3">
                                        <div class="w-10 h-10 rounded-full bg-green-500/20 flex items-center justify-center">
                                            <span class="material-icons text-green-400">verified</span>
                                        </div>
                                        <div>
                                            <p class="text-white font-bold text-sm">Participante Ativo</p>
                                            <p class="text-gray-500 text-xs">Temporada 2026</p>
                                        </div>
                                    </div>
                                    <div class="space-y-2 text-xs">
                                        <div class="flex items-center gap-2 text-gray-400">
                                            <span class="material-icons text-sm text-green-400">sports_soccer</span>
                                            <span>O melhor fantasy game da internet</span>
                                        </div>
                                        <div class="flex items-center gap-2 text-gray-400">
                                            <span class="material-icons text-sm text-green-400">calendar_today</span>
                                            <span>Pronto para o Brasileirao 2026</span>
                                        </div>
                                        <div class="flex items-center gap-2 text-gray-400">
                                            <span class="material-icons text-sm text-green-400">history</span>
                                            <span>Historico 2025 no Hall da Fama</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Botao CTA -->
                                <button onclick="fecharBoasVindas()" class="w-full py-4 rounded-xl font-brand text-sm uppercase tracking-widest hover:brightness-110 shadow-[0_0_30px_rgba(16,185,129,0.2)] transition-all duration-300 group bg-gradient-to-r from-green-500 to-emerald-400 text-black font-bold">
                                    <span class="group-hover:scale-105 inline-block transition-transform">Vamos la!</span>
                                </button>
                            </div>
                        </div>
                    </div>
                `;

                document.body.insertAdjacentHTML('beforeend', modalHTML);
            }

            function abrirBoasVindas() {
                criarModalBoasVindas();
                const modal = document.getElementById('modal-boas-vindas-2026');
                const card = document.getElementById('boas-vindas-card');
                if (!modal || !card) return;

                // ✅ v2.3: Adicionar logo da liga (se existir)
                const logoContainer = document.getElementById('boas-vindas-logo-liga');
                const ligaData = window.participanteAuth?.ligaDataCache;
                if (logoContainer && ligaData?.logo) {
                    logoContainer.innerHTML = `
                        <img src="/${ligaData.logo}"
                             alt="${ligaData.nome || 'Liga'}"
                             class="w-16 h-16 mx-auto object-contain rounded-lg shadow-lg border border-white/10"
                             onerror="this.parentElement.style.display='none'">
                        <p class="text-xs text-gray-500 mt-1">${ligaData.nome || ''}</p>
                    `;
                }

                modal.classList.remove('hidden');
                setTimeout(() => {
                    modal.classList.remove('opacity-0');
                    card.classList.remove('opacity-0', 'scale-95');
                    card.classList.add('modal-enter');
                    // Confetti verde!
                    if (typeof confetti !== 'undefined') {
                        confetti({
                            particleCount: 100,
                            spread: 70,
                            origin: { y: 0.6 },
                            colors: ['#10b981', '#34d399', '#6ee7b7', '#ffffff']
                        });
                    }
                }, 10);
            }

            function fecharBoasVindas() {
                const modal = document.getElementById('modal-boas-vindas-2026');
                const card = document.getElementById('boas-vindas-card');
                if (!modal || !card) return;

                modal.classList.add('opacity-0');
                card.classList.add('scale-95', 'opacity-0');
                setTimeout(() => {
                    modal.classList.add('hidden');
                    card.classList.remove('modal-enter');
                }, 300);
                sessionStorage.setItem('boas_vindas_2026_visto', 'true');
            }

            // Expor globalmente
            window.abrirBoasVindas2026 = abrirBoasVindas;
            window.fecharBoasVindas = fecharBoasVindas;

            // =====================================================================
            // ✅ FAB MERCADO CARTOLA - v2.0 (Countdown em Tempo Real)
            // =====================================================================
            window.addEventListener('load', () => {
                const config = window.ParticipanteConfig;

                // Injetar estilos do FAB
                const fabStyles = document.createElement('style');
                fabStyles.textContent = `
                    @keyframes fabGlow {
                        0%, 100% { box-shadow: 0 4px 20px rgba(255, 107, 0, 0.4), 0 0 40px rgba(255, 107, 0, 0.1); }
                        50% { box-shadow: 0 4px 30px rgba(255, 107, 0, 0.6), 0 0 60px rgba(255, 107, 0, 0.2); }
                    }
                    @keyframes fabGlowGreen {
                        0%, 100% { box-shadow: 0 4px 20px rgba(34, 197, 94, 0.4), 0 0 40px rgba(34, 197, 94, 0.1); }
                        50% { box-shadow: 0 4px 30px rgba(34, 197, 94, 0.6), 0 0 60px rgba(34, 197, 94, 0.2); }
                    }
                    @keyframes fabGlowRed {
                        0%, 100% { box-shadow: 0 4px 20px rgba(239, 68, 68, 0.4), 0 0 40px rgba(239, 68, 68, 0.1); }
                        50% { box-shadow: 0 4px 30px rgba(239, 68, 68, 0.6), 0 0 60px rgba(239, 68, 68, 0.2); }
                    }
                    @keyframes iconBounce {
                        0%, 100% { transform: scale(1); }
                        50% { transform: scale(1.1); }
                    }
                    @keyframes pulse {
                        0%, 100% { opacity: 1; }
                        50% { opacity: 0.7; }
                    }
                    #fab-mercado-status {
                        animation: fabGlow 2s ease-in-out infinite;
                    }
                    #fab-mercado-status.mercado-aberto {
                        animation: fabGlowGreen 2s ease-in-out infinite;
                    }
                    #fab-mercado-status.mercado-fechando {
                        animation: fabGlowRed 1.5s ease-in-out infinite;
                    }
                    #fab-mercado-status .fab-icon {
                        animation: iconBounce 1.5s ease-in-out infinite;
                    }
                    #fab-mercado-status:hover {
                        animation: none;
                        box-shadow: 0 6px 35px rgba(255, 107, 0, 0.7);
                        transform: scale(1.05);
                    }
                    #fab-mercado-status .countdown-live {
                        animation: pulse 1s ease-in-out infinite;
                    }
                `;
                document.head.appendChild(fabStyles);

                // Criar botao flutuante
                const fab = document.createElement('button');
                fab.id = 'fab-mercado-status';
                fab.className = 'fixed bottom-24 right-4 z-40 px-4 py-3 rounded-2xl bg-gradient-to-br from-orange-500 via-orange-600 to-red-600 text-white flex items-center justify-center gap-3 transition-all duration-300 border border-orange-400/30';
                fab.innerHTML = `
                    <span class="material-icons text-2xl fab-icon">storefront</span>
                    <div class="flex flex-col items-start leading-tight">
                        <span id="fab-mercado-label" class="text-[10px] uppercase tracking-wider opacity-80">Mercado</span>
                        <span id="fab-mercado-countdown" class="text-sm font-bold">Carregando...</span>
                    </div>
                `;
                fab.title = 'Status do Mercado Cartola';

                // Click abre teaser em pre-temporada ou navega para parciais
                fab.onclick = async () => {
                    if (config && config.isPreparando()) {
                        fab.style.animation = 'none';
                        abrirTeaser();
                        return;
                    }

                    // Se mercado fechado (jogos em andamento), navegar para parciais
                    if (statusMercado && (statusMercado.status_mercado === 2 || statusMercado.status_mercado === 3)) {
                        const rodadaAtual = statusMercado.rodada_atual;
                        if (window.Log) Log.info('FAB-MERCADO', `Navegando para parciais da rodada ${rodadaAtual}`);

                        // Navegar para módulo de rodadas
                        if (window.ParticipanteNavigation?.navegarPara) {
                            await window.ParticipanteNavigation.navegarPara('rodadas');

                            // Aguardar módulo carregar e selecionar rodada atual
                            setTimeout(() => {
                                if (typeof window.selecionarRodada === 'function') {
                                    window.selecionarRodada(rodadaAtual, true);
                                } else if (typeof window.RodadasModule?.selecionarRodada === 'function') {
                                    window.RodadasModule.selecionarRodada(rodadaAtual, true);
                                }
                            }, 500);
                        }
                    }
                };
                document.body.appendChild(fab);

                // Estado do mercado
                let statusMercado = null;
                let intervaloAtualizacao = null;

                // =====================================================
                // SISTEMA DE NOTIFICACOES DE MERCADO
                // =====================================================
                const ALERT_THRESHOLDS = [
                    { minutos: 120, key: '2h', msg: 'Mercado fecha em 2 horas', tipo: 'info' },
                    { minutos: 60, key: '1h', msg: 'Mercado fecha em 1 hora', tipo: 'warning' },
                    { minutos: 30, key: '30m', msg: 'Mercado fecha em 30 minutos!', tipo: 'warning' },
                    { minutos: 15, key: '15m', msg: 'ATENCAO! 15 minutos para escalar!', tipo: 'urgente' },
                    { minutos: 5, key: '5m', msg: 'URGENTE! Apenas 5 minutos!', tipo: 'critico' }
                ];

                function getAlertasMostrados() {
                    try {
                        const stored = localStorage.getItem('mercado_alertas_mostrados');
                        return stored ? JSON.parse(stored) : {};
                    } catch { return {}; }
                }

                function marcarAlertaMostrado(rodada, key) {
                    try {
                        const alertas = getAlertasMostrados();
                        if (!alertas[rodada]) alertas[rodada] = [];
                        if (!alertas[rodada].includes(key)) {
                            alertas[rodada].push(key);
                            localStorage.setItem('mercado_alertas_mostrados', JSON.stringify(alertas));
                        }
                    } catch (e) { console.warn('[NOTIF] Erro ao salvar alerta:', e); }
                }

                function verificarEDispararAlertas(minutosRestantes, rodada) {
                    if (minutosRestantes <= 0) return;

                    const alertasMostrados = getAlertasMostrados();
                    const alertasRodada = alertasMostrados[rodada] || [];

                    for (const threshold of ALERT_THRESHOLDS) {
                        // Verificar se estamos dentro da janela do alerta (margem de 2 min)
                        if (minutosRestantes <= threshold.minutos && minutosRestantes > (threshold.minutos - 2)) {
                            if (!alertasRodada.includes(threshold.key)) {
                                mostrarNotificacaoMercado(threshold.msg, threshold.tipo, minutosRestantes);
                                marcarAlertaMostrado(rodada, threshold.key);
                                break; // Apenas um alerta por vez
                            }
                        }
                    }
                }

                function mostrarNotificacaoMercado(mensagem, tipo, minutosRestantes) {
                    // Usar toast system existente se disponivel
                    if (window.quickAccessBar && window.quickAccessBar.mostrarToast) {
                        window.quickAccessBar.mostrarToast(mensagem, tipo);
                    }

                    // Para alertas criticos (5min), mostrar modal
                    if (tipo === 'critico') {
                        mostrarModalUrgente(mensagem, minutosRestantes);
                    }

                    console.log('[NOTIF-MERCADO]', tipo.toUpperCase(), mensagem);
                }

                function mostrarModalUrgente(mensagem, minutos) {
                    // Verificar se ja existe modal urgente aberto
                    if (document.getElementById('modal-urgente-mercado')) return;

                    const modal = document.createElement('div');
                    modal.id = 'modal-urgente-mercado';
                    modal.className = 'fixed inset-0 z-[99999] flex items-center justify-center p-4 bg-black/90 backdrop-blur-sm';
                    modal.innerHTML = `
                        <div class="bg-[#1a1a2e] rounded-2xl p-6 max-w-sm w-full border border-red-500/30 shadow-2xl animate-pulse">
                            <div class="text-center">
                                <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-red-500/20 flex items-center justify-center">
                                    <span class="material-icons text-4xl text-red-500 animate-bounce">alarm</span>
                                </div>
                                <h3 class="text-xl font-bold text-white mb-2">Mercado Fechando!</h3>
                                <p class="text-red-400 text-lg font-bold mb-4">${minutos} minutos restantes</p>
                                <p class="text-white/70 text-sm mb-6">${mensagem}</p>
                                <button onclick="this.closest('#modal-urgente-mercado').remove()"
                                        class="w-full py-3 rounded-xl bg-red-500 text-white font-medium hover:bg-red-600 transition-colors">
                                    Entendi
                                </button>
                            </div>
                        </div>
                    `;
                    document.body.appendChild(modal);

                    // Auto-fechar apos 10 segundos
                    setTimeout(() => {
                        const m = document.getElementById('modal-urgente-mercado');
                        if (m) m.remove();
                    }, 10000);
                }

                // Buscar status do mercado da API
                async function buscarStatusMercado() {
                    try {
                        const response = await fetch('/api/cartola/mercado/status');
                        if (response.ok) {
                            statusMercado = await response.json();
                            atualizarFAB();
                        }
                    } catch (error) {
                        console.warn('[FAB-MERCADO] Erro ao buscar status:', error);
                        // Usar config local como fallback
                        atualizarFABFallback();
                    }
                }

                // Atualizar FAB com dados da API
                function atualizarFAB() {
                    const labelEl = document.getElementById('fab-mercado-label');
                    const countdownEl = document.getElementById('fab-mercado-countdown');

                    if (!statusMercado || !labelEl || !countdownEl) return;

                    const { status_mercado, fechamento, rodada_atual } = statusMercado;

                    // status_mercado: 1 = Aberto, 2 = Fechado (jogos), 6 = Encerrado
                    if (status_mercado === 1 && fechamento) {
                        // Mercado ABERTO - mostrar countdown para fechamento
                        // fechamento pode ser objeto {dia, mes, ano, hora, minuto} ou timestamp
                        let fechamentoDate;
                        if (typeof fechamento === 'object' && fechamento.ano) {
                            fechamentoDate = new Date(fechamento.ano, fechamento.mes - 1, fechamento.dia, fechamento.hora, fechamento.minuto);
                        } else if (fechamento.timestamp) {
                            fechamentoDate = new Date(fechamento.timestamp * 1000);
                        } else {
                            fechamentoDate = new Date(fechamento);
                        }
                        const agora = new Date();
                        const diff = fechamentoDate - agora;

                        if (diff > 0) {
                            const dias = Math.floor(diff / (1000 * 60 * 60 * 24));
                            const horas = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                            const minutos = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                            const minutosTotal = dias * 24 * 60 + horas * 60 + minutos;

                            // Verificar e disparar alertas de mercado
                            verificarEDispararAlertas(minutosTotal, rodada_atual);

                            fab.className = fab.className.replace(/mercado-\w+/g, '').trim();

                            if (dias > 0) {
                                labelEl.textContent = `Fecha em ${dias}d ${horas}h`;
                                countdownEl.innerHTML = `<span class="text-green-300">ABERTO</span> <span class="text-xs opacity-70">R${rodada_atual}</span>`;
                                fab.classList.add('mercado-aberto');
                                fab.style.background = 'linear-gradient(to bottom right, #16a34a, #15803d, #166534)';
                                fab.style.borderColor = 'rgba(34, 197, 94, 0.3)';
                            } else if (horas > 0) {
                                labelEl.textContent = `Fecha em ${horas}h ${minutos}m`;
                                countdownEl.innerHTML = `<span class="text-yellow-300 countdown-live">ABERTO</span> <span class="text-xs opacity-70">R${rodada_atual}</span>`;
                                fab.classList.add('mercado-fechando');
                                fab.style.background = 'linear-gradient(to bottom right, #f59e0b, #d97706, #b45309)';
                                fab.style.borderColor = 'rgba(245, 158, 11, 0.3)';
                            } else {
                                labelEl.textContent = `Fecha em ${minutos}min!`;
                                countdownEl.innerHTML = `<span class="text-red-300 countdown-live">CORRE!</span> <span class="text-xs opacity-70">R${rodada_atual}</span>`;
                                fab.classList.add('mercado-fechando');
                                fab.style.background = 'linear-gradient(to bottom right, #ef4444, #dc2626, #b91c1c)';
                                fab.style.borderColor = 'rgba(239, 68, 68, 0.3)';
                            }
                        } else {
                            // Fechamento passou mas status ainda é 1 (delay da API)
                            labelEl.textContent = 'Fechando...';
                            countdownEl.innerHTML = `<span class="text-yellow-300 countdown-live">Aguarde</span>`;
                        }
                    } else if (status_mercado === 2 || status_mercado === 3) {
                        // Mercado FECHADO - jogos em andamento
                        labelEl.textContent = `Rodada ${rodada_atual}`;
                        countdownEl.innerHTML = `<span class="text-red-300">FECHADO</span> <span class="text-[10px] opacity-60">⚽ Jogos</span>`;
                        fab.className = fab.className.replace(/mercado-\w+/g, '').trim();
                        fab.style.background = 'linear-gradient(to bottom right, #6b7280, #4b5563, #374151)';
                        fab.style.borderColor = 'rgba(107, 114, 128, 0.3)';
                    } else if (status_mercado === 6) {
                        // Temporada encerrada
                        labelEl.textContent = 'Temporada';
                        countdownEl.innerHTML = `<span class="text-gray-400">Encerrada</span>`;
                        fab.style.background = 'linear-gradient(to bottom right, #374151, #1f2937, #111827)';
                        fab.style.borderColor = 'rgba(55, 65, 81, 0.3)';
                    } else {
                        // Outros estados
                        atualizarFABFallback();
                    }
                }

                // Fallback usando config local
                function atualizarFABFallback() {
                    const labelEl = document.getElementById('fab-mercado-label');
                    const countdownEl = document.getElementById('fab-mercado-countdown');

                    if (!config || !labelEl || !countdownEl) return;

                    const diasMercado = config.getMarketCountdown ? config.getMarketCountdown() : 0;

                    if (diasMercado > 0) {
                        labelEl.textContent = 'Mercado abre em';
                        countdownEl.textContent = `${diasMercado} dias`;
                        fab.style.background = 'linear-gradient(to bottom right, #f97316, #ea580c, #dc2626)';
                    } else if (config.isMarketOpen && config.isMarketOpen()) {
                        labelEl.textContent = 'Mercado Cartola';
                        countdownEl.innerHTML = `<span class="text-green-300">ABERTO</span>`;
                        fab.style.background = 'linear-gradient(to bottom right, #16a34a, #15803d, #166534)';
                    } else {
                        labelEl.textContent = 'Mercado';
                        countdownEl.textContent = 'Aguardando...';
                    }
                }

                // Atualizar countdown a cada minuto
                function iniciarAtualizacaoAutomatica() {
                    // Primeira busca imediata
                    buscarStatusMercado();

                    // Atualizar a cada 60 segundos
                    intervaloAtualizacao = setInterval(() => {
                        buscarStatusMercado();
                    }, 60000);

                    // Atualizar display a cada 10 segundos (sem nova requisição)
                    setInterval(() => {
                        if (statusMercado) atualizarFAB();
                    }, 10000);
                }

                // Esconder o botao quando o modal estiver aberto (se existir)
                if (typeof overlay !== 'undefined' && overlay) {
                    const observer = new MutationObserver(() => {
                        const isModalOpen = !overlay.classList.contains('hidden');
                        fab.style.display = isModalOpen ? 'none' : 'flex';
                    });
                    observer.observe(overlay, { attributes: true, attributeFilter: ['class'] });
                }

                // Iniciar
                iniciarAtualizacaoAutomatica();
            });
        </script>

        <!-- ================================================================= -->
        <!-- MODAL PREMIAÇÕES 2026 - Accordion com todas as premiações         -->
        <!-- ================================================================= -->
        <div id="modal-premiacoes-2026" class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/95 backdrop-blur-sm hidden transition-opacity duration-300 opacity-0" style="z-index: 10000;">
            <div id="premiacoes-card" class="relative w-full max-w-md rounded-2xl overflow-hidden transform scale-95 opacity-0 shadow-2xl border border-primary/30 bg-[#0f1012] max-h-[85vh] flex flex-col">
                <!-- Header Fixo -->
                <div class="sticky top-0 z-10 bg-[#0f1012] border-b border-white/10">
                    <div class="h-1 w-full bg-gradient-to-r from-primary to-orange-400"></div>
                    <div class="p-4 flex items-center justify-between">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-full bg-primary/20 flex items-center justify-center">
                                <span class="material-icons text-xl text-primary">emoji_events</span>
                            </div>
                            <div>
                                <h2 class="text-lg font-brand text-white">Premiações 2026</h2>
                                <p class="text-[10px] text-white/50 uppercase tracking-wider">Super Cartola Manager</p>
                            </div>
                        </div>
                        <button onclick="fecharPremiacoes2026()" class="p-2 rounded-full hover:bg-white/10 transition-colors">
                            <span class="material-icons text-white/60">close</span>
                        </button>
                    </div>
                </div>

                <!-- Conteúdo Scrollável com Accordion -->
                <div class="flex-1 overflow-y-auto p-4 space-y-2" id="premiacoes-accordion">

                    <!-- 1. Ranking Geral (G10) -->
                    <div class="accordion-item rounded-xl border border-white/10 overflow-hidden">
                        <button class="accordion-header w-full p-3 flex items-center justify-between bg-white/5 hover:bg-white/10 transition-colors" onclick="toggleAccordion(this)">
                            <div class="flex items-center gap-3">
                                <span class="material-icons text-yellow-400">emoji_events</span>
                                <span class="text-sm font-medium text-white">Ranking Geral (G10)</span>
                            </div>
                            <span class="material-icons text-white/40 accordion-icon transition-transform">expand_more</span>
                        </button>
                        <div class="accordion-content hidden bg-black/30 p-3">
                            <div class="grid grid-cols-2 gap-2">
                                <div class="p-2 rounded-lg bg-yellow-400/20 border border-yellow-400/30 text-center">
                                    <p class="text-[10px] text-yellow-400">1° Campeão</p>
                                    <p class="text-lg font-bold text-yellow-400">R$ 1.000</p>
                                </div>
                                <div class="p-2 rounded-lg bg-gray-400/10 border border-gray-400/20 text-center">
                                    <p class="text-[10px] text-gray-300">2° lugar</p>
                                    <p class="text-lg font-bold text-gray-300">R$ 700</p>
                                </div>
                                <div class="p-2 rounded-lg bg-orange-400/10 border border-orange-400/20 text-center">
                                    <p class="text-[10px] text-orange-300">3° lugar</p>
                                    <p class="text-lg font-bold text-orange-300">R$ 500</p>
                                </div>
                                <div class="p-2 rounded-lg bg-white/5 text-center">
                                    <p class="text-[10px] text-white/50">4° lugar</p>
                                    <p class="text-sm font-bold text-white/70">R$ 350</p>
                                </div>
                                <div class="p-2 rounded-lg bg-white/5 text-center">
                                    <p class="text-[10px] text-white/50">5° lugar</p>
                                    <p class="text-sm font-bold text-white/70">R$ 300</p>
                                </div>
                                <div class="p-2 rounded-lg bg-white/5 text-center">
                                    <p class="text-[10px] text-white/50">6° lugar</p>
                                    <p class="text-sm font-bold text-white/70">R$ 250</p>
                                </div>
                                <div class="p-2 rounded-lg bg-white/5 text-center">
                                    <p class="text-[10px] text-white/50">7° lugar</p>
                                    <p class="text-sm font-bold text-white/70">R$ 200</p>
                                </div>
                                <div class="p-2 rounded-lg bg-white/5 text-center">
                                    <p class="text-[10px] text-white/50">8° lugar</p>
                                    <p class="text-sm font-bold text-white/70">R$ 150</p>
                                </div>
                                <div class="p-2 rounded-lg bg-white/5 text-center">
                                    <p class="text-[10px] text-white/50">9° lugar</p>
                                    <p class="text-sm font-bold text-white/70">R$ 100</p>
                                </div>
                                <div class="p-2 rounded-lg bg-white/5 text-center">
                                    <p class="text-[10px] text-white/50">10° lugar</p>
                                    <p class="text-sm font-bold text-white/70">R$ 50</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 2. Ranking de Rodada -->
                    <div class="accordion-item rounded-xl border border-white/10 overflow-hidden">
                        <button class="accordion-header w-full p-3 flex items-center justify-between bg-white/5 hover:bg-white/10 transition-colors" onclick="toggleAccordion(this)">
                            <div class="flex items-center gap-3">
                                <span class="material-icons text-primary">trending_up</span>
                                <span class="text-sm font-medium text-white">Ranking de Rodada</span>
                            </div>
                            <span class="material-icons text-white/40 accordion-icon transition-transform">expand_more</span>
                        </button>
                        <div class="accordion-content hidden bg-black/30 p-3 space-y-3">
                            <!-- Bônus G10 -->
                            <div>
                                <p class="text-xs font-medium text-green-400 mb-2 flex items-center gap-1">
                                    <span class="material-icons text-sm">arrow_upward</span> Bônus G10
                                </p>
                                <div class="grid grid-cols-5 gap-1 text-center text-[10px]">
                                    <div class="p-1.5 rounded bg-green-400/20 border border-green-400/30">
                                        <p class="text-green-300">G1</p>
                                        <p class="font-bold text-green-400">+20</p>
                                    </div>
                                    <div class="p-1.5 rounded bg-green-400/10">
                                        <p class="text-white/50">2°</p>
                                        <p class="font-bold text-green-400">+15</p>
                                    </div>
                                    <div class="p-1.5 rounded bg-green-400/10">
                                        <p class="text-white/50">3°</p>
                                        <p class="font-bold text-green-400">+12</p>
                                    </div>
                                    <div class="p-1.5 rounded bg-green-400/10">
                                        <p class="text-white/50">4°</p>
                                        <p class="font-bold text-green-400">+11</p>
                                    </div>
                                    <div class="p-1.5 rounded bg-green-400/10">
                                        <p class="text-white/50">5°</p>
                                        <p class="font-bold text-green-400">+10</p>
                                    </div>
                                    <div class="p-1.5 rounded bg-green-400/10">
                                        <p class="text-white/50">6°</p>
                                        <p class="font-bold text-green-400">+9</p>
                                    </div>
                                    <div class="p-1.5 rounded bg-green-400/10">
                                        <p class="text-white/50">7°</p>
                                        <p class="font-bold text-green-400">+8</p>
                                    </div>
                                    <div class="p-1.5 rounded bg-green-400/10">
                                        <p class="text-white/50">8°</p>
                                        <p class="font-bold text-green-400">+7</p>
                                    </div>
                                    <div class="p-1.5 rounded bg-green-400/10">
                                        <p class="text-white/50">9°</p>
                                        <p class="font-bold text-green-400">+6</p>
                                    </div>
                                    <div class="p-1.5 rounded bg-green-400/10">
                                        <p class="text-white/50">10°</p>
                                        <p class="font-bold text-green-400">+5</p>
                                    </div>
                                </div>
                            </div>
                            <!-- Zona Neutra -->
                            <div class="text-center py-2 rounded-lg bg-gray-500/10 border border-gray-500/20">
                                <p class="text-xs text-gray-400">Zona Neutra: 11° ao 32°</p>
                            </div>
                            <!-- Ônus Z10 -->
                            <div>
                                <p class="text-xs font-medium text-red-400 mb-2 flex items-center gap-1">
                                    <span class="material-icons text-sm">arrow_downward</span> Ônus Z10
                                </p>
                                <div class="grid grid-cols-5 gap-1 text-center text-[10px]">
                                    <div class="p-1.5 rounded bg-red-400/10">
                                        <p class="text-white/50">33°</p>
                                        <p class="font-bold text-red-400">-5</p>
                                    </div>
                                    <div class="p-1.5 rounded bg-red-400/10">
                                        <p class="text-white/50">34°</p>
                                        <p class="font-bold text-red-400">-6</p>
                                    </div>
                                    <div class="p-1.5 rounded bg-red-400/10">
                                        <p class="text-white/50">35°</p>
                                        <p class="font-bold text-red-400">-7</p>
                                    </div>
                                    <div class="p-1.5 rounded bg-red-400/10">
                                        <p class="text-white/50">36°</p>
                                        <p class="font-bold text-red-400">-8</p>
                                    </div>
                                    <div class="p-1.5 rounded bg-red-400/10">
                                        <p class="text-white/50">37°</p>
                                        <p class="font-bold text-red-400">-9</p>
                                    </div>
                                    <div class="p-1.5 rounded bg-red-400/10">
                                        <p class="text-white/50">38°</p>
                                        <p class="font-bold text-red-400">-10</p>
                                    </div>
                                    <div class="p-1.5 rounded bg-red-400/10">
                                        <p class="text-white/50">39°</p>
                                        <p class="font-bold text-red-400">-11</p>
                                    </div>
                                    <div class="p-1.5 rounded bg-red-400/10">
                                        <p class="text-white/50">40°</p>
                                        <p class="font-bold text-red-400">-12</p>
                                    </div>
                                    <div class="p-1.5 rounded bg-red-400/10">
                                        <p class="text-white/50">41°</p>
                                        <p class="font-bold text-red-400">-15</p>
                                    </div>
                                    <div class="p-1.5 rounded bg-red-400/20 border border-red-400/30">
                                        <p class="text-red-300">Z1</p>
                                        <p class="font-bold text-red-400">-20</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 3. Campeões de Turno -->
                    <div class="accordion-item rounded-xl border border-white/10 overflow-hidden">
                        <button class="accordion-header w-full p-3 flex items-center justify-between bg-white/5 hover:bg-white/10 transition-colors" onclick="toggleAccordion(this)">
                            <div class="flex items-center gap-3">
                                <span class="material-icons text-yellow-400">military_tech</span>
                                <span class="text-sm font-medium text-white">Campeões de Turno</span>
                            </div>
                            <span class="material-icons text-white/40 accordion-icon transition-transform">expand_more</span>
                        </button>
                        <div class="accordion-content hidden bg-black/30 p-3 space-y-2">
                            <div class="flex items-center justify-between p-2 rounded-lg bg-white/5">
                                <span class="text-xs text-white/70">1° Turno</span>
                                <span class="text-xs font-medium text-yellow-400">Copo Térmico GoCase</span>
                            </div>
                            <div class="flex items-center justify-between p-2 rounded-lg bg-white/5">
                                <span class="text-xs text-white/70">2° Turno</span>
                                <span class="text-xs font-medium text-yellow-400">Camisa do Time</span>
                            </div>
                        </div>
                    </div>

                    <!-- 4. Disputas Individuais -->
                    <div class="accordion-item rounded-xl border border-white/10 overflow-hidden">
                        <button class="accordion-header w-full p-3 flex items-center justify-between bg-white/5 hover:bg-white/10 transition-colors" onclick="toggleAccordion(this)">
                            <div class="flex items-center gap-3">
                                <span class="material-icons text-primary">sports_soccer</span>
                                <span class="text-sm font-medium text-white">Disputas Individuais</span>
                            </div>
                            <span class="material-icons text-white/40 accordion-icon transition-transform">expand_more</span>
                        </button>
                        <div class="accordion-content hidden bg-black/30 p-3 space-y-2">
                            <div class="flex items-center justify-between p-2 rounded-lg bg-white/5">
                                <div class="flex items-center gap-2">
                                    <span class="material-icons text-sm text-primary">sports_soccer</span>
                                    <span class="text-xs text-white/70">Artilheiro Campeão</span>
                                </div>
                                <span class="text-xs font-bold text-green-400">R$ 50,00</span>
                            </div>
                            <div class="flex items-center justify-between p-2 rounded-lg bg-white/5">
                                <div class="flex items-center gap-2">
                                    <span class="material-icons text-sm text-primary">sports_mma</span>
                                    <span class="text-xs text-white/70">Luva de Ouro</span>
                                </div>
                                <span class="text-xs font-bold text-green-400">R$ 50,00</span>
                            </div>
                            <div class="flex items-center justify-between p-2 rounded-lg bg-white/5">
                                <div class="flex items-center gap-2">
                                    <span class="material-icons text-sm text-primary">star</span>
                                    <span class="text-xs text-white/70">Capitão Campeão</span>
                                </div>
                                <span class="text-xs font-bold text-green-400">R$ 50,00</span>
                            </div>
                        </div>
                    </div>

                    <!-- 5. Pontos Corridos -->
                    <div class="accordion-item rounded-xl border border-white/10 overflow-hidden">
                        <button class="accordion-header w-full p-3 flex items-center justify-between bg-white/5 hover:bg-white/10 transition-colors" onclick="toggleAccordion(this)">
                            <div class="flex items-center gap-3">
                                <span class="material-icons text-blue-400">leaderboard</span>
                                <span class="text-sm font-medium text-white">Pontos Corridos</span>
                            </div>
                            <span class="material-icons text-white/40 accordion-icon transition-transform">expand_more</span>
                        </button>
                        <div class="accordion-content hidden bg-black/30 p-3 space-y-2">
                            <div class="flex items-center justify-between p-2 rounded-lg bg-yellow-400/10 border border-yellow-400/20">
                                <span class="text-xs text-yellow-400 font-medium">1° Campeão</span>
                                <span class="text-sm font-bold text-yellow-400">R$ 150,00</span>
                            </div>
                            <div class="flex items-center justify-between p-2 rounded-lg bg-gray-400/10 border border-gray-400/20">
                                <span class="text-xs text-gray-300 font-medium">2° lugar</span>
                                <span class="text-sm font-bold text-gray-300">R$ 130,00</span>
                            </div>
                            <div class="flex items-center justify-between p-2 rounded-lg bg-orange-400/10 border border-orange-400/20">
                                <span class="text-xs text-orange-300 font-medium">3° lugar</span>
                                <span class="text-sm font-bold text-orange-300">R$ 110,00</span>
                            </div>
                        </div>
                    </div>

                    <!-- 6. Torneios -->
                    <div class="accordion-item rounded-xl border border-white/10 overflow-hidden">
                        <button class="accordion-header w-full p-3 flex items-center justify-between bg-white/5 hover:bg-white/10 transition-colors" onclick="toggleAccordion(this)">
                            <div class="flex items-center gap-3">
                                <span class="material-icons text-purple-400">account_tree</span>
                                <span class="text-sm font-medium text-white">Torneios</span>
                            </div>
                            <span class="material-icons text-white/40 accordion-icon transition-transform">expand_more</span>
                        </button>
                        <div class="accordion-content hidden bg-black/30 p-3 space-y-3">
                            <!-- Mata-Mata -->
                            <div class="p-2 rounded-lg bg-white/5">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-xs font-medium text-white/90">Mata-Mata</span>
                                    <span class="text-[10px] text-purple-400">5 edições</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-[10px] text-white/50">Prêmio por edição</span>
                                    <span class="text-xs font-bold text-green-400">R$ 50,00</span>
                                </div>
                            </div>
                            <!-- RestaUm -->
                            <div class="p-2 rounded-lg bg-white/5">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-xs font-medium text-white/90">RestaUm</span>
                                    <span class="text-[10px] text-purple-400">Eliminatória</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-[10px] text-white/50">Prêmio</span>
                                    <span class="text-xs font-bold text-purple-400">FireStick Amazon</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 7. Super Novidades 2026 -->
                    <div class="accordion-item rounded-xl border border-white/10 overflow-hidden">
                        <button class="accordion-header w-full p-3 flex items-center justify-between bg-white/5 hover:bg-white/10 transition-colors" onclick="toggleAccordion(this)">
                            <div class="flex items-center gap-3">
                                <span class="material-icons text-purple-400">auto_awesome</span>
                                <span class="text-sm font-medium text-white">Super Novidades 2026</span>
                            </div>
                            <span class="material-icons text-white/40 accordion-icon transition-transform">expand_more</span>
                        </button>
                        <div class="accordion-content hidden bg-black/30 p-3 space-y-3">
                            <!-- Liga Tiro Certo -->
                            <div class="p-2 rounded-lg bg-white/5">
                                <div class="flex items-center justify-between">
                                    <span class="text-xs text-white/70">Liga Tiro Certo</span>
                                    <span class="text-xs font-bold text-green-400">R$ 50,00 /edição</span>
                                </div>
                            </div>
                            <!-- Bolões -->
                            <div class="pt-2 border-t border-white/10">
                                <p class="text-xs font-medium text-white/60 mb-2 flex items-center gap-1">
                                    <span class="material-icons text-sm text-green-400">public</span> Bolões
                                </p>
                                <!-- Copa do Mundo -->
                                <div class="p-2 rounded-lg bg-white/5 mb-2">
                                    <p class="text-xs font-medium text-white/80 mb-2">Copa do Mundo</p>
                                    <div class="grid grid-cols-3 gap-2 text-center">
                                        <div class="p-1.5 rounded bg-yellow-400/10">
                                            <p class="text-[10px] text-yellow-400">1°</p>
                                            <p class="text-xs font-bold text-yellow-400">R$ 100</p>
                                        </div>
                                        <div class="p-1.5 rounded bg-gray-400/10">
                                            <p class="text-[10px] text-gray-300">2°</p>
                                            <p class="text-xs font-bold text-gray-300">R$ 70</p>
                                        </div>
                                        <div class="p-1.5 rounded bg-orange-400/10">
                                            <p class="text-[10px] text-orange-300">3°</p>
                                            <p class="text-xs font-bold text-orange-300">R$ 40</p>
                                        </div>
                                    </div>
                                </div>
                                <!-- Libertadores -->
                                <div class="p-2 rounded-lg bg-white/5">
                                    <p class="text-xs font-medium text-white/80 mb-2">Libertadores</p>
                                    <div class="grid grid-cols-3 gap-2 text-center">
                                        <div class="p-1.5 rounded bg-yellow-400/10">
                                            <p class="text-[10px] text-yellow-400">1°</p>
                                            <p class="text-xs font-bold text-yellow-400">R$ 120</p>
                                        </div>
                                        <div class="p-1.5 rounded bg-gray-400/10">
                                            <p class="text-[10px] text-gray-300">2°</p>
                                            <p class="text-xs font-bold text-gray-300">R$ 90</p>
                                        </div>
                                        <div class="p-1.5 rounded bg-orange-400/10">
                                            <p class="text-[10px] text-orange-300">3°</p>
                                            <p class="text-xs font-bold text-orange-300">R$ 60</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 8. Bônus e Ônus -->
                    <div class="accordion-item rounded-xl border border-white/10 overflow-hidden">
                        <button class="accordion-header w-full p-3 flex items-center justify-between bg-white/5 hover:bg-white/10 transition-colors" onclick="toggleAccordion(this)">
                            <div class="flex items-center gap-3">
                                <span class="material-icons text-cyan-400">swap_vert</span>
                                <span class="text-sm font-medium text-white">Bônus e Ônus</span>
                            </div>
                            <span class="material-icons text-white/40 accordion-icon transition-transform">expand_more</span>
                        </button>
                        <div class="accordion-content hidden bg-black/30 p-3 space-y-2">
                            <div class="flex items-center gap-2 p-2 rounded-lg bg-white/5">
                                <span class="material-icons text-sm text-yellow-400">workspace_premium</span>
                                <span class="text-xs text-white/70">Top10 Micos e Mitos</span>
                            </div>
                            <div class="flex items-center gap-2 p-2 rounded-lg bg-green-400/10 border border-green-400/20">
                                <span class="material-icons text-sm text-green-400">verified</span>
                                <span class="text-xs text-green-400">Nunca Mico - Bônus</span>
                            </div>
                            <div class="flex items-center gap-2 p-2 rounded-lg bg-red-400/10 border border-red-400/20">
                                <span class="material-icons text-sm text-red-400">home</span>
                                <span class="text-xs text-red-400">Morador de Zona (>19x na Z) - Ônus</span>
                            </div>
                            <div class="flex items-center gap-2 p-2 rounded-lg bg-green-400/10 border border-green-400/20">
                                <span class="material-icons text-sm text-green-400">park</span>
                                <span class="text-xs text-green-400">Área Green (>19x no G) - Bônus</span>
                            </div>
                        </div>
                    </div>

                </div>

                <!-- Footer -->
                <div class="sticky bottom-0 bg-[#0f1012] border-t border-white/10 p-3">
                    <button onclick="fecharPremiacoes2026()" class="w-full py-3 rounded-xl bg-primary/20 border border-primary/30 text-primary font-medium text-sm hover:bg-primary/30 transition-colors">
                        Fechar
                    </button>
                </div>
            </div>
        </div>

        <!-- Mini-Modal Aguarde Atualizações -->
        <div id="modal-aguarde" class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/90 backdrop-blur-sm hidden transition-opacity duration-300 opacity-0" style="z-index: 10001;">
            <div id="aguarde-card" class="relative w-full max-w-xs rounded-2xl overflow-hidden transform scale-95 opacity-0 transition-all duration-300 shadow-2xl border border-primary/30 bg-[#0f1012] p-6 text-center">
                <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-primary/20 flex items-center justify-center">
                    <span class="material-icons text-3xl text-primary">hourglass_empty</span>
                </div>
                <h3 class="text-lg font-bold text-white mb-2" style="font-family: 'Russo One', sans-serif;">Em breve!</h3>
                <p class="text-sm text-white/60 mb-4">Aguarde novas atualizações</p>
                <button onclick="fecharModalAguarde()" class="w-full py-3 rounded-xl bg-primary/20 border border-primary/30 text-primary font-medium text-sm hover:bg-primary/30 transition-colors">
                    Entendi
                </button>
            </div>
        </div>

        <!-- Script do Modal Premiações 2026 -->
        <script>
            // ID da liga Super Cartola (única com premiações configuradas)
            const LIGA_SUPER_CARTOLA_ID = '684cb1c8af923da7c7df51de';

            // Mini-modal "Aguarde"
            function abrirModalAguarde() {
                const modal = document.getElementById('modal-aguarde');
                const card = document.getElementById('aguarde-card');
                if (!modal || !card) return;

                modal.classList.remove('hidden');
                setTimeout(() => {
                    modal.classList.remove('opacity-0');
                    card.classList.remove('scale-95', 'opacity-0');
                }, 10);
            }

            function fecharModalAguarde() {
                const modal = document.getElementById('modal-aguarde');
                const card = document.getElementById('aguarde-card');
                if (!modal || !card) return;

                modal.classList.add('opacity-0');
                card.classList.add('scale-95', 'opacity-0');
                setTimeout(() => {
                    modal.classList.add('hidden');
                }, 300);
            }

            // Fechar modal ao clicar fora
            document.getElementById('modal-aguarde')?.addEventListener('click', function(e) {
                if (e.target === this) fecharModalAguarde();
            });

            window.abrirModalAguarde = abrirModalAguarde;
            window.fecharModalAguarde = fecharModalAguarde;

            // Funções do Modal Premiações 2026
            function abrirPremiacoes2026() {
                // Verificar se a liga tem premiações configuradas
                const ligaId = window.participanteAuth?.ligaId;
                if (ligaId !== LIGA_SUPER_CARTOLA_ID) {
                    // Liga sem configurações - mostrar mini-modal
                    abrirModalAguarde();
                    console.log('[PREMIACOES] Liga sem configurações, exibindo modal aguarde');
                    return;
                }

                const modal = document.getElementById('modal-premiacoes-2026');
                const card = document.getElementById('premiacoes-card');
                if (!modal || !card) return;

                modal.classList.remove('hidden');
                setTimeout(() => {
                    modal.classList.remove('opacity-0');
                    card.classList.remove('scale-95', 'opacity-0');
                }, 10);
            }

            function fecharPremiacoes2026() {
                const modal = document.getElementById('modal-premiacoes-2026');
                const card = document.getElementById('premiacoes-card');
                if (!modal || !card) return;

                modal.classList.add('opacity-0');
                card.classList.add('scale-95', 'opacity-0');
                setTimeout(() => {
                    modal.classList.add('hidden');
                }, 300);
            }

            // Toggle Accordion
            function toggleAccordion(header) {
                const item = header.closest('.accordion-item');
                const content = item.querySelector('.accordion-content');
                const icon = header.querySelector('.accordion-icon');

                // Toggle atual
                content.classList.toggle('hidden');
                icon.style.transform = content.classList.contains('hidden') ? 'rotate(0deg)' : 'rotate(180deg)';
            }

            // Fechar modal ao clicar fora
            document.getElementById('modal-premiacoes-2026')?.addEventListener('click', function(e) {
                if (e.target === this) fecharPremiacoes2026();
            });

            // Expor globalmente
            window.abrirPremiacoes2026 = abrirPremiacoes2026;
            window.fecharPremiacoes2026 = fecharPremiacoes2026;

            console.log('[PREMIACOES] Modal Premiações 2026 carregado');
        </script>

        <!-- Modal Participantes 2026 -->
        <div id="modal-participantes-2026" class="fixed inset-0 z-50 hidden opacity-0 transition-opacity duration-300" style="background: rgba(0,0,0,0.85); backdrop-filter: blur(8px); z-index: 10000;">
            <div id="participantes-card" class="absolute inset-x-4 top-1/2 -translate-y-1/2 max-w-md mx-auto bg-[#0f1012] rounded-2xl border border-white/10 shadow-2xl overflow-hidden scale-95 opacity-0 transition-all duration-300 max-h-[80vh] flex flex-col">

                <!-- Header Fixo -->
                <div class="sticky top-0 bg-[#0f1012] border-b border-white/10 p-4 z-10">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-full bg-primary/20 flex items-center justify-center">
                                <span class="material-icons text-primary">groups</span>
                            </div>
                            <div>
                                <h2 class="text-lg font-bold text-white" style="font-family: 'Russo One', sans-serif;">Participantes 2026</h2>
                                <p id="participantes-subtitulo" class="text-xs text-white/50">Carregando...</p>
                            </div>
                        </div>
                        <button onclick="fecharParticipantes2026()" class="p-2 rounded-full hover:bg-white/10 transition-colors">
                            <span class="material-icons text-white/60">close</span>
                        </button>
                    </div>
                </div>

                <!-- Lista de Participantes (Scroll) -->
                <div id="lista-participantes-2026" class="flex-1 overflow-y-auto p-4 space-y-2">
                    <!-- Loading state -->
                    <div class="flex items-center justify-center py-8">
                        <div class="animate-spin w-8 h-8 border-2 border-primary border-t-transparent rounded-full"></div>
                    </div>
                </div>

                <!-- Footer Fixo -->
                <div class="sticky bottom-0 bg-[#0f1012] border-t border-white/10 p-3">
                    <button onclick="fecharParticipantes2026()" class="w-full py-3 rounded-xl bg-primary/20 border border-primary/30 text-primary font-medium text-sm hover:bg-primary/30 transition-colors">
                        Fechar
                    </button>
                </div>
            </div>
        </div>

        <!-- Script do Modal Participantes 2026 -->
        <script>
            // Funcoes do Modal Participantes 2026
            async function abrirParticipantes2026() {
                const modal = document.getElementById('modal-participantes-2026');
                const card = document.getElementById('participantes-card');
                if (!modal || !card) return;

                // Mostrar modal
                modal.classList.remove('hidden');
                setTimeout(() => {
                    modal.classList.remove('opacity-0');
                    card.classList.remove('scale-95', 'opacity-0');
                }, 10);

                // Carregar participantes
                await carregarParticipantes2026();
            }

            function fecharParticipantes2026() {
                const modal = document.getElementById('modal-participantes-2026');
                const card = document.getElementById('participantes-card');
                if (!modal || !card) return;

                modal.classList.add('opacity-0');
                card.classList.add('scale-95', 'opacity-0');
                setTimeout(() => {
                    modal.classList.add('hidden');
                }, 300);
            }

            async function carregarParticipantes2026() {
                const lista = document.getElementById('lista-participantes-2026');
                const subtitulo = document.getElementById('participantes-subtitulo');

                try {
                    // Obter ligaId do contexto
                    const ligaId = window.participanteAuth?.ligaId;
                    if (!ligaId) {
                        lista.innerHTML = '<p class="text-center text-white/50 py-8">Liga nao identificada</p>';
                        return;
                    }

                    // ✅ v2.0 FIX: Usar mesma API do admin para consistência
                    // Buscar participantes ativos da temporada (exclui nao_participa automaticamente)
                    let participantes = [];
                    let fonte = 'api';
                    const temporada = window.ParticipanteConfig?.CURRENT_SEASON || 2026;

                    try {
                        const response = await fetch(`/api/ligas/${ligaId}/participantes?temporada=${temporada}`);
                        const data = await response.json();
                        if (data.participantes?.length) {
                            // Filtrar apenas ativos (renovado ou novo) - mesmo filtro do admin
                            participantes = data.participantes
                                .filter(p => p.ativo !== false && p.status !== 'nao_participa')
                                .map(p => ({
                                    nome_cartola: p.nome_cartoleiro || p.nome_cartola || 'Sem nome',
                                    nome_time: p.nome_time || 'Sem time',
                                    clube_id: p.clube_id || 'default'
                                }));
                            fonte = data.fonte || 'api';
                        }
                    } catch (err) {
                        console.warn('[PARTICIPANTES] API participantes falhou, usando fallback');
                    }

                    // FALLBACK: Buscar de liga.participantes se API falhar
                    if (!participantes.length) {
                        fonte = 'liga-cache';
                        const liga = window.participanteAuth?.liga;
                        if (liga?.participantes?.length) {
                            participantes = liga.participantes
                                .filter(p => p.ativo !== false)
                                .map(p => ({
                                    nome_cartola: p.nome_cartola || p.nome_cartoleiro || 'Sem nome',
                                    nome_time: p.nome_time || 'Sem time',
                                    clube_id: p.clube_id || 'default'
                                }));
                        }
                    }

                    if (!participantes.length) {
                        lista.innerHTML = '<p class="text-center text-white/50 py-8">Nenhum participante na liga</p>';
                        subtitulo.textContent = '0 participantes';
                        return;
                    }

                    // Atualizar subtitulo
                    subtitulo.textContent = `${participantes.length} participantes`;
                    console.log(`[PARTICIPANTES] ${participantes.length} carregados (fonte: ${fonte})`);

                    // Renderizar lista com escudo do time do coracao
                    lista.innerHTML = participantes.map(p => {
                        const clubeId = p.clube_id || 'default';
                        const escudoUrl = `/escudos/${clubeId}.png`;
                        return `
                            <div class="flex items-center gap-3 p-3 rounded-xl bg-white/5 border border-white/10">
                                <div class="w-10 h-10 rounded-full bg-white/10 flex items-center justify-center flex-shrink-0 overflow-hidden">
                                    <img src="${escudoUrl}"
                                         alt="Escudo"
                                         class="w-8 h-8 object-contain"
                                         onerror="this.src='/escudos/default.png'">
                                </div>
                                <div class="flex-1 min-w-0">
                                    <p class="text-sm font-semibold text-white truncate">${p.nome_cartola}</p>
                                    <p class="text-xs text-white/50 truncate">${p.nome_time}</p>
                                </div>
                            </div>
                        `;
                    }).join('');

                } catch (error) {
                    console.error('[PARTICIPANTES] Erro ao carregar:', error);
                    lista.innerHTML = '<p class="text-center text-red-400 py-8">Erro ao carregar participantes</p>';
                }
            }

            // Fechar modal ao clicar fora
            document.getElementById('modal-participantes-2026')?.addEventListener('click', function(e) {
                if (e.target === this) fecharParticipantes2026();
            });

            // Expor globalmente
            window.abrirParticipantes2026 = abrirParticipantes2026;
            window.fecharParticipantes2026 = fecharParticipantes2026;

            console.log('[PARTICIPANTES] Modal Participantes 2026 carregado');
        </script>

        <!-- Modal Regras 2026 -->
        <div id="modal-regras-2026" class="fixed inset-0 z-50 hidden opacity-0 transition-opacity duration-300" style="background: rgba(0,0,0,0.85); backdrop-filter: blur(8px); z-index: 10000;">
            <div id="regras-card" class="absolute inset-x-4 top-1/2 -translate-y-1/2 max-w-md mx-auto bg-[#0f1012] rounded-2xl border border-white/10 shadow-2xl overflow-hidden scale-95 opacity-0 transition-all duration-300 max-h-[80vh] flex flex-col">

                <!-- Header Fixo -->
                <div class="sticky top-0 bg-[#0f1012] border-b border-white/10 p-4 z-10">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-full bg-blue-500/20 flex items-center justify-center">
                                <span class="material-icons text-blue-400">gavel</span>
                            </div>
                            <div>
                                <h2 class="text-lg font-bold text-white" style="font-family: 'Russo One', sans-serif;">Regras 2026</h2>
                                <p id="regras-subtitulo" class="text-xs text-white/50">Configuracoes da temporada</p>
                            </div>
                        </div>
                        <button onclick="fecharRegras2026()" class="p-2 rounded-full hover:bg-white/10 transition-colors">
                            <span class="material-icons text-white/60">close</span>
                        </button>
                    </div>
                </div>

                <!-- Conteudo das Regras (Scroll) -->
                <div id="conteudo-regras-2026" class="flex-1 overflow-y-auto p-4 space-y-3">
                    <!-- Loading state -->
                    <div class="flex items-center justify-center py-8">
                        <div class="animate-spin w-8 h-8 border-2 border-blue-400 border-t-transparent rounded-full"></div>
                    </div>
                </div>

                <!-- Footer Fixo -->
                <div class="sticky bottom-0 bg-[#0f1012] border-t border-white/10 p-3">
                    <button onclick="fecharRegras2026()" class="w-full py-3 rounded-xl bg-blue-500/20 border border-blue-500/30 text-blue-400 font-medium text-sm hover:bg-blue-500/30 transition-colors">
                        Fechar
                    </button>
                </div>
            </div>
        </div>

        <!-- Script do Modal Regras 2026 -->
        <script>
            // Funcoes do Modal Regras 2026
            async function abrirRegras2026() {
                // ID da liga Super Cartola (única com regras configuradas)
                const LIGA_SUPER_CARTOLA_ID = '684cb1c8af923da7c7df51de';

                // Verificar se a liga tem regras configuradas
                const ligaId = window.participanteAuth?.ligaId;
                if (ligaId !== LIGA_SUPER_CARTOLA_ID) {
                    // Liga sem configurações - mostrar mini-modal
                    abrirModalAguarde();
                    console.log('[REGRAS] Liga sem configurações, exibindo modal aguarde');
                    return;
                }

                const modal = document.getElementById('modal-regras-2026');
                const card = document.getElementById('regras-card');
                const conteudo = document.getElementById('conteudo-regras-2026');
                if (!modal || !card) return;

                // Mostrar modal com loading
                modal.classList.remove('hidden');
                setTimeout(() => {
                    modal.classList.remove('opacity-0');
                    card.classList.remove('scale-95', 'opacity-0');
                }, 10);

                // Buscar dados da API
                try {
                    if (!ligaId) throw new Error('Liga nao encontrada');

                    const response = await fetch(`/api/liga-rules/${ligaId}/2026`);
                    if (!response.ok) throw new Error('Regras nao configuradas');

                    const rules = await response.json();
                    renderizarRegras(rules, conteudo);
                } catch (error) {
                    console.error('[REGRAS] Erro:', error);
                    conteudo.innerHTML = `
                        <div class="text-center py-8">
                            <span class="material-icons text-4xl text-white/30 mb-2">info</span>
                            <p class="text-white/50 text-sm">Regras ainda nao configuradas para 2026</p>
                            <p class="text-white/30 text-xs mt-1">Aguarde o administrador definir as regras</p>
                        </div>
                    `;
                }
            }

            function renderizarRegras(rules, container) {
                const inscricao = rules.inscricao || {};
                const taxa = inscricao.taxa || 0;
                const prazo = inscricao.prazo_renovacao ? new Date(inscricao.prazo_renovacao) : null;
                const prazoFormatado = prazo ? prazo.toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit', year: 'numeric' }) : 'Nao definido';
                const status = rules.status || 'rascunho';

                // Status badge
                const statusConfig = {
                    'rascunho': { cor: 'bg-gray-500/20 text-gray-400 border-gray-500/30', texto: 'Rascunho' },
                    'aberto': { cor: 'bg-green-500/20 text-green-400 border-green-500/30', texto: 'Aberto' },
                    'encerrado': { cor: 'bg-red-500/20 text-red-400 border-red-500/30', texto: 'Encerrado' }
                };
                const statusBadge = statusConfig[status] || statusConfig['rascunho'];

                container.innerHTML = `
                    <!-- Status da Renovacao -->
                    <div class="flex items-center justify-between p-3 rounded-xl bg-white/5 border border-white/10">
                        <span class="text-sm text-white/70">Status Renovacao</span>
                        <span class="px-2 py-1 rounded-full text-xs font-medium border ${statusBadge.cor}">${statusBadge.texto}</span>
                    </div>

                    <!-- Taxa de Inscricao -->
                    <div class="p-4 rounded-xl bg-primary/10 border border-primary/20">
                        <div class="flex items-center gap-2 mb-2">
                            <span class="material-icons text-primary text-xl">payments</span>
                            <span class="text-sm font-medium text-white">Taxa de Inscricao</span>
                        </div>
                        <p class="text-2xl font-bold text-primary" style="font-family: 'JetBrains Mono', monospace;">
                            R$ ${taxa.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}
                        </p>
                    </div>

                    <!-- Prazo de Renovacao -->
                    <div class="p-3 rounded-xl bg-white/5 border border-white/10">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-2">
                                <span class="material-icons text-yellow-400 text-lg">event</span>
                                <span class="text-sm text-white/70">Prazo Renovacao</span>
                            </div>
                            <span class="text-sm font-medium text-white">${prazoFormatado}</span>
                        </div>
                    </div>

                    <!-- Regras Detalhadas -->
                    <div class="space-y-2">
                        <p class="text-xs font-medium text-white/50 uppercase tracking-wide px-1">Configuracoes</p>

                        <!-- Devedor pode renovar -->
                        <div class="flex items-center justify-between p-3 rounded-lg bg-white/5">
                            <div class="flex items-center gap-2">
                                <span class="material-icons text-lg ${inscricao.permitir_devedor_renovar ? 'text-green-400' : 'text-red-400'}">
                                    ${inscricao.permitir_devedor_renovar ? 'check_circle' : 'cancel'}
                                </span>
                                <span class="text-xs text-white/70">Devedor pode renovar</span>
                            </div>
                            <span class="text-xs font-medium ${inscricao.permitir_devedor_renovar ? 'text-green-400' : 'text-red-400'}">
                                ${inscricao.permitir_devedor_renovar ? 'Sim' : 'Nao'}
                            </span>
                        </div>

                        <!-- Aproveitar credito -->
                        <div class="flex items-center justify-between p-3 rounded-lg bg-white/5">
                            <div class="flex items-center gap-2">
                                <span class="material-icons text-lg ${inscricao.aproveitar_saldo_positivo ? 'text-green-400' : 'text-red-400'}">
                                    ${inscricao.aproveitar_saldo_positivo ? 'check_circle' : 'cancel'}
                                </span>
                                <span class="text-xs text-white/70">Credito abate taxa</span>
                            </div>
                            <span class="text-xs font-medium ${inscricao.aproveitar_saldo_positivo ? 'text-green-400' : 'text-red-400'}">
                                ${inscricao.aproveitar_saldo_positivo ? 'Sim' : 'Nao'}
                            </span>
                        </div>

                        <!-- Parcelamento -->
                        <div class="flex items-center justify-between p-3 rounded-lg bg-white/5">
                            <div class="flex items-center gap-2">
                                <span class="material-icons text-lg ${inscricao.permitir_parcelamento ? 'text-green-400' : 'text-white/30'}">
                                    ${inscricao.permitir_parcelamento ? 'check_circle' : 'cancel'}
                                </span>
                                <span class="text-xs text-white/70">Parcelamento</span>
                            </div>
                            <span class="text-xs font-medium ${inscricao.permitir_parcelamento ? 'text-green-400' : 'text-white/50'}">
                                ${inscricao.permitir_parcelamento ? `Ate ${inscricao.max_parcelas || 1}x` : 'Nao'}
                            </span>
                        </div>
                    </div>

                    <!-- Link para Premiacoes -->
                    <button onclick="fecharRegras2026(); setTimeout(() => window.abrirPremiacoes2026 && window.abrirPremiacoes2026(), 350);"
                            class="w-full flex items-center justify-between p-3 rounded-xl bg-primary/10 border border-primary/20 hover:bg-primary/20 transition-colors">
                        <div class="flex items-center gap-2">
                            <span class="material-icons text-primary">emoji_events</span>
                            <span class="text-sm text-white">Ver Premiacoes 2026</span>
                        </div>
                        <span class="material-icons text-white/30">chevron_right</span>
                    </button>
                `;
            }

            function fecharRegras2026() {
                const modal = document.getElementById('modal-regras-2026');
                const card = document.getElementById('regras-card');
                if (!modal || !card) return;

                modal.classList.add('opacity-0');
                card.classList.add('scale-95', 'opacity-0');
                setTimeout(() => {
                    modal.classList.add('hidden');
                }, 300);
            }

            // Fechar modal ao clicar fora
            document.getElementById('modal-regras-2026')?.addEventListener('click', function(e) {
                if (e.target === this) fecharRegras2026();
            });

            // Expor globalmente
            window.abrirRegras2026 = abrirRegras2026;
            window.fecharRegras2026 = fecharRegras2026;

            console.log('[REGRAS] Modal Regras 2026 carregado');
        </script>
    </body>
</html>
