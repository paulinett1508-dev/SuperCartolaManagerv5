<!-- MÓDULO RODADAS - HTML LIMPO E MODULAR -->
<!-- v2.2: Botão "Limpar Cache" REMOVIDO (era destrutivo) + Material Icons -->
<div id="rodadas" class="rodadas-module">
    <!-- Header do Módulo -->
    <div class="module-header-section">
        <div class="module-title-section">
            <div class="module-title-icon"><span class="material-icons">track_changes</span></div>
            <h2>Ranking por Rodada</h2>
        </div>
        <div class="module-subtitle">
            Classificação e premiação por rodada específica
        </div>

        <!-- APENAS BOTÃO DE RECALCULAR (SEGURO) -->
        <div class="admin-cache-buttons">
            <button
                class="btn-cache-admin recalc"
                onclick="abrirModalRecalcMini()"
                title="Recalcular posições"
            >
                <span class="material-icons">refresh</span>
            </button>
        </div>
    </div>

    <!-- Grid de Mini Cards das Rodadas -->
    <div class="rodadas-grid">
        <div id="rodadasCards" class="rodadas-cards-container">
            <!-- Será preenchido via JavaScript -->
        </div>
    </div>

    <!-- Loading State -->
    <div id="loading" class="loading-state" style="display: none">
        <div class="spinner"></div>
        <span>Carregando dados da rodada...</span>
    </div>

    <!-- Container Principal -->
    <div
        id="rodadaContentSection"
        class="rodada-content-section"
        style="display: none"
    >
        <div class="section-header">
            <div class="section-icon"><span class="material-icons">leaderboard</span></div>
            <h3 id="rodadaTituloAtual">Rodada Selecionada</h3>
            <!-- Botão de Refresh para Parciais -->
            <button
                id="btnRefreshParciais"
                class="btn-refresh-parciais"
                style="display: none"
            >
                <span class="material-icons refresh-icon">refresh</span>
                <span>Atualizar</span>
            </button>
        </div>

        <!-- App Mode Ranking List (Substituindo Tabela) -->
        <div id="rankingListContainer">
            <div class="ranking-header-bar">
               <div class="ranking-filter">
                 <span style="font-weight: 500; color: #fff;">Ranking Rodada</span>
               </div>
               <div class="ranking-order">
                 <span style="opacity: 0.7">Ordem:</span> <span class="filter-active" style="color:#3b82f6; border-color:#3b82f6;">Pontos</span>
               </div>
            </div>

            <div id="rankingList" class="ranking-list">
                <div style="padding: 30px; text-align: center; color: var(--text-muted);">
                    Selecione uma rodada para visualizar o ranking
                </div>
            </div>
        </div>

        <!-- Tabela Legada (Oculta) - Mantendo apenas se necessário referência JS mas o JS será atualizado -->
        <div class="table-container" style="display: none;">
            <table class="ranking-table">
                <tbody id="rankingBody"></tbody>
            </table>
        </div>
    </div>

    <!-- Seção de Relatório MITOS/MICOS -->
    <div
        id="relatorioMitosMicos"
        class="relatorio-section"
        style="display: none"
    >
        <div class="section-header">
            <div class="section-icon"><span class="material-icons">analytics</span></div>
            <h3>Histórico Completo: MITOS e MICOS</h3>
            <button
                id="btnFecharRelatorio"
                class="btn-fechar-relatorio"
                onclick="window.voltarParaCards ? window.voltarParaCards() : document.getElementById('relatorioMitosMicos').style.display='none'"
            >
                <span class="material-icons">close</span> Fechar
            </button>
        </div>

        <!-- Filtros (renderizados dinamicamente) -->
        <div class="relatorio-filtros">
            <!-- Será preenchido via JavaScript -->
        </div>

        <!-- Estatísticas Resumidas -->
        <div id="estatisticasResumo" class="estatisticas-resumo"></div>

        <!-- Container das Tabelas -->
        <div class="relatorio-container">
            <div id="relatorioContent" class="relatorio-content">
                <!-- Será preenchido via JavaScript -->
            </div>
        </div>
    </div>

    <!-- Botão Voltar -->
    <div class="module-actions">
        <button
            id="btnGerarRelatorioMitosMicos"
            class="btn-relatorio"
            onclick="window.gerarRelatorioMitosMicos && window.gerarRelatorioMitosMicos()"
        >
            <span class="material-icons">assessment</span> Gerar Relatório MITOS/MICOS
        </button>
        <button
            class="back-button"
            onclick="window.orquestrador?.voltarParaCards()"
        >
            <span class="material-icons">arrow_back</span> Voltar aos Cards
        </button>
    </div>
</div>

<style>
    .btn-refresh-parciais {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 8px 16px;
        background: linear-gradient(135deg, #3498db, #2980b9);
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 13px;
        font-weight: 600;
        margin-left: auto;
        transition: all 0.2s ease;
    }

    .btn-refresh-parciais:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(52, 152, 219, 0.4);
    }

    .btn-refresh-parciais:disabled {
        opacity: 0.6;
        cursor: not-allowed;
    }

    .btn-refresh-parciais .refresh-icon {
        font-size: 14px;
    }

    @keyframes spin {
        from {
            transform: rotate(0deg);
        }
        to {
            transform: rotate(360deg);
        }
    }

    .section-header {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 15px;
    }

    /* Botões Admin Cache */
    .module-header-section {
        position: relative;
    }
    .admin-cache-buttons {
        position: absolute;
        top: 20px;
        right: 20px;
        display: flex;
        gap: 8px;
        opacity: 0.5;
        transition: opacity 0.2s;
        z-index: 10;
    }
    .admin-cache-buttons:hover {
        opacity: 1;
    }
    .btn-cache-admin {
        width: 32px;
        height: 32px;
        border-radius: 6px;
        border: 1px solid;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s;
    }
    .btn-cache-admin.recalc {
        background: rgba(249, 115, 22, 0.1);
        border-color: rgba(249, 115, 22, 0.3);
        color: #f97316;
    }
    .btn-cache-admin.recalc:hover {
        background: rgba(249, 115, 22, 0.2);
        transform: translateY(-2px);
    }
    .btn-cache-admin .material-icons {
        font-size: 18px;
    }
</style>

<script>
    console.log(
        "[RODADAS-HTML] ✅ HTML do módulo rodadas carregado v2.1 (botão destrutivo removido)",
    );
</script>
