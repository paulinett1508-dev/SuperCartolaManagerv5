<!-- public/templates/luva-de-ouro.html - VERS√ÉO COMPACTA ADMIN -->
<style>
  /* S√≥ loading inicial - resto vem do CSS externo */
  #luvaDeOuroContent {
    min-height: 200px;
  }
  .luva-init-loading {
    text-align: center;
    padding: 40px;
  }
  .luva-init-loading .spinner {
    width: 30px;
    height: 30px;
    border: 2px solid rgba(74, 124, 35, 0.2);
    border-top-color: #4a7c23;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 0 auto 8px;
  }
  @keyframes spin {
    to {
      transform: rotate(360deg);
    }
  }
</style>

<div class="module-content">
  <!-- Container principal do m√≥dulo -->
  <div id="luvaDeOuroContent">
    <div class="luva-init-loading">
      <div class="spinner"></div>
      <p>Carregando Luva de Ouro...</p>
    </div>
  </div>
</div>

<script>
  // Inicializa√ß√£o autom√°tica do m√≥dulo
  (function () {
    console.log("ü•Ö [LUVA-HTML] Inicializando m√≥dulo Luva de Ouro...");

    let tentativas = 0;
    const maxTentativas = 30; // 6 segundos

    function verificarModulos() {
      const modulosNecessarios = [
        "LuvaDeOuroConfig",
        "LuvaDeOuroCore",
        "LuvaDeOuroUI",
        "LuvaDeOuroCache",
        "LuvaDeOuroOrquestrador",
      ];

      const faltando = modulosNecessarios.filter((mod) => !window[mod]);

      if (faltando.length === 0) {
        return true;
      }

      console.log(`‚è≥ [LUVA-HTML] Aguardando m√≥dulos: ${faltando.join(", ")}`);
      return false;
    }

    function tentarInicializar() {
      tentativas++;

      if (verificarModulos()) {
        console.log(
          "‚úÖ [LUVA-HTML] Todos os m√≥dulos carregados, inicializando...",
        );

        // Dar um pequeno delay para garantir que tudo est√° pronto
        setTimeout(() => {
          if (window.LuvaDeOuroOrquestrador?.inicializar) {
            window.LuvaDeOuroOrquestrador.inicializar();
          } else {
            console.error("‚ùå [LUVA-HTML] Orquestrador n√£o dispon√≠vel");
          }
        }, 100);

        return;
      }

      if (tentativas >= maxTentativas) {
        console.error("‚ùå [LUVA-HTML] Timeout aguardando m√≥dulos");
        const container = document.getElementById("luvaDeOuroContent");
        if (container) {
          container.innerHTML = `
            <div style="text-align: center; padding: 40px; color: #dc3545;">
              <p style="font-size: 24px; margin-bottom: 12px;">‚ùå</p>
              <p style="font-weight: 600;">Erro ao carregar m√≥dulo</p>
              <p style="font-size: 12px; color: #888; margin-top: 8px;">
                Verifique o console para mais detalhes
              </p>
              <button onclick="location.reload()" style="margin-top: 16px; padding: 8px 20px; background: #e67e22; border: none; border-radius: 6px; color: #fff; cursor: pointer;">
                Recarregar P√°gina
              </button>
            </div>
          `;
        }
        return;
      }

      setTimeout(tentarInicializar, 200);
    }

    // Iniciar verifica√ß√£o
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", tentarInicializar);
    } else {
      tentarInicializar();
    }
  })();
</script>
