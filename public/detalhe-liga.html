<!doctype html>
<html lang="pt-BR">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Detalhe da Liga - Super Cartola Manager</title>
        <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />

        <!-- CSS HIER√ÅRQUICO MODULAR -->
        <link rel="stylesheet" href="style.css" />
        <!-- GLOBAL -->
        <link rel="stylesheet" href="detalhe-liga.css" />
        <link rel="stylesheet" href="/css/modules/brasoes.css" />
        <!-- P√ÅGINA ESPEC√çFICO -->
        <link rel="stylesheet" href="css/base.css" />
        <!-- COMPONENTES REUTILIZ√ÅVEIS -->

        <!-- EXTERNAL DEPENDENCIES -->
        <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
            rel="stylesheet"
        />
    </head>
    
    <!-- Script de corre√ß√£o para participantes -->
    <script src="js/participantes-fix.js"></script>
    </body>
    </html>

    <body>
        <div class="app-container">
            <div id="sidebar-placeholder"></div>

            <main class="app-main">
                <div class="page-content">
                    <!-- Header da Liga Simplificado - APENAS 2 LINHAS GARANTIDAS -->
                    <div class="liga-header">
                        <h2 id="nomeLiga" class="liga-titulo">Nome da Liga</h2>
                        <p id="quantidadeTimes" class="liga-info">
                            0 participantes
                        </p>
                        <!-- GARANTIR: Apenas estes 2 elementos no header -->
                    </div>

                    <!-- Tela Principal - Cards com √çcones Emojis -->
                    <div id="main-screen" class="main-screen">
                        <div class="modules-grid">
                            <!-- Card Participantes -->
                            <div
                                class="module-card"
                                data-module="participantes"
                            >
                                <div class="module-header">
                                    <div class="module-icon">üë•</div>
                                    <h3 class="module-title">PARTICIPANTES</h3>
                                </div>
                                <ul class="module-items">
                                    <li>Lista completa</li>
                                    <li id="participantes-count">0 membros</li>
                                </ul>
                            </div>

                            <!-- Card Rankings -->
                            <div class="module-card" data-module="rankings">
                                <div class="module-header">
                                    <div class="module-icon">üìä</div>
                                    <h3 class="module-title">RANKINGS</h3>
                                </div>
                                <ul class="module-items">
                                    <li data-action="ranking-geral">
                                        Classifica√ß√£o Geral
                                    </li>
                                    <li data-action="parciais">
                                        Resultados Parciais
                                    </li>
                                    <li data-action="top10">Top 10 Melhores</li>
                                </ul>
                            </div>

                            <!-- Card Temporal -->
                            <div class="module-card" data-module="temporal">
                                <div class="module-header">
                                    <div class="module-icon">üìÖ</div>
                                    <h3 class="module-title">TEMPORAL</h3>
                                </div>
                                <ul class="module-items">
                                    <li data-action="rodadas">Por Rodadas</li>
                                    <li data-action="melhor-mes">Melhor M√™s</li>
                                </ul>
                            </div>

                            <!-- Card Competi√ß√µes -->
                            <div class="module-card" data-module="competicoes">
                                <div class="module-header">
                                    <div class="module-icon">‚ö°</div>
                                    <h3 class="module-title">COMPETI√á√ïES</h3>
                                </div>
                                <ul class="module-items">
                                    <li data-action="mata-mata">Mata-mata</li>
                                    <li data-action="pontos-corridos">
                                        Pontos Corridos
                                    </li>
                                </ul>
                            </div>

                            <!-- Card Pr√™mios -->
                            <div class="module-card" data-module="premios">
                                <div class="module-header">
                                    <div class="module-icon">üèÜ</div>
                                    <h3 class="module-title">PR√äMIOS</h3>
                                </div>
                                <ul class="module-items">
                                    <li data-action="luva-de-ouro">
                                        Luva de Ouro
                                    </li>
                                    <li data-action="artilheiro-campeao">
                                        Artilheiro
                                    </li>
                                </ul>
                            </div>

                            <!-- Card Financeiro -->
                            <div class="module-card" data-module="financeiro">
                                <div class="module-header">
                                    <div class="module-icon">üí∞</div>
                                    <h3 class="module-title">FINANCEIRO</h3>
                                </div>
                                <ul class="module-items">
                                    <li data-action="fluxo-financeiro">
                                        Fluxo Financeiro
                                    </li>
                                    <li>Extrato Detalhado</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Tela Secund√°ria - Conte√∫do Din√¢mico -->
                    <div id="secondary-screen" class="dynamic-content">
                        <div id="dynamic-content-area">
                            <!-- Conte√∫do ser√° injetado aqui dinamicamente -->
                        </div>
                    </div>
                </div>
            </main>

            <!-- Overlay de Loading -->
            <div id="processing-overlay" class="processing-overlay">
                <div class="spinner"></div>
                <div class="processing-text">Carregando dados...</div>
            </div>
        </div>

        <!-- Bootstrap JS -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

        <!-- SCRIPTS MODULARES - SEM C√ìDIGO INLINE -->
        <script src="js/cards-condicionais.js"></script>
        <script src="js/sistema-modulos-init.js"></script>
        <script type="module" src="js/detalhe-liga-orquestrador.js"></script>

        <!-- M√ìDULOS JS EXISTENTES - MANTIDOS PARA COMPATIBILIDADE -->
        <script type="module" src="js/utils.js"></script>
        <script type="module" src="js/navigation.js"></script>
        <script src="js/seletor-ligas.js"></script>

        <!-- SCRIPT DOS BRAS√ïES -->
        <script src="js/participantes-brasoes.js"></script>

        <!-- SCRIPT PARA CARREGAR BRAS√ïES NO MOMENTO CERTO -->
        <script>
            // Aguardar o carregamento completo do DOM
            document.addEventListener("DOMContentLoaded", function () {
                console.log(
                    "DOM carregado, iniciando observer para m√≥dulo participantes",
                );

                // Fun√ß√£o para tentar carregar os bras√µes
                function tentarCarregarBrasoes() {
                    const grid = document.getElementById("participantes-grid");
                    if (
                        grid &&
                        typeof carregarParticipantesComBrasoes === "function"
                    ) {
                        console.log(
                            "Grid de participantes encontrado, carregando bras√µes...",
                        );
                        // Pequeno delay para garantir que o m√≥dulo est√° completamente carregado
                        setTimeout(() => {
                            carregarParticipantesComBrasoes();
                        }, 1000);
                        return true;
                    }
                    return false;
                }

                // Observer para detectar quando o m√≥dulo participantes √© carregado
                const observer = new MutationObserver(function (mutations) {
                    mutations.forEach(function (mutation) {
                        // Verifica se novos nodes foram adicionados
                        if (
                            mutation.type === "childList" &&
                            mutation.addedNodes.length > 0
                        ) {
                            // Procura pelo m√≥dulo participantes
                            mutation.addedNodes.forEach(function (node) {
                                if (node.nodeType === 1) {
                                    // √â um elemento
                                    // Verifica se √© o m√≥dulo participantes ou cont√©m ele
                                    if (
                                        node.id === "participantes-content" ||
                                        (node.querySelector &&
                                            node.querySelector(
                                                "#participantes-content",
                                            ))
                                    ) {
                                        console.log(
                                            "M√≥dulo participantes detectado!",
                                        );
                                        // Tenta carregar os bras√µes
                                        setTimeout(() => {
                                            if (tentarCarregarBrasoes()) {
                                                observer.disconnect();
                                            }
                                        }, 500);
                                    }
                                }
                            });
                        }
                    });
                });

                // Observa mudan√ßas no container principal e na √°rea de conte√∫do din√¢mico
                const containers = [
                    document.getElementById("dynamic-content-area"),
                    document.getElementById("secondary-screen"),
                    document.body,
                ];

                containers.forEach((container) => {
                    if (container) {
                        observer.observe(container, {
                            childList: true,
                            subtree: true,
                        });
                    }
                });

                // Tamb√©m adiciona listener para cliques no card de participantes
                document.addEventListener("click", function (e) {
                    const moduleCard = e.target.closest(
                        '[data-module="participantes"]',
                    );
                    if (moduleCard) {
                        console.log(
                            "Card participantes clicado, tentando carregar bras√µes em 2 segundos...",
                        );
                        setTimeout(() => {
                            tentarCarregarBrasoes();
                        }, 2000);
                    }
                });

                // Tenta carregar imediatamente caso o m√≥dulo j√° esteja presente
                tentarCarregarBrasoes();
            });
        </script>
    </body>
</html>
