<!doctype html>
<html lang="pt-BR">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Analisar Participantes - Super Cartola Manager</title>
        <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
        <!-- Design Tokens (SEMPRE PRIMEIRO) -->
        <link rel="stylesheet" href="css/_admin-tokens.css" />
        <link rel="stylesheet" href="style.css" />
        <link rel="stylesheet" href="css/modules/dashboard-redesign.css" />
        <link rel="stylesheet" href="css/modules/layout-horizontal.css" />
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Russo+One&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet" />
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
        <style>
            /* ============================================================
               ANALISAR PARTICIPANTES - v1.0
               ============================================================ */

            .analisar-page {
                background: #121212;
                min-height: 100vh;
            }

            .analisar-content {
                padding: 20px 16px;
                max-width: 1200px;
                margin: 0 auto;
            }

            /* Header */
            .analisar-header {
                background: #1a1a1a;
                border-radius: 10px;
                padding: 16px 18px;
                margin-bottom: 16px;
                border: 1px solid #2d2d2d;
                display: flex;
                align-items: center;
                justify-content: space-between;
            }

            .analisar-header-info h1 {
                font-family: 'Russo One', sans-serif;
                font-size: 1.2rem;
                font-weight: 400;
                color: #ffffff;
                margin: 0 0 4px 0;
            }

            .analisar-header-info p {
                font-size: 0.75rem;
                color: #9ca3af;
                margin: 0;
            }

            .btn-voltar {
                display: inline-flex;
                align-items: center;
                gap: 4px;
                padding: 8px 14px;
                background: #252525;
                color: #9ca3af;
                border: 1px solid #2d2d2d;
                border-radius: 6px;
                font-size: 0.75rem;
                font-weight: 500;
                text-decoration: none;
                transition: all 0.2s ease;
            }

            .btn-voltar:hover {
                background: #2d2d2d;
                color: #FF5500;
                border-color: #FF5500;
            }

            .btn-voltar .material-icons {
                font-size: 16px;
            }

            /* Stats Cards */
            .stats-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 10px;
                margin-bottom: 16px;
            }

            .stat-card {
                background: #1a1a1a;
                border: 1px solid #2d2d2d;
                border-radius: 10px;
                padding: 14px;
                text-align: center;
                transition: border-color 0.2s;
            }

            .stat-card:hover {
                border-color: #3d3d3d;
            }

            .stat-card .stat-icon {
                font-size: 20px;
                margin-bottom: 6px;
                color: #9ca3af;
            }

            .stat-card .stat-value {
                font-family: 'JetBrains Mono', monospace;
                font-size: 1.5rem;
                font-weight: 600;
                color: #fff;
                line-height: 1.2;
            }

            .stat-card .stat-label {
                font-size: 0.7rem;
                color: #6b7280;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                margin-top: 2px;
            }

            .stat-card.alerta .stat-value { color: #f59e0b; }
            .stat-card.perigo .stat-value { color: #ef4444; }
            .stat-card.sucesso .stat-value { color: #22c55e; }
            .stat-card.info .stat-value { color: #3b82f6; }

            /* Filtros */
            .filtros-bar {
                background: #1a1a1a;
                border: 1px solid #2d2d2d;
                border-radius: 10px;
                padding: 12px 14px;
                margin-bottom: 16px;
                display: flex;
                gap: 10px;
                flex-wrap: wrap;
                align-items: center;
            }

            .filtro-grupo {
                display: flex;
                align-items: center;
                gap: 6px;
            }

            .filtro-grupo label {
                font-size: 0.7rem;
                color: #6b7280;
                text-transform: uppercase;
                font-weight: 600;
                letter-spacing: 0.3px;
                white-space: nowrap;
            }

            .filtro-select, .filtro-input {
                background: #252525;
                border: 1px solid #374151;
                border-radius: 6px;
                color: #fff;
                font-size: 0.8rem;
                padding: 6px 10px;
                outline: none;
                transition: border-color 0.2s;
            }

            .filtro-select:focus, .filtro-input:focus {
                border-color: #FF5500;
            }

            .filtro-input {
                min-width: 180px;
            }

            .filtro-separator {
                width: 1px;
                height: 24px;
                background: #374151;
            }

            .btn-filtro-acao {
                padding: 6px 12px;
                background: #FF5500;
                color: #fff;
                border: none;
                border-radius: 6px;
                font-size: 0.75rem;
                font-weight: 600;
                cursor: pointer;
                display: flex;
                align-items: center;
                gap: 4px;
                transition: background 0.2s;
            }

            .btn-filtro-acao:hover {
                background: #e64d00;
            }

            .btn-filtro-acao .material-icons {
                font-size: 14px;
            }

            .btn-filtro-secundario {
                padding: 6px 12px;
                background: #252525;
                color: #9ca3af;
                border: 1px solid #374151;
                border-radius: 6px;
                font-size: 0.75rem;
                cursor: pointer;
                display: flex;
                align-items: center;
                gap: 4px;
                transition: all 0.2s;
            }

            .btn-filtro-secundario:hover {
                background: #2d2d2d;
                color: #fff;
                border-color: #FF5500;
            }

            .btn-filtro-secundario .material-icons {
                font-size: 14px;
            }

            /* Tabela de Participantes */
            .tabela-container {
                background: #1a1a1a;
                border: 1px solid #2d2d2d;
                border-radius: 10px;
                overflow: hidden;
            }

            .tabela-header {
                padding: 12px 14px;
                border-bottom: 1px solid #2d2d2d;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            .tabela-header h3 {
                font-family: 'Russo One', sans-serif;
                font-size: 0.9rem;
                color: #fff;
                margin: 0;
                font-weight: 400;
            }

            .tabela-count {
                font-family: 'JetBrains Mono', monospace;
                font-size: 0.75rem;
                color: #FF5500;
                background: rgba(255, 85, 0, 0.1);
                padding: 2px 8px;
                border-radius: 10px;
            }

            .tabela-scroll {
                overflow-x: auto;
                max-height: 65vh;
                overflow-y: auto;
            }

            table.participantes-table {
                width: 100%;
                border-collapse: collapse;
                font-size: 0.8rem;
            }

            .participantes-table thead {
                position: sticky;
                top: 0;
                z-index: 10;
            }

            .participantes-table th {
                background: #252525;
                color: #9ca3af;
                font-weight: 600;
                font-size: 0.7rem;
                text-transform: uppercase;
                letter-spacing: 0.3px;
                padding: 8px 10px;
                text-align: left;
                white-space: nowrap;
                border-bottom: 1px solid #374151;
            }

            .participantes-table td {
                padding: 8px 10px;
                color: #d1d5db;
                border-bottom: 1px solid #1f1f1f;
                vertical-align: middle;
            }

            .participantes-table tbody tr:hover {
                background: rgba(255, 85, 0, 0.04);
            }

            /* Célula com info do participante */
            .participante-info {
                display: flex;
                align-items: center;
                gap: 8px;
            }

            .participante-escudo {
                width: 28px;
                height: 28px;
                border-radius: 50%;
                background: #252525;
                display: flex;
                align-items: center;
                justify-content: center;
                flex-shrink: 0;
                overflow: hidden;
            }

            .participante-escudo img {
                width: 100%;
                height: 100%;
                object-fit: cover;
            }

            .participante-escudo .material-icons {
                font-size: 16px;
                color: #6b7280;
            }

            .participante-nomes {
                min-width: 0;
            }

            .participante-nomes .nome-cartola {
                font-weight: 600;
                color: #fff;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                max-width: 180px;
            }

            .participante-nomes .nome-time {
                font-size: 0.7rem;
                color: #6b7280;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                max-width: 180px;
            }

            /* Badges */
            .badge-status {
                font-size: 0.65rem;
                padding: 2px 8px;
                border-radius: 10px;
                font-weight: 600;
                text-transform: uppercase;
                letter-spacing: 0.3px;
            }

            .badge-ativo { background: rgba(34, 197, 94, 0.15); color: #22c55e; }
            .badge-inativo { background: rgba(239, 68, 68, 0.15); color: #ef4444; }
            .badge-com-senha { background: rgba(59, 130, 246, 0.15); color: #3b82f6; }
            .badge-sem-senha { background: rgba(245, 158, 11, 0.15); color: #f59e0b; }
            .badge-incompleto { background: rgba(239, 68, 68, 0.15); color: #ef4444; }

            /* Time ID mono */
            .time-id-mono {
                font-family: 'JetBrains Mono', monospace;
                font-size: 0.75rem;
                color: #9ca3af;
            }

            /* Ações inline */
            .acoes-cell {
                display: flex;
                gap: 4px;
            }

            .btn-acao-inline {
                padding: 4px 6px;
                background: #252525;
                border: 1px solid #374151;
                border-radius: 4px;
                color: #9ca3af;
                cursor: pointer;
                display: flex;
                align-items: center;
                transition: all 0.15s;
            }

            .btn-acao-inline:hover {
                background: #2d2d2d;
                color: #FF5500;
                border-color: #FF5500;
            }

            .btn-acao-inline .material-icons {
                font-size: 16px;
            }

            /* Liga badge */
            .liga-badge {
                font-size: 0.65rem;
                background: #252525;
                color: #9ca3af;
                padding: 2px 6px;
                border-radius: 4px;
                white-space: nowrap;
                max-width: 120px;
                overflow: hidden;
                text-overflow: ellipsis;
                display: inline-block;
            }

            /* Modal de Senha */
            .modal-overlay {
                display: none;
                position: fixed;
                inset: 0;
                background: rgba(0, 0, 0, 0.7);
                z-index: 9999;
                align-items: center;
                justify-content: center;
            }

            .modal-overlay.active {
                display: flex;
            }

            .modal-content {
                background: #1f2937;
                border-radius: 12px;
                padding: 24px;
                max-width: 420px;
                width: 90%;
                border: 1px solid #374151;
            }

            .modal-title {
                font-family: 'Russo One', sans-serif;
                font-size: 1rem;
                color: #fff;
                margin: 0 0 16px 0;
                font-weight: 400;
                display: flex;
                align-items: center;
                gap: 8px;
            }

            .modal-title .material-icons {
                color: #FF5500;
            }

            .modal-field {
                margin-bottom: 12px;
            }

            .modal-field label {
                display: block;
                font-size: 0.75rem;
                color: #9ca3af;
                margin-bottom: 4px;
                font-weight: 600;
            }

            .modal-field input {
                width: 100%;
                padding: 8px 12px;
                background: #111827;
                border: 1px solid #374151;
                border-radius: 6px;
                color: #fff;
                font-size: 0.85rem;
                box-sizing: border-box;
            }

            .modal-field input:focus {
                border-color: #FF5500;
                outline: none;
            }

            .modal-actions {
                display: flex;
                gap: 10px;
                margin-top: 16px;
            }

            .modal-btn-primary {
                flex: 1;
                padding: 10px;
                background: #FF5500;
                color: #fff;
                border: none;
                border-radius: 8px;
                font-weight: 600;
                cursor: pointer;
                font-size: 0.85rem;
            }

            .modal-btn-primary:hover { background: #e64d00; }

            .modal-btn-secondary {
                padding: 10px 16px;
                background: #374151;
                color: #d1d5db;
                border: none;
                border-radius: 8px;
                cursor: pointer;
                font-size: 0.85rem;
            }

            .modal-btn-secondary:hover { background: #4b5563; }

            /* Loading */
            .loading-state {
                text-align: center;
                padding: 40px;
                color: #6b7280;
            }

            .loading-spinner {
                width: 28px;
                height: 28px;
                border: 3px solid #2d2d2d;
                border-top-color: #FF5500;
                border-radius: 50%;
                animation: spin 0.8s linear infinite;
                margin: 0 auto 12px;
            }

            @keyframes spin {
                to { transform: rotate(360deg); }
            }

            /* Empty state */
            .empty-state {
                text-align: center;
                padding: 40px;
                color: #6b7280;
            }

            .empty-state .material-icons {
                font-size: 48px;
                margin-bottom: 8px;
                color: #374151;
            }

            /* Resumo por liga (cards colapsáveis) */
            .ligas-resumo {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
                gap: 10px;
                margin-bottom: 16px;
            }

            .liga-resumo-card {
                background: #1a1a1a;
                border: 1px solid #2d2d2d;
                border-radius: 8px;
                padding: 12px;
                cursor: pointer;
                transition: all 0.2s;
            }

            .liga-resumo-card:hover {
                border-color: #FF5500;
            }

            .liga-resumo-card.selected {
                border-color: #FF5500;
                background: rgba(255, 85, 0, 0.05);
            }

            .liga-resumo-nome {
                font-weight: 600;
                color: #fff;
                font-size: 0.85rem;
                margin-bottom: 6px;
            }

            .liga-resumo-stats {
                display: flex;
                gap: 12px;
                font-size: 0.7rem;
                color: #6b7280;
            }

            .liga-resumo-stats span {
                display: flex;
                align-items: center;
                gap: 3px;
            }

            .liga-resumo-stats .material-icons {
                font-size: 13px;
            }

            /* ============================================================
               DATA LAKE MODAL - Estilo Cartola (Dark Mode)
               Usa variaveis do _admin-tokens.css
               ============================================================ */
            .modal-dump-content {
                max-width: 680px;
                width: 95%;
                max-height: 90vh;
                overflow-y: auto;
                background: var(--surface-bg, #121212);
                border: 1px solid #2d2d2d;
                padding: 0;
                border-radius: var(--radius-xl, 16px);
                position: relative;
            }

            .dl-header {
                background: var(--surface-card, #1a1a1a);
                text-align: center;
                padding: 24px 20px 16px;
                border-bottom: 1px solid #2d2d2d;
                position: relative;
                border-radius: var(--radius-xl, 16px) var(--radius-xl, 16px) 0 0;
            }

            .dl-header-label {
                font-family: var(--font-family-brand, 'Russo One', sans-serif);
                font-size: 0.7rem;
                letter-spacing: 2px;
                color: var(--text-muted, #a0a0a0);
                text-transform: uppercase;
                margin-bottom: 16px;
            }

            .dl-close-btn {
                position: absolute;
                top: 12px;
                right: 12px;
                background: none;
                border: none;
                color: #6b7280;
                cursor: pointer;
                padding: 4px;
                border-radius: 50%;
                transition: all 0.2s;
            }
            .dl-close-btn:hover { color: #fff; background: #333; }

            .dl-team-badge {
                width: 80px;
                height: 80px;
                border-radius: 50%;
                margin: 0 auto 8px;
                overflow: hidden;
                border: 3px solid #374151;
                background: #252525;
                position: relative;
            }
            .dl-team-badge img {
                width: 100%;
                height: 100%;
                object-fit: cover;
            }
            .dl-foto-perfil {
                position: absolute;
                bottom: -4px;
                right: -4px;
                width: 32px;
                height: 32px;
                border-radius: 50%;
                border: 2px solid #1a1a1a;
                object-fit: cover;
            }
            .dl-pro-badge {
                display: inline-block;
                background: var(--color-primary, #FF5500);
                color: #fff;
                font-size: 0.6rem;
                font-weight: 700;
                padding: 2px 8px;
                border-radius: 4px;
                margin-bottom: 6px;
                letter-spacing: 1px;
            }
            .dl-team-name {
                font-family: var(--font-family-brand, 'Russo One', sans-serif);
                font-size: 1.1rem;
                color: var(--text-primary, #ffffff);
                margin: 4px 0 2px;
            }
            .dl-cartoleiro-name {
                font-size: 0.8rem;
                color: var(--text-muted, #a0a0a0);
            }

            /* Round slider */
            .dl-round-bar {
                background: var(--surface-card, #1a1a1a);
                padding: 16px 20px;
                border-bottom: 1px solid #2d2d2d;
            }
            .dl-round-slider {
                position: relative;
                height: 32px;
                display: flex;
                align-items: center;
            }
            .dl-round-track {
                flex: 1;
                height: 6px;
                background: #374151;
                border-radius: 3px;
                position: relative;
            }
            .dl-round-fill {
                height: 100%;
                background: var(--color-primary, #FF5500);
                border-radius: 3px;
                transition: width 0.3s ease;
            }
            .dl-round-ball {
                position: absolute;
                top: 50%;
                transform: translate(-50%, -50%);
                width: 28px;
                height: 28px;
                background: var(--surface-card, #1a1a1a);
                border: 3px solid var(--color-primary, #FF5500);
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-family: var(--font-family-mono, 'JetBrains Mono', monospace);
                font-size: 0.6rem;
                font-weight: 700;
                color: var(--color-primary, #FF5500);
                z-index: 2;
                transition: left 0.3s ease;
            }
            .dl-round-labels {
                display: flex;
                justify-content: space-between;
                font-size: 0.7rem;
                color: #6b7280;
                margin-top: 2px;
            }
            .dl-round-cta {
                text-align: center;
                font-size: 0.75rem;
                color: var(--text-muted, #a0a0a0);
                margin-top: 6px;
            }
            .dl-round-cta strong { color: var(--text-primary, #ffffff); }

            /* Score cards section */
            .dl-body {
                padding: 16px;
            }
            .dl-score-section {
                background: var(--surface-card, #1a1a1a);
                border: 1px solid #2d2d2d;
                border-radius: var(--radius-lg, 12px);
                padding: 20px;
                margin-bottom: 12px;
            }
            .dl-score-row {
                display: flex;
                align-items: center;
                justify-content: space-between;
                padding: 12px 0;
            }
            .dl-score-row + .dl-score-row {
                border-top: 1px solid #2d2d2d;
            }
            .dl-score-left {
                display: flex;
                align-items: center;
                gap: 12px;
            }
            .dl-score-icon {
                width: 48px;
                height: 48px;
                display: flex;
                align-items: center;
                justify-content: center;
            }
            .dl-score-icon img {
                max-width: 100%;
                max-height: 100%;
            }
            .dl-score-label {
                font-size: 0.65rem;
                color: #6b7280;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                font-weight: 600;
            }
            .dl-score-value {
                font-family: var(--font-family-mono, 'JetBrains Mono', monospace);
                font-size: 1.8rem;
                font-weight: 700;
                color: var(--text-primary, #ffffff);
                line-height: 1;
            }
            .dl-score-right {
                text-align: right;
            }
            .dl-score-right .dl-score-label {
                margin-bottom: 2px;
            }
            .dl-score-right .dl-score-value {
                font-size: 1.3rem;
                color: var(--text-secondary, #e0e0e0);
            }
            .dl-patrimonio-change {
                font-family: var(--font-family-mono, 'JetBrains Mono', monospace);
                font-size: 0.8rem;
                font-weight: 600;
                margin-left: 6px;
            }
            .dl-patrimonio-change.down { color: var(--color-danger, #ef4444); }
            .dl-patrimonio-change.up { color: var(--color-success-light, #22c55e); }

            /* Player cards section */
            .dl-players-section {
                background: var(--surface-card, #1a1a1a);
                border: 1px solid #2d2d2d;
                border-radius: var(--radius-lg, 12px);
                padding: 16px;
                margin-bottom: 12px;
            }
            .dl-players-grid {
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                gap: 12px;
            }
            .dl-player-card {
                text-align: center;
                padding: 12px 8px;
                border: 1px solid #2d2d2d;
                border-radius: 10px;
                position: relative;
                background: var(--surface-card-elevated, #2a2a2a);
            }
            .dl-player-card-label {
                font-size: 0.6rem;
                font-weight: 700;
                color: #6b7280;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                margin-bottom: 8px;
            }
            .dl-jersey {
                width: 64px;
                height: 64px;
                margin: 0 auto 6px;
                border-radius: 8px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-family: var(--font-family-brand, 'Russo One', sans-serif);
                font-size: 0.75rem;
                color: #fff;
                position: relative;
                background: #555;
            }
            .dl-jersey-badge {
                position: absolute;
                top: -4px;
                right: -4px;
                width: 20px;
                height: 20px;
                border-radius: 50%;
                overflow: hidden;
                border: 1px solid #374151;
                background: #252525;
            }
            .dl-jersey-badge img {
                width: 100%;
                height: 100%;
                object-fit: contain;
            }
            .dl-captain-icon {
                position: absolute;
                bottom: -4px;
                left: -4px;
                width: 22px;
                height: 22px;
                background: var(--color-primary, #FF5500);
                color: #fff;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 0.7rem;
                font-weight: 700;
                border: 2px solid #1a1a1a;
            }
            .dl-thumb-icon {
                position: absolute;
                bottom: -4px;
                left: 50%;
                transform: translateX(-50%);
                font-size: 18px;
            }
            .dl-player-name {
                font-family: var(--font-family-brand, 'Russo One', sans-serif);
                font-size: 0.75rem;
                color: var(--text-primary, #ffffff);
                text-transform: uppercase;
                margin-bottom: 2px;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }
            .dl-player-pos {
                font-size: 0.65rem;
                color: #6b7280;
                text-transform: uppercase;
                margin-bottom: 4px;
            }
            .dl-player-score {
                font-family: var(--font-family-mono, 'JetBrains Mono', monospace);
                font-size: 1.1rem;
                font-weight: 700;
            }
            .dl-player-score.positive { color: var(--color-success-light, #22c55e); }
            .dl-player-score.negative { color: var(--color-danger, #ef4444); }
            .dl-player-score.neutral { color: #6b7280; }
            .dl-captain-multiplier {
                font-size: 0.6rem;
                color: var(--color-primary, #FF5500);
                font-weight: 600;
            }

            /* Bench section */
            .dl-bench-section {
                background: var(--surface-card, #1a1a1a);
                border: 1px solid #2d2d2d;
                border-radius: var(--radius-lg, 12px);
                padding: 16px;
                margin-bottom: 12px;
            }
            .dl-bench-title {
                font-family: var(--font-family-brand, 'Russo One', sans-serif);
                font-size: 0.75rem;
                color: var(--text-muted, #a0a0a0);
                text-transform: uppercase;
                text-align: center;
                margin-bottom: 12px;
                letter-spacing: 1px;
            }
            .dl-bench-grid {
                display: flex;
                flex-wrap: wrap;
                gap: 8px;
                justify-content: center;
            }
            .dl-bench-player {
                display: flex;
                align-items: center;
                gap: 8px;
                padding: 6px 10px;
                background: var(--surface-card-elevated, #2a2a2a);
                border-radius: 8px;
                border: 1px solid #2d2d2d;
            }
            .dl-bench-jersey {
                width: 36px;
                height: 36px;
                border-radius: 6px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 0.55rem;
                color: #fff;
                background: #555;
                position: relative;
            }
            .dl-bench-jersey .dl-jersey-badge {
                width: 14px;
                height: 14px;
                top: -2px;
                right: -2px;
            }
            .dl-bench-info {
                min-width: 0;
            }
            .dl-bench-name {
                font-size: 0.7rem;
                font-weight: 600;
                color: var(--text-secondary, #e0e0e0);
            }
            .dl-bench-pos {
                font-size: 0.6rem;
                color: #6b7280;
                text-transform: uppercase;
            }
            .dl-bench-score {
                font-family: var(--font-family-mono, 'JetBrains Mono', monospace);
                font-size: 0.8rem;
                font-weight: 700;
                margin-left: auto;
            }

            /* Lineup grid (all 12 players) */
            .dl-lineup-section {
                background: var(--surface-card, #1a1a1a);
                border: 1px solid #2d2d2d;
                border-radius: var(--radius-lg, 12px);
                padding: 16px;
                margin-bottom: 12px;
            }
            .dl-lineup-title {
                font-family: var(--font-family-brand, 'Russo One', sans-serif);
                font-size: 0.75rem;
                color: var(--text-muted, #a0a0a0);
                text-transform: uppercase;
                text-align: center;
                margin-bottom: 12px;
                letter-spacing: 1px;
            }
            .dl-lineup-grid {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
                gap: 8px;
            }
            .dl-lineup-player {
                display: flex;
                align-items: center;
                gap: 8px;
                padding: 8px 10px;
                background: var(--surface-card-elevated, #2a2a2a);
                border-radius: 8px;
                border: 1px solid #2d2d2d;
            }
            .dl-lineup-player.is-captain {
                border-color: var(--color-primary, #FF5500);
                background: var(--color-primary-muted, rgba(255, 85, 0, 0.1));
            }

            /* Performance chart */
            .dl-chart-section {
                background: var(--surface-card, #1a1a1a);
                border: 1px solid #2d2d2d;
                border-radius: var(--radius-lg, 12px);
                padding: 16px;
                margin-bottom: 12px;
            }
            .dl-chart-title {
                font-size: 0.75rem;
                color: var(--text-muted, #a0a0a0);
                margin-bottom: 12px;
            }
            .dl-chart-container {
                display: flex;
                align-items: flex-end;
                gap: 2px;
                height: 100px;
                padding: 0 4px;
            }
            .dl-chart-bar-wrap {
                flex: 1;
                display: flex;
                flex-direction: column;
                align-items: center;
                height: 100%;
                justify-content: flex-end;
                cursor: pointer;
            }
            .dl-chart-bar {
                width: 100%;
                max-width: 16px;
                border-radius: 3px 3px 0 0;
                transition: all 0.2s;
                min-height: 2px;
            }
            .dl-chart-bar.positive { background: var(--color-success-light, #22c55e); }
            .dl-chart-bar.negative { background: var(--color-danger, #ef4444); }
            .dl-chart-bar.selected { background: var(--color-primary, #FF5500); }
            .dl-chart-bar.empty { background: #374151; }
            .dl-chart-bar-wrap:hover .dl-chart-bar { opacity: 0.7; }
            .dl-chart-labels {
                display: flex;
                gap: 2px;
                margin-top: 4px;
                padding: 0 4px;
            }
            .dl-chart-label {
                flex: 1;
                text-align: center;
                font-size: 0.5rem;
                color: #4b5563;
            }
            .dl-chart-label.selected { color: var(--color-primary, #FF5500); font-weight: 700; }
            .dl-chart-tooltip {
                font-family: var(--font-family-mono, 'JetBrains Mono', monospace);
                font-size: 0.55rem;
                color: var(--text-muted, #a0a0a0);
                margin-bottom: 2px;
            }

            /* Round selector */
            .dl-round-selector {
                background: var(--surface-card, #1a1a1a);
                border: 1px solid #2d2d2d;
                border-radius: var(--radius-lg, 12px);
                padding: 12px 16px;
                margin-bottom: 12px;
            }
            .dl-round-select {
                width: 100%;
                padding: 10px 12px;
                border: 1px solid #374151;
                border-radius: 8px;
                font-size: 0.85rem;
                color: var(--text-primary, #ffffff);
                background: var(--surface-card-elevated, #2a2a2a);
                cursor: pointer;
            }
            .dl-round-select:focus {
                outline: none;
                border-color: var(--color-primary, #FF5500);
            }

            /* Stats bar at bottom */
            .dl-stats-bar {
                background: var(--surface-card-elevated, #2a2a2a);
                display: flex;
                justify-content: space-around;
                padding: 14px 16px;
                border-radius: 0 0 var(--radius-xl, 16px) var(--radius-xl, 16px);
            }
            .dl-stat-item {
                text-align: center;
            }
            .dl-stat-item .dl-score-label {
                margin-bottom: 2px;
            }
            .dl-stat-item .dl-score-value {
                font-size: 1.2rem;
            }

            /* Sync/empty states */
            .dl-empty-state {
                text-align: center;
                padding: 40px 20px;
                background: var(--surface-card, #1a1a1a);
                border: 1px solid #2d2d2d;
                border-radius: var(--radius-lg, 12px);
                margin: 16px;
            }
            .dl-empty-state h4 {
                font-family: var(--font-family-base, 'Inter', sans-serif);
                font-weight: 600;
                color: var(--text-secondary, #e0e0e0);
                margin: 12px 0 6px;
            }
            .dl-empty-state p {
                font-size: 0.75rem;
                color: #6b7280;
                max-width: 380px;
                margin: 0 auto 16px;
            }
            .btn-sync-dump {
                display: inline-flex;
                align-items: center;
                gap: 6px;
                padding: 10px 20px;
                background: var(--color-primary, #FF5500);
                color: #fff;
                border: none;
                border-radius: 8px;
                font-size: 0.8rem;
                font-weight: 600;
                cursor: pointer;
                transition: background 0.2s;
            }
            .btn-sync-dump:hover { background: var(--color-primary-dark, #e64d00); }
            .btn-sync-dump .material-icons { font-size: 18px; }

            .dl-sync-bar {
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 8px;
                padding: 8px;
                background: var(--surface-card, #1a1a1a);
                border-bottom: 1px solid #2d2d2d;
            }
            .dl-sync-btn {
                background: none;
                border: 1px solid #374151;
                color: #9ca3af;
                border-radius: 6px;
                padding: 4px 10px;
                cursor: pointer;
                display: flex;
                align-items: center;
                gap: 4px;
                font-size: 0.7rem;
                transition: all 0.2s;
            }
            .dl-sync-btn:hover {
                color: var(--color-primary, #FF5500);
                border-color: var(--color-primary, #FF5500);
            }
            .dl-sync-btn .material-icons { font-size: 14px; }
            .dl-sync-info {
                font-size: 0.65rem;
                color: #6b7280;
            }

            @media (max-width: 480px) {
                .dl-players-grid {
                    grid-template-columns: 1fr;
                }
                .dl-score-value {
                    font-size: 1.4rem;
                }
            }

            /* Responsive */
            @media (max-width: 768px) {
                .stats-grid {
                    grid-template-columns: repeat(3, 1fr);
                }

                .filtros-bar {
                    flex-direction: column;
                    align-items: stretch;
                }

                .filtro-separator {
                    display: none;
                }

                .filtro-input {
                    min-width: auto;
                    width: 100%;
                }

                .participante-nomes .nome-cartola,
                .participante-nomes .nome-time {
                    max-width: 120px;
                }
            }
        </style>
    </head>

    <body class="analisar-participantes-page">
        <div class="app-container">
            <div id="sidebar-placeholder"></div>

            <main class="app-main analisar-page">
                <div class="analisar-content">
                    <!-- Header -->
                    <header class="analisar-header">
                        <div class="analisar-header-info">
                            <h1>Analisar Participantes</h1>
                            <p>Gestao unificada: senhas, status, diagnostico e dados dos participantes</p>
                        </div>
                        <a href="ferramentas.html" class="btn-voltar">
                            <span class="material-icons">arrow_back</span>
                            Voltar
                        </a>
                    </header>

                    <!-- Stats Dashboard -->
                    <div class="stats-grid" id="statsGrid">
                        <div class="stat-card">
                            <div class="stat-icon"><span class="material-icons">people</span></div>
                            <div class="stat-value" id="statTotal">-</div>
                            <div class="stat-label">Total</div>
                        </div>
                        <div class="stat-card sucesso">
                            <div class="stat-icon"><span class="material-icons">check_circle</span></div>
                            <div class="stat-value" id="statAtivos">-</div>
                            <div class="stat-label">Ativos</div>
                        </div>
                        <div class="stat-card perigo">
                            <div class="stat-icon"><span class="material-icons">cancel</span></div>
                            <div class="stat-value" id="statInativos">-</div>
                            <div class="stat-label">Inativos</div>
                        </div>
                        <div class="stat-card info">
                            <div class="stat-icon"><span class="material-icons">lock</span></div>
                            <div class="stat-value" id="statComSenha">-</div>
                            <div class="stat-label">Com Senha</div>
                        </div>
                        <div class="stat-card alerta">
                            <div class="stat-icon"><span class="material-icons">lock_open</span></div>
                            <div class="stat-value" id="statSemSenha">-</div>
                            <div class="stat-label">Sem Senha</div>
                        </div>
                        <div class="stat-card perigo">
                            <div class="stat-icon"><span class="material-icons">warning</span></div>
                            <div class="stat-value" id="statIncompletos">-</div>
                            <div class="stat-label">Incompletos</div>
                        </div>
                    </div>

                    <!-- Resumo por Liga -->
                    <div class="ligas-resumo" id="ligasResumo"></div>

                    <!-- Filtros -->
                    <div class="filtros-bar">
                        <div class="filtro-grupo">
                            <label>Liga</label>
                            <select class="filtro-select" id="filtroLiga">
                                <option value="">Todas</option>
                            </select>
                        </div>

                        <div class="filtro-grupo">
                            <label>Status</label>
                            <select class="filtro-select" id="filtroStatus">
                                <option value="">Todos</option>
                                <option value="ativo">Ativos</option>
                                <option value="inativo">Inativos</option>
                            </select>
                        </div>

                        <div class="filtro-grupo">
                            <label>Senha</label>
                            <select class="filtro-select" id="filtroSenha">
                                <option value="">Todos</option>
                                <option value="com">Com Senha</option>
                                <option value="sem">Sem Senha</option>
                            </select>
                        </div>

                        <div class="filtro-separator"></div>

                        <div class="filtro-grupo" style="flex: 1;">
                            <span class="material-icons" style="color: #6b7280; font-size: 18px;">search</span>
                            <input type="text" class="filtro-input" id="filtroBusca" placeholder="Buscar por nome, time ou ID..." style="flex: 1;" />
                        </div>

                        <div class="filtro-separator"></div>

                        <button class="btn-filtro-secundario" id="btnExportarCSV" title="Exportar lista">
                            <span class="material-icons">download</span>
                            CSV
                        </button>

                        <button class="btn-filtro-acao" id="btnSenhaLote" title="Definir senhas em lote">
                            <span class="material-icons">vpn_key</span>
                            Senhas em Lote
                        </button>
                    </div>

                    <!-- Tabela -->
                    <div class="tabela-container">
                        <div class="tabela-header">
                            <h3>Participantes</h3>
                            <span class="tabela-count" id="tabelaCount">0</span>
                        </div>
                        <div class="tabela-scroll">
                            <table class="participantes-table">
                                <thead>
                                    <tr>
                                        <th>Participante</th>
                                        <th>ID</th>
                                        <th>Liga</th>
                                        <th>Status</th>
                                        <th>Senha</th>
                                        <th>Dados</th>
                                        <th>Acoes</th>
                                    </tr>
                                </thead>
                                <tbody id="tabelaBody">
                                    <tr>
                                        <td colspan="7">
                                            <div class="loading-state">
                                                <div class="loading-spinner"></div>
                                                <div>Carregando participantes...</div>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <!-- Modal Editar Senha -->
                    <div class="modal-overlay" id="modalSenha">
                        <div class="modal-content">
                            <h3 class="modal-title">
                                <span class="material-icons">vpn_key</span>
                                Definir Senha
                            </h3>
                            <div id="modalSenhaInfo" style="font-size: 0.8rem; color: #9ca3af; margin-bottom: 12px;"></div>
                            <div class="modal-field">
                                <label>Nova Senha</label>
                                <input type="text" id="modalSenhaInput" placeholder="Min. 3 caracteres" autocomplete="off" />
                            </div>
                            <div class="modal-actions">
                                <button class="modal-btn-primary" id="modalSenhaSalvar">Salvar</button>
                                <button class="modal-btn-secondary" id="modalSenhaFechar">Cancelar</button>
                            </div>
                        </div>
                    </div>

                    <!-- Modal Senha em Lote -->
                    <div class="modal-overlay" id="modalSenhaLote">
                        <div class="modal-content">
                            <h3 class="modal-title">
                                <span class="material-icons">vpn_key</span>
                                Senhas em Lote
                            </h3>
                            <p style="font-size: 0.8rem; color: #9ca3af; margin-bottom: 12px;">
                                Aplica uma senha padrao para todos os participantes <strong>sem senha definida</strong> no filtro atual.
                            </p>
                            <div class="modal-field">
                                <label>Senha Padrao</label>
                                <input type="text" id="modalLoteSenhaInput" placeholder="Ex: cartola2026" autocomplete="off" />
                            </div>
                            <div id="modalLotePreview" style="font-size: 0.75rem; color: #6b7280; margin-bottom: 8px;"></div>
                            <div class="modal-actions">
                                <button class="modal-btn-primary" id="modalLoteSalvar">Aplicar</button>
                                <button class="modal-btn-secondary" id="modalLoteFechar">Cancelar</button>
                            </div>
                        </div>
                    </div>

                </div>

                <!-- Modal Editar Senha -->
                <div class="modal-overlay" id="modalSenha">
                    <div class="modal-content">
                        <h3 class="modal-title">
                            <span class="material-icons">vpn_key</span>
                            Definir Senha
                        </h3>
                        <div id="modalSenhaInfo" style="font-size: 0.8rem; color: #9ca3af; margin-bottom: 12px;"></div>
                        <div class="modal-field">
                            <label>Nova Senha</label>
                            <input type="text" id="modalSenhaInput" placeholder="Min. 3 caracteres" autocomplete="off" />
                        </div>
                        <div class="modal-actions">
                            <button class="modal-btn-primary" id="modalSenhaSalvar">Salvar</button>
                            <button class="modal-btn-secondary" id="modalSenhaFechar">Cancelar</button>
                        </div>
                    </div>
                </div>

                <!-- Modal Senha em Lote -->
                <div class="modal-overlay" id="modalSenhaLote">
                    <div class="modal-content">
                        <h3 class="modal-title">
                            <span class="material-icons">vpn_key</span>
                            Senhas em Lote
                        </h3>
                        <p style="font-size: 0.8rem; color: #9ca3af; margin-bottom: 12px;">
                            Aplica uma senha padrao para todos os participantes <strong>sem senha definida</strong> no filtro atual.
                        </p>
                        <div class="modal-field">
                            <label>Senha Padrao</label>
                            <input type="text" id="modalLoteSenhaInput" placeholder="Ex: cartola2026" autocomplete="off" />
                        </div>
                        <div id="modalLotePreview" style="font-size: 0.75rem; color: #6b7280; margin-bottom: 8px;"></div>
                        <div class="modal-actions">
                            <button class="modal-btn-primary" id="modalLoteSalvar">Aplicar</button>
                            <button class="modal-btn-secondary" id="modalLoteFechar">Cancelar</button>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- Scripts -->
        <script type="module">
            // Layout loader (padrão do projeto)
            async function loadLayout() {
                try {
                    // ✅ FIX: Não recarregar layout se já existe sidebar (navegação SPA)
                    if (document.querySelector('.app-sidebar')) {
                        console.log("[ANALISAR-PARTICIPANTES] Sidebar já existe, pulando loadLayout");
                        return;
                    }

                    const response = await fetch("layout.html");
                    const layoutHtml = await response.text();
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(layoutHtml, "text/html");

                    const sidebar = doc.querySelector(".app-sidebar");
                    if (sidebar) {
                        document.getElementById("sidebar-placeholder")?.replaceWith(sidebar);
                    }

                    // ✅ FIX: Só injetar scripts do layout na PRIMEIRA carga
                    if (!window.__layoutScriptsInjected) {
                        window.__layoutScriptsInjected = true;
                        const scripts = doc.querySelectorAll("script");
                        scripts.forEach((script) => {
                            if (script.textContent.trim()) {
                                const newScript = document.createElement("script");
                                newScript.textContent = `(function(){${script.textContent}})();`;
                                document.head.appendChild(newScript);
                            }
                        });
                    }

                    setTimeout(() => {
                        if (window.AccordionManager && !window.AccordionManager._initialized) {
                            window.AccordionManager.init();
                        }
                        if (typeof window.verificarMenuSuperAdmin === 'function') {
                            window.verificarMenuSuperAdmin();
                        }
                    }, 150);
                } catch (error) {
                    console.error("Erro ao carregar layout:", error);
                }
            }

            loadLayout();
        </script>

        <script src="js/analisar-participantes.js"></script>
    </body>
</html>
