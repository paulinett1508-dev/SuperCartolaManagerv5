<!doctype html>
<html lang="pt-BR">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Cadastro de Participantes - Super Cartola Manager</title>
        <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
        <!-- Design Tokens (SEMPRE PRIMEIRO) -->
        <link rel="stylesheet" href="css/_admin-tokens.css" />
        <link rel="stylesheet" href="style.css" />
        <link rel="stylesheet" href="css/modules/dashboard-redesign.css" />
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Russo+One&display=swap" rel="stylesheet" />
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
        <style>
            /* ============================================================
               CADASTRO DE PARTICIPANTES - Design Moderno
               ============================================================ */

            .cadastro-page {
                background: #121212;
                min-height: 100vh;
            }

            .cadastro-content {
                padding: 20px 16px;
                max-width: 1000px;
                margin: 0 auto;
            }

            /* Header */
            .cadastro-header {
                background: #1a1a1a;
                border-radius: 10px;
                padding: 18px 20px;
                margin-bottom: 20px;
                border: 1px solid #2d2d2d;
                display: flex;
                align-items: center;
                gap: 16px;
            }

            .cadastro-header-back {
                width: 36px;
                height: 36px;
                border-radius: 50%;
                background: rgba(255, 85, 0, 0.1);
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                transition: all 0.3s ease;
                border: none;
            }

            .cadastro-header-back:hover {
                background: #FF5500;
            }

            .cadastro-header-back .material-icons {
                color: #FF5500;
                font-size: 20px;
                transition: color 0.3s ease;
            }

            .cadastro-header-back:hover .material-icons {
                color: #ffffff;
            }

            .cadastro-header-info h1 {
                font-size: 1.35rem;
                font-weight: 700;
                color: #ffffff;
                margin: 0 0 4px 0;
            }

            .cadastro-header-info p {
                font-size: 0.8rem;
                color: #9ca3af;
                margin: 0;
            }

            /* Sections */
            .cadastro-section {
                background: #1a1a1a;
                border-radius: 10px;
                border: 1px solid #2d2d2d;
                padding: 20px;
                margin-bottom: 20px;
            }

            .cadastro-section-header {
                display: flex;
                align-items: center;
                gap: 12px;
                margin-bottom: 16px;
            }

            .cadastro-section-header .material-icons {
                color: #FF5500;
                font-size: 24px;
            }

            .cadastro-section-header h2 {
                font-size: 1rem;
                font-weight: 700;
                color: #ffffff;
                margin: 0;
            }

            /* Search Box */
            .search-box {
                display: flex;
                gap: 12px;
                margin-bottom: 16px;
            }

            .search-type-toggle {
                display: flex;
                background: #252525;
                border-radius: 8px;
                padding: 4px;
            }

            .search-type-btn {
                padding: 8px 16px;
                border: none;
                background: transparent;
                color: #9ca3af;
                font-size: 0.8rem;
                font-weight: 600;
                cursor: pointer;
                border-radius: 6px;
                transition: all 0.2s ease;
            }

            .search-type-btn.active {
                background: #FF5500;
                color: #ffffff;
            }

            .search-input-wrapper {
                flex: 1;
                display: flex;
                gap: 8px;
            }

            .search-input {
                flex: 1;
                background: #252525;
                border: 1px solid #3d3d3d;
                border-radius: 8px;
                padding: 10px 14px;
                color: #ffffff;
                font-size: 0.9rem;
            }

            .search-input:focus {
                outline: none;
                border-color: #FF5500;
            }

            .search-input::placeholder {
                color: #6b7280;
            }

            .search-btn {
                background: #FF5500;
                color: #ffffff;
                border: none;
                border-radius: 8px;
                padding: 10px 20px;
                font-weight: 600;
                font-size: 0.85rem;
                cursor: pointer;
                display: flex;
                align-items: center;
                gap: 6px;
                transition: all 0.2s ease;
            }

            .search-btn:hover {
                background: #ff7733;
            }

            .search-btn:disabled {
                background: #3d3d3d;
                cursor: not-allowed;
            }

            /* Search Result */
            .search-result {
                display: none;
                background: #252525;
                border-radius: 10px;
                padding: 16px;
                margin-bottom: 16px;
            }

            .search-result.active {
                display: block;
            }

            .result-card {
                display: flex;
                align-items: center;
                gap: 16px;
            }

            .result-escudo {
                width: 60px;
                height: 60px;
                border-radius: 8px;
                object-fit: contain;
                background: #1a1a1a;
                padding: 8px;
            }

            .result-info {
                flex: 1;
            }

            .result-nome {
                font-size: 1.1rem;
                font-weight: 700;
                color: #ffffff;
                margin-bottom: 4px;
            }

            .result-cartoleiro {
                font-size: 0.85rem;
                color: #9ca3af;
                margin-bottom: 2px;
            }

            .result-id {
                font-size: 0.75rem;
                color: #6b7280;
            }

            /* Form Fields */
            .form-row {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 16px;
                margin-bottom: 16px;
            }

            @media (max-width: 600px) {
                .form-row {
                    grid-template-columns: 1fr;
                }
            }

            .form-group {
                margin-bottom: 16px;
            }

            .form-group label {
                display: block;
                font-size: 0.8rem;
                font-weight: 600;
                color: #9ca3af;
                margin-bottom: 6px;
            }

            .form-group select,
            .form-group input {
                width: 100%;
                background: #252525;
                border: 1px solid #3d3d3d;
                border-radius: 8px;
                padding: 10px 14px;
                color: #ffffff;
                font-size: 0.9rem;
            }

            .form-group select:focus,
            .form-group input:focus {
                outline: none;
                border-color: #FF5500;
            }

            /* Liga Checkboxes */
            .ligas-list {
                max-height: 200px;
                overflow-y: auto;
                background: #252525;
                border-radius: 8px;
                padding: 12px;
            }

            .liga-checkbox {
                display: flex;
                align-items: center;
                gap: 10px;
                padding: 8px 10px;
                border-radius: 6px;
                cursor: pointer;
                transition: background 0.2s ease;
            }

            .liga-checkbox:hover {
                background: #1a1a1a;
            }

            .liga-checkbox input[type="checkbox"] {
                width: 18px;
                height: 18px;
                accent-color: #FF5500;
            }

            .liga-checkbox span {
                font-size: 0.9rem;
                color: #ffffff;
            }

            /* Buttons */
            .form-actions {
                display: flex;
                justify-content: flex-end;
                gap: 12px;
                margin-top: 20px;
            }

            .btn-primary {
                background: #FF5500;
                color: #ffffff;
                border: none;
                border-radius: 8px;
                padding: 12px 24px;
                font-weight: 600;
                font-size: 0.9rem;
                cursor: pointer;
                display: flex;
                align-items: center;
                gap: 8px;
                transition: all 0.2s ease;
            }

            .btn-primary:hover {
                background: #ff7733;
            }

            .btn-primary:disabled {
                background: #3d3d3d;
                cursor: not-allowed;
            }

            .btn-secondary {
                background: transparent;
                color: #9ca3af;
                border: 1px solid #3d3d3d;
                border-radius: 8px;
                padding: 12px 24px;
                font-weight: 600;
                font-size: 0.9rem;
                cursor: pointer;
                transition: all 0.2s ease;
            }

            .btn-secondary:hover {
                border-color: #FF5500;
                color: #FF5500;
            }

            /* Participants Table */
            .participants-table-wrapper {
                overflow-x: auto;
            }

            .participants-table {
                width: 100%;
                border-collapse: collapse;
            }

            .participants-table th {
                text-align: left;
                padding: 12px;
                font-size: 0.75rem;
                font-weight: 600;
                color: #9ca3af;
                text-transform: uppercase;
                letter-spacing: 0.05em;
                border-bottom: 1px solid #2d2d2d;
            }

            .participants-table td {
                padding: 12px;
                font-size: 0.9rem;
                color: #ffffff;
                border-bottom: 1px solid #2d2d2d;
            }

            .participants-table tr:hover td {
                background: #252525;
            }

            .participant-row-info {
                display: flex;
                align-items: center;
                gap: 12px;
            }

            .participant-row-escudo {
                width: 36px;
                height: 36px;
                border-radius: 6px;
                object-fit: contain;
                background: #252525;
                padding: 4px;
            }

            .participant-row-name {
                font-weight: 600;
            }

            .participant-row-cartoleiro {
                font-size: 0.8rem;
                color: #9ca3af;
            }

            .badge-ligas {
                background: rgba(255, 85, 0, 0.1);
                color: #FF5500;
                padding: 4px 10px;
                border-radius: 20px;
                font-size: 0.75rem;
                font-weight: 600;
            }

            .badge-sem-liga {
                background: rgba(239, 68, 68, 0.1);
                color: #ef4444;
            }

            .action-btn {
                background: transparent;
                border: none;
                color: #9ca3af;
                padding: 6px;
                border-radius: 6px;
                cursor: pointer;
                transition: all 0.2s ease;
            }

            .action-btn:hover {
                background: #FF5500;
                color: #ffffff;
            }

            /* Filter Tabs */
            .filter-tabs {
                display: flex;
                gap: 8px;
                margin-bottom: 16px;
            }

            .filter-tab {
                padding: 8px 16px;
                background: #252525;
                border: 1px solid #3d3d3d;
                border-radius: 20px;
                color: #9ca3af;
                font-size: 0.8rem;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.2s ease;
            }

            .filter-tab.active {
                background: #FF5500;
                border-color: #FF5500;
                color: #ffffff;
            }

            .filter-tab:hover:not(.active) {
                border-color: #FF5500;
                color: #FF5500;
            }

            /* Empty State */
            .empty-state {
                text-align: center;
                padding: 40px 20px;
            }

            .empty-state .material-icons {
                font-size: 48px;
                color: #3d3d3d;
                margin-bottom: 16px;
            }

            .empty-state p {
                color: #6b7280;
                font-size: 0.9rem;
            }

            /* Loading */
            .loading-spinner {
                display: none;
                width: 20px;
                height: 20px;
                border: 2px solid #ffffff;
                border-top-color: transparent;
                border-radius: 50%;
                animation: spin 0.8s linear infinite;
            }

            @keyframes spin {
                to { transform: rotate(360deg); }
            }

            .loading-active .loading-spinner {
                display: inline-block;
            }

            .loading-active .btn-text {
                display: none;
            }

            /* Alert Toast */
            .alert-toast {
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%) translateY(100px);
                background: #1a1a1a;
                border: 1px solid #2d2d2d;
                border-radius: 8px;
                padding: 12px 20px;
                display: flex;
                align-items: center;
                gap: 10px;
                z-index: 1000;
                transition: transform 0.3s ease;
            }

            .alert-toast.active {
                transform: translateX(-50%) translateY(0);
            }

            .alert-toast.success {
                border-color: #10b981;
            }

            .alert-toast.success .material-icons {
                color: #10b981;
            }

            .alert-toast.error {
                border-color: #ef4444;
            }

            .alert-toast.error .material-icons {
                color: #ef4444;
            }

            .alert-toast span {
                color: #ffffff;
                font-size: 0.9rem;
            }

            /* Modal Vincular Liga */
            .modal-overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.7);
                z-index: 999;
                align-items: center;
                justify-content: center;
            }

            .modal-overlay.active {
                display: flex;
            }

            .modal-content {
                background: #1a1a1a;
                border-radius: 12px;
                border: 1px solid #2d2d2d;
                width: 90%;
                max-width: 450px;
                max-height: 80vh;
                overflow: hidden;
            }

            .modal-header {
                display: flex;
                align-items: center;
                justify-content: space-between;
                padding: 16px 20px;
                border-bottom: 1px solid #2d2d2d;
            }

            .modal-header h3 {
                font-size: 1rem;
                font-weight: 700;
                color: #ffffff;
                margin: 0;
            }

            .modal-close {
                background: transparent;
                border: none;
                color: #9ca3af;
                cursor: pointer;
                padding: 4px;
            }

            .modal-close:hover {
                color: #FF5500;
            }

            .modal-body {
                padding: 20px;
                max-height: 400px;
                overflow-y: auto;
            }

            .modal-footer {
                display: flex;
                justify-content: flex-end;
                gap: 12px;
                padding: 16px 20px;
                border-top: 1px solid #2d2d2d;
            }
        </style>
    </head>

    <body>
        <div class="app-container">
            <div id="sidebar-placeholder"></div>

            <main class="app-main cadastro-page">
                <div class="cadastro-content">
                    <!-- Header -->
                    <header class="cadastro-header">
                        <button class="cadastro-header-back" onclick="window.location.href='ferramentas.html'">
                            <span class="material-icons">arrow_back</span>
                        </button>
                        <div class="cadastro-header-info">
                            <h1>Cadastro de Participantes</h1>
                            <p>Adicione participantes ao pool global e vincule a ligas.</p>
                        </div>
                    </header>

                    <!-- Buscar Participante -->
                    <section class="cadastro-section">
                        <div class="cadastro-section-header">
                            <span class="material-icons">person_search</span>
                            <h2>Buscar Participante</h2>
                        </div>

                        <div class="search-box">
                            <div class="search-type-toggle">
                                <button class="search-type-btn active" data-type="nome">Nome</button>
                                <button class="search-type-btn" data-type="id">ID</button>
                            </div>
                            <div class="search-input-wrapper">
                                <input type="text" class="search-input" id="searchInput" placeholder="Digite o nome do time...">
                                <button class="search-btn" id="searchBtn">
                                    <span class="material-icons">search</span>
                                    <span class="btn-text">Buscar</span>
                                    <span class="loading-spinner"></span>
                                </button>
                            </div>
                        </div>

                        <!-- Resultado da Busca -->
                        <div class="search-result" id="searchResult">
                            <div class="result-card">
                                <img src="/escudos/default.png" alt="Escudo" class="result-escudo" id="resultEscudo">
                                <div class="result-info">
                                    <div class="result-nome" id="resultNome">--</div>
                                    <div class="result-cartoleiro" id="resultCartoleiro">--</div>
                                    <div class="result-id" id="resultId">ID: --</div>
                                </div>
                            </div>

                            <!-- Form de Cadastro -->
                            <div class="form-row" style="margin-top: 20px;">
                                <div class="form-group">
                                    <label>Temporada</label>
                                    <select id="temporadaSelect">
                                        <option value="2026" selected>2026</option>
                                        <option value="2025">2025</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Contato (opcional)</label>
                                    <input type="text" id="contatoInput" placeholder="WhatsApp/Telefone">
                                </div>
                            </div>

                            <div class="form-group">
                                <label>Vincular a Ligas (opcional)</label>
                                <div class="ligas-list" id="ligasList">
                                    <div class="empty-state">
                                        <p>Carregando ligas...</p>
                                    </div>
                                </div>
                            </div>

                            <div class="form-actions">
                                <button class="btn-secondary" onclick="limparResultado()">Cancelar</button>
                                <button class="btn-primary" id="cadastrarBtn" onclick="cadastrarParticipante()">
                                    <span class="material-icons">person_add</span>
                                    <span class="btn-text">Cadastrar Participante</span>
                                    <span class="loading-spinner"></span>
                                </button>
                            </div>
                        </div>
                    </section>

                    <!-- Lista de Participantes -->
                    <section class="cadastro-section">
                        <div class="cadastro-section-header">
                            <span class="material-icons">groups</span>
                            <h2>Participantes Cadastrados</h2>
                        </div>

                        <div class="filter-tabs">
                            <button class="filter-tab active" data-filter="todos">Todos</button>
                            <button class="filter-tab" data-filter="sem-liga">Sem Liga</button>
                            <button class="filter-tab" data-filter="com-liga">Com Liga</button>
                        </div>

                        <div class="participants-table-wrapper">
                            <table class="participants-table">
                                <thead>
                                    <tr>
                                        <th>Participante</th>
                                        <th>Temporada</th>
                                        <th>Ligas</th>
                                        <th>Acoes</th>
                                    </tr>
                                </thead>
                                <tbody id="participantesBody">
                                    <tr>
                                        <td colspan="4">
                                            <div class="empty-state">
                                                <span class="material-icons">person_off</span>
                                                <p>Nenhum participante cadastrado ainda.</p>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </section>
                </div>
            </main>
        </div>

        <!-- Modal Vincular Liga -->
        <div class="modal-overlay" id="modalVincular">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Vincular a Liga</h3>
                    <button class="modal-close" onclick="fecharModalVincular()">
                        <span class="material-icons">close</span>
                    </button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="modalTimeId">
                    <div class="ligas-list" id="modalLigasList">
                        <div class="empty-state">
                            <p>Carregando ligas...</p>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary" onclick="fecharModalVincular()">Cancelar</button>
                    <button class="btn-primary" onclick="salvarVinculos()">
                        <span class="material-icons">link</span>
                        Salvar Vinculos
                    </button>
                </div>
            </div>
        </div>

        <!-- Alert Toast -->
        <div class="alert-toast" id="alertToast">
            <span class="material-icons">check_circle</span>
            <span id="alertMessage">Mensagem</span>
        </div>

        <!-- Scripts -->
        <script src="js/layout-loader.js"></script>
        <script src="js/cadastro/cadastro-participantes.js"></script>
    </body>
</html>
