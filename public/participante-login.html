<!doctype html>
<html class="dark" lang="pt-BR">
    <head>
        <meta charset="utf-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0, user-scalable=no"
        />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="mobile-web-app-capable" content="yes" />
        <title>Login - Super Cartola</title>

        <!-- Fonts -->
        <link href="https://fonts.googleapis.com" rel="preconnect" />
        <link
            crossorigin=""
            href="https://fonts.gstatic.com"
            rel="preconnect"
        />
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap"
            rel="stylesheet"
        />
        <link
            href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
            rel="stylesheet"
        />

        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            :root {
                --primary: #ff4500;
                --primary-light: #ff6a33;
                --background-dark: #0d0d0d;
                --surface: #1c1c1e;
            }

            .material-symbols-outlined {
                font-variation-settings:
                    "FILL" 0,
                    "wght" 400,
                    "GRAD" 0,
                    "opsz" 24;
            }

            body {
                font-family:
                    "Inter",
                    -apple-system,
                    BlinkMacSystemFont,
                    "Segoe UI",
                    Roboto,
                    sans-serif;
                min-height: 100dvh;
                background: linear-gradient(180deg, #0d0d0d 0%, #1a1a1a 100%);
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 16px;
                color: #fff;
            }

            /* Logo Glow Effect */
            .logo-glow {
                box-shadow:
                    0 0 60px rgba(255, 69, 0, 0.3),
                    0 0 100px rgba(255, 69, 0, 0.1);
            }

            /* Float Animation */
            @keyframes float {
                0%,
                100% {
                    transform: translateY(0);
                }
                50% {
                    transform: translateY(-4px);
                }
            }
            .logo-float {
                animation: float 3s ease-in-out infinite;
            }

            /* Input Focus Glow */
            .input-glow:focus {
                box-shadow: 0 0 0 3px rgba(255, 69, 0, 0.2);
            }

            /* Gradient Button */
            .btn-gradient {
                background: linear-gradient(135deg, #ff4500 0%, #ff6a33 100%);
                box-shadow: 0 4px 20px rgba(255, 69, 0, 0.4);
                transition: all 0.2s ease;
            }
            .btn-gradient:hover {
                box-shadow: 0 6px 30px rgba(255, 69, 0, 0.5);
            }
            .btn-gradient:active {
                transform: scale(0.98);
            }
            .btn-gradient:disabled {
                opacity: 0.7;
                cursor: not-allowed;
            }

            /* Line Decoration */
            .line-decoration {
                background: linear-gradient(
                    90deg,
                    transparent,
                    rgba(255, 69, 0, 0.3),
                    transparent
                );
            }

            /* Container */
            .login-container {
                width: 100%;
                max-width: 380px;
                text-align: center;
            }

            /* Logo Section */
            .logo-section {
                margin-bottom: 32px;
                display: flex;
                flex-direction: column;
                align-items: center;
            }

            .logo-box {
                position: relative;
                width: 112px;
                height: 112px;
                border-radius: 50%;
                background: var(--surface);
                display: flex;
                align-items: center;
                justify-content: center;
                margin-bottom: 16px;
            }

            .logo-badge {
                position: absolute;
                bottom: -4px;
                right: -4px;
                width: 40px;
                height: 40px;
                border-radius: 50%;
                background: var(--primary);
                display: flex;
                align-items: center;
                justify-content: center;
                box-shadow: 0 4px 12px rgba(255, 69, 0, 0.4);
            }

            .title {
                font-size: 28px;
                font-weight: 700;
                letter-spacing: -0.5px;
            }

            .title-white {
                color: #fff;
            }
            .title-primary {
                color: var(--primary);
            }

            .subtitle {
                margin-top: 8px;
                font-size: 14px;
                color: rgba(255, 255, 255, 0.5);
            }

            .line-divider {
                margin-top: 16px;
                height: 1px;
                width: 128px;
            }

            /* Form */
            .login-form {
                margin-top: 32px;
                display: flex;
                flex-direction: column;
                gap: 16px;
            }

            .input-wrapper {
                position: relative;
                display: flex;
                align-items: center;
            }

            .input-icon {
                position: absolute;
                left: 16px;
                color: rgba(255, 255, 255, 0.4);
                font-size: 22px;
                pointer-events: none;
            }

            .input-field {
                width: 100%;
                height: 56px;
                padding: 16px 48px 16px 52px;
                border-radius: 12px;
                border: 1px solid rgba(255, 255, 255, 0.1);
                background: var(--surface);
                font-family: inherit;
                font-size: 16px;
                color: #fff;
                transition: all 0.2s ease;
            }

            .input-field::placeholder {
                color: rgba(255, 255, 255, 0.3);
            }

            .input-field:focus {
                outline: none;
                border-color: rgba(255, 69, 0, 0.5);
            }

            .toggle-password {
                position: absolute;
                right: 16px;
                background: none;
                border: none;
                color: rgba(255, 255, 255, 0.4);
                cursor: pointer;
                padding: 4px;
                transition: color 0.2s;
            }

            .toggle-password:hover {
                color: rgba(255, 255, 255, 0.6);
            }

            /* Options Row */
            .options-row {
                display: flex;
                align-items: center;
                justify-content: space-between;
                padding: 0 4px;
                margin-top: 4px;
            }

            .remember-me {
                display: flex;
                align-items: center;
                gap: 8px;
                cursor: pointer;
            }

            .remember-me input {
                width: 16px;
                height: 16px;
                accent-color: var(--primary);
                cursor: pointer;
            }

            .remember-me span {
                font-size: 14px;
                color: rgba(255, 255, 255, 0.5);
            }

            /* Tooltip */
            .tooltip-container {
                position: relative;
            }

            .tooltip-trigger {
                background: none;
                border: none;
                font-family: inherit;
                font-size: 14px;
                color: rgba(255, 69, 0, 0.8);
                cursor: pointer;
                transition: color 0.2s;
            }

            .tooltip-trigger:hover {
                color: var(--primary);
            }

            .tooltip-content {
                visibility: hidden;
                opacity: 0;
                position: absolute;
                bottom: 100%;
                right: 0;
                margin-bottom: 8px;
                padding: 12px 14px;
                background: var(--surface);
                border: 1px solid rgba(255, 69, 0, 0.3);
                border-radius: 10px;
                width: 240px;
                text-align: left;
                box-shadow: 0 8px 30px rgba(0, 0, 0, 0.5);
                transition: all 0.2s ease;
                z-index: 100;
            }

            .tooltip-content::after {
                content: "";
                position: absolute;
                top: 100%;
                right: 20px;
                border: 6px solid transparent;
                border-top-color: rgba(255, 69, 0, 0.3);
            }

            .tooltip-container:hover .tooltip-content,
            .tooltip-container:focus-within .tooltip-content {
                visibility: visible;
                opacity: 1;
            }

            .tooltip-header {
                display: flex;
                align-items: flex-start;
                gap: 8px;
            }

            .tooltip-icon {
                flex-shrink: 0;
                margin-top: 2px;
                font-size: 18px;
                color: var(--primary);
            }

            .tooltip-title {
                font-size: 12px;
                font-weight: 600;
                color: var(--primary);
                margin-bottom: 4px;
            }

            .tooltip-text {
                font-size: 12px;
                color: rgba(255, 255, 255, 0.6);
                line-height: 1.5;
            }

            /* Submit Button */
            .submit-btn {
                display: flex;
                width: 100%;
                height: 56px;
                align-items: center;
                justify-content: center;
                gap: 8px;
                border-radius: 12px;
                border: none;
                font-family: inherit;
                font-size: 18px;
                font-weight: 700;
                color: #fff;
                cursor: pointer;
                margin-top: 16px;
                letter-spacing: 0.5px;
            }

            /* Error Message */
            .error-message {
                display: none;
                background: rgba(239, 68, 68, 0.1);
                border: 1px solid rgba(239, 68, 68, 0.3);
                border-left: 4px solid #ef4444;
                border-radius: 8px;
                padding: 12px 14px;
                margin-top: 16px;
                text-align: left;
            }

            .error-message.show {
                display: block;
            }

            .error-text {
                font-size: 14px;
                color: #ef4444;
            }

            /* Loading */
            .loading-text {
                display: none;
                margin-top: 16px;
                font-size: 14px;
                color: rgba(255, 255, 255, 0.5);
            }

            .loading-text.show {
                display: block;
            }

            /* Footer */
            .footer {
                margin-top: 64px;
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 8px;
            }

            .footer-brand {
                display: flex;
                align-items: center;
                gap: 8px;
                font-size: 14px;
                color: rgba(255, 255, 255, 0.3);
            }

            .footer-brand .material-symbols-outlined {
                font-size: 16px;
                color: rgba(255, 69, 0, 0.6);
            }

            .footer-brand-name {
                font-weight: 500;
            }

            .footer-version {
                color: rgba(255, 255, 255, 0.2);
            }

            .footer-copy {
                display: flex;
                align-items: center;
                gap: 12px;
                font-size: 12px;
                color: rgba(255, 255, 255, 0.2);
            }

            .footer-badge {
                padding: 2px 8px;
                border-radius: 4px;
                background: rgba(255, 69, 0, 0.1);
                color: rgba(255, 69, 0, 0.7);
                font-weight: 600;
                font-size: 11px;
            }

            /* Responsive */
            @media (max-width: 400px) {
                .title {
                    font-size: 24px;
                }

                .logo-box {
                    width: 96px;
                    height: 96px;
                }

                .logo-badge {
                    width: 36px;
                    height: 36px;
                }
            }
        </style>
    </head>

    <body>
        <div class="login-container">
            <!-- Logo Section -->
            <div class="logo-section">
                <div class="logo-box logo-glow">
                    <div class="logo-float">
                        <span
                            class="material-symbols-outlined"
                            style="
                                font-size: 64px;
                                color: var(--primary);
                                font-variation-settings:
                                    &quot;FILL&quot; 1,
                                    &quot;wght&quot; 300,
                                    &quot;opsz&quot; 48;
                            "
                        >
                            sports_soccer
                        </span>
                    </div>
                    <div class="logo-badge">
                        <span
                            class="material-symbols-outlined"
                            style="
                                font-size: 20px;
                                color: #fff;
                                font-variation-settings:
                                    &quot;FILL&quot; 1,
                                    &quot;wght&quot; 500;
                            "
                        >
                            emoji_events
                        </span>
                    </div>
                </div>

                <h1 class="title">
                    <span class="title-white">Super</span>
                    <span class="title-primary">Cartola</span>
                </h1>
                <p class="subtitle">O melhor fantasy game do Cartola FC</p>

                <div class="line-divider line-decoration"></div>
            </div>

            <!-- Login Form -->
            <form
                class="login-form"
                id="loginForm"
                onsubmit="fazerLogin(event)"
            >
                <!-- ID do Time -->
                <div class="input-wrapper">
                    <span class="material-symbols-outlined input-icon"
                        >badge</span
                    >
                    <input
                        type="number"
                        id="timeId"
                        class="input-field input-glow"
                        placeholder="ID do Time Cartola"
                        required
                        autocomplete="off"
                    />
                </div>

                <!-- Senha -->
                <div class="input-wrapper">
                    <span class="material-symbols-outlined input-icon"
                        >lock</span
                    >
                    <input
                        type="password"
                        id="senha"
                        class="input-field input-glow"
                        placeholder="Senha"
                        required
                        autocomplete="off"
                    />
                    <button
                        type="button"
                        class="toggle-password"
                        onclick="togglePassword()"
                    >
                        <span class="material-symbols-outlined" id="toggleIcon"
                            >visibility_off</span
                        >
                    </button>
                </div>

                <!-- Options -->
                <div class="options-row">
                    <label class="remember-me">
                        <input type="checkbox" id="lembrarMe" />
                        <span>Lembrar-me</span>
                    </label>

                    <div class="tooltip-container">
                        <button type="button" class="tooltip-trigger">
                            Esqueci a senha
                        </button>
                        <div class="tooltip-content">
                            <div class="tooltip-header">
                                <span
                                    class="material-symbols-outlined tooltip-icon"
                                    style="
                                        font-variation-settings: &quot;FILL&quot;
                                            1;
                                    "
                                    >engineering</span
                                >
                                <div>
                                    <p class="tooltip-title">
                                        Em Desenvolvimento
                                    </p>
                                    <p class="tooltip-text">
                                        Se esqueceu sua senha, contate o
                                        administrador da liga.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Submit Button -->
                <button
                    type="submit"
                    class="submit-btn btn-gradient"
                    id="submitBtn"
                >
                    <span
                        class="material-symbols-outlined"
                        style="
                            font-variation-settings:
                                &quot;FILL&quot; 1,
                                &quot;wght&quot; 500;
                        "
                        >login</span
                    >
                    <span>ENTRAR</span>
                </button>
            </form>

            <!-- Loading -->
            <p class="loading-text" id="loading">Aguarde, validando...</p>

            <!-- Error Message -->
            <div class="error-message" id="errorMessage">
                <p class="error-text" id="errorText"></p>
            </div>

            <!-- Footer -->
            <div class="footer">
                <div class="footer-brand">
                    <span
                        class="material-symbols-outlined"
                        style="font-variation-settings: &quot;FILL&quot; 1"
                        >verified</span
                    >
                    <span class="footer-brand-name">Super Cartola Manager</span>
                    <span class="footer-version">v2.0</span>
                </div>
                <div class="footer-copy">
                    <span class="footer-badge">ANO XI</span>
                    <span>¬© 2025 Todos os direitos reservados</span>
                </div>
            </div>
        </div>

        <script>
            // Toggle Password Visibility
            function togglePassword() {
                const senhaInput = document.getElementById("senha");
                const toggleIcon = document.getElementById("toggleIcon");

                if (senhaInput.type === "password") {
                    senhaInput.type = "text";
                    toggleIcon.textContent = "visibility";
                } else {
                    senhaInput.type = "password";
                    toggleIcon.textContent = "visibility_off";
                }
            }

            // Login Function
            async function fazerLogin(event) {
                event.preventDefault();

                const loading = document.getElementById("loading");
                const errorMessage = document.getElementById("errorMessage");
                const errorText = document.getElementById("errorText");
                const submitBtn = document.getElementById("submitBtn");
                const timeId = document.getElementById("timeId").value;
                const senha = document.getElementById("senha").value;

                // Show loading
                loading.classList.add("show");
                errorMessage.classList.remove("show");
                submitBtn.disabled = true;

                try {
                    const response = await fetch(
                        "/api/participante/auth/login",
                        {
                            method: "POST",
                            headers: {
                                "Content-Type": "application/json",
                            },
                            credentials: "include",
                            body: JSON.stringify({ timeId, senha }),
                        },
                    );

                    const data = await response.json();

                    if (!response.ok) {
                        throw new Error(data.error || "Erro ao fazer login");
                    }

                    // Login successful
                    window.location.href = "/participante/";
                } catch (error) {
                    errorText.textContent = error.message;
                    errorMessage.classList.add("show");
                    loading.classList.remove("show");
                    submitBtn.disabled = false;
                }
            }

            // Check if already authenticated
            let verificandoSessao = false;

            window.addEventListener("load", async () => {
                if (verificandoSessao) return;
                verificandoSessao = true;

                try {
                    const response = await fetch(
                        "/api/participante/auth/session",
                        {
                            credentials: "include",
                        },
                    );

                    if (response.ok) {
                        const data = await response.json();
                        if (data.authenticated && data.participante) {
                            console.log(
                                "Sess√£o v√°lida detectada, redirecionando...",
                            );
                            window.location.replace("/participante/");
                            return;
                        }
                    }
                } catch (error) {
                    console.log("Usu√°rio n√£o autenticado");
                } finally {
                    verificandoSessao = false;
                }
            });
        </script>

        <!-- üõ°Ô∏è PROTE√á√ÉO CLIENT-SIDE -->
        <script>
            (function () {
                "use strict";
                var isMobile =
                    /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(
                        navigator.userAgent,
                    );
                if (!isMobile) {
                    document.addEventListener("keydown", function (e) {
                        if (e.key === "F12" || e.keyCode === 123) {
                            e.preventDefault();
                            return false;
                        }
                        if (
                            e.ctrlKey &&
                            e.shiftKey &&
                            (e.key === "I" || e.key === "i" || e.keyCode === 73)
                        ) {
                            e.preventDefault();
                            return false;
                        }
                        if (
                            e.ctrlKey &&
                            e.shiftKey &&
                            (e.key === "J" || e.key === "j" || e.keyCode === 74)
                        ) {
                            e.preventDefault();
                            return false;
                        }
                        if (
                            e.ctrlKey &&
                            e.shiftKey &&
                            (e.key === "C" || e.key === "c" || e.keyCode === 67)
                        ) {
                            e.preventDefault();
                            return false;
                        }
                        if (
                            e.ctrlKey &&
                            (e.key === "U" || e.key === "u" || e.keyCode === 85)
                        ) {
                            e.preventDefault();
                            return false;
                        }
                        if (
                            e.ctrlKey &&
                            (e.key === "S" || e.key === "s" || e.keyCode === 83)
                        ) {
                            e.preventDefault();
                            return false;
                        }
                    });
                    document.addEventListener("contextmenu", function (e) {
                        e.preventDefault();
                        return false;
                    });
                }
                if (window.self !== window.top) {
                    window.top.location = window.self.location;
                }
            })();
        </script>
    </body>
</html>
