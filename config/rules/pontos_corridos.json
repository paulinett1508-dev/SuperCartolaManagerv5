{
  "id": "pontos_corridos",
  "nome": "Pontos Corridos",
  "descricao": "Sistema de confrontos 1x1 em formato de liga, onde cada time enfrenta todos os outros ao longo da temporada.",
  "tipo": "competicao_confronto",
  "status": "ativo",
  "versao": "3.0.0",

  "configuracao": {
    "modulo_ativo": true,
    "formato": "round_robin",
    "defaults": {
      "rodada_inicial": 7,
      "turnos": 1,
      "min_participantes": 4,
      "max_participantes": 64
    }
  },

  "regras": {
    "confrontos": {
      "metodo": "round_robin_ordenado",
      "ordenacao_inicial": "nome_cartola_alfabetico",
      "calculo_oponente": {
        "formula": "(meuIndex + rodadaLiga) % totalTimes",
        "descricao": "Cada rodada, o índice do oponente avança ciclicamente"
      }
    },

    "resultado": {
      "criterio_comparacao": "pontuacao_rodada",
      "tolerancia_empate": 0.3,
      "limite_goleada": 50.0
    },

    "pontuacao_tabela": {
      "vitoria": {
        "pontos": 3,
        "financeiro": 5.00
      },
      "empate": {
        "pontos": 1,
        "financeiro": 3.00,
        "criterio": "diferenca_absoluta <= 0.3"
      },
      "derrota": {
        "pontos": 0,
        "financeiro": -5.00
      },
      "goleada": {
        "bonus_pontos": 1,
        "bonus_financeiro": 2.00,
        "criterio": "diferenca_absoluta >= 50",
        "descricao": "Vitória por 50+ pontos = goleada (+1 pt bônus = 4 pts total + R$2 extra)"
      }
    },

    "classificacao": {
      "ordenacao": [
        { "campo": "pontos", "direcao": "DESC" },
        { "campo": "saldo_gols", "direcao": "DESC" },
        { "campo": "vitorias", "direcao": "DESC" }
      ],
      "campos_calculados": [
        "jogos",
        "vitorias",
        "empates",
        "derrotas",
        "pontos",
        "gols_pro",
        "gols_contra",
        "saldo_gols",
        "pontosGoleada",
        "financeiro"
      ]
    },

    "participantes_inativos": {
      "incluir_confrontos": true,
      "pontuacao_wo": 0,
      "descricao": "Times inativos aparecem separados no fim da classificação"
    },

    "cache": {
      "collection": "pontoscorridoscaches",
      "ttl_minutos": 60,
      "dados_armazenados": ["classificacao", "confrontos"]
    },

    "sistema_grupos": {
      "habilitado": true,
      "descricao": "Sistema de grupos/chaves com fases eliminatórias (Sprint 3 ✅)",
      "quantidade_grupos": 2,
      "min_times_por_grupo": 5,
      "criterio_divisao": "sorteio",
      "classificados_por_grupo": 2,
      "divisao": []
    },

    "fases_eliminatorias": {
      "habilitado": true,
      "descricao": "Playoffs após fase de grupos (Sprint 3 ✅)",
      "tipo": "ida_volta",
      "criterio_desempate": "saldo_gols",
      "bracket": []
    }
  },

  "financeiro": {
    "impacto_banco": true,
    "tipo_transacao": "PONTOS_CORRIDOS",
    "valores": {
      "vitoria_simples": 5.00,
      "vitoria_goleada": 7.00,
      "empate": 3.00,
      "derrota_simples": -5.00,
      "derrota_goleada": -7.00
    },
    "moeda": "BRL",
    "precisao_decimal": 2
  },

  "wizard": {
    "titulo": "Configurar Pontos Corridos",
    "descricao": "Defina valores de vitoria/empate/derrota e regras de goleada",
    "perguntas": [
      {
        "id": "rodada_inicial",
        "tipo": "number",
        "label": "Rodada inicial do Brasileirão",
        "descricao": "A partir de qual rodada do Brasileirão começam os confrontos",
        "default": 7,
        "min": 1,
        "max": 38,
        "step": 1,
        "required": true,
        "afeta": "regras_override.rodada_inicial"
      },
      {
        "id": "turnos",
        "tipo": "select",
        "label": "Quantidade de turnos",
        "descricao": "1 turno = todos contra todos uma vez. 2 turnos = ida e volta",
        "default": 1,
        "options": [
          {"valor": 1, "label": "1 Turno (só ida)"},
          {"valor": 2, "label": "2 Turnos (ida e volta)"}
        ],
        "required": true,
        "afeta": "regras_override.turnos"
      },
      {
        "id": "valor_vitoria",
        "tipo": "number",
        "label": "Valor por vitoria (R$)",
        "descricao": "Premio por vencer um confronto",
        "default": 5,
        "min": 0,
        "max": 50,
        "step": 0.5,
        "required": true,
        "afeta": "financeiro_override.valores_simples.vitoria"
      },
      {
        "id": "valor_empate",
        "tipo": "number",
        "label": "Valor por empate (R$)",
        "descricao": "Valor recebido em caso de empate",
        "default": 3,
        "min": 0,
        "max": 50,
        "step": 0.5,
        "required": true,
        "afeta": "financeiro_override.valores_simples.empate"
      },
      {
        "id": "valor_derrota",
        "tipo": "number",
        "label": "Valor por derrota (R$)",
        "descricao": "Penalidade por perder (valor negativo)",
        "default": -5,
        "min": -50,
        "max": 0,
        "step": 0.5,
        "required": true,
        "afeta": "financeiro_override.valores_simples.derrota"
      },
      {
        "id": "tolerancia_empate",
        "tipo": "number",
        "label": "Tolerancia para empate (pts)",
        "descricao": "Diferenca maxima de pontos para considerar empate",
        "default": 0.3,
        "min": 0,
        "max": 5,
        "step": 0.1,
        "required": true,
        "afeta": "regras.resultado.tolerancia_empate"
      },
      {
        "id": "limite_goleada",
        "tipo": "number",
        "label": "Diferença mínima para goleada (pts)",
        "descricao": "Diferença de pontos necessária para considerar goleada",
        "default": 50,
        "min": 20,
        "max": 100,
        "step": 5,
        "required": true,
        "afeta": "regras_override.limite_goleada"
      },
      {
        "id": "bonus_goleada",
        "tipo": "number",
        "label": "Bônus por goleada (R$)",
        "descricao": "Valor financeiro extra ao vencer por goleada",
        "default": 2,
        "min": 0,
        "max": 20,
        "step": 0.5,
        "required": false,
        "afeta": "regras_override.bonus_goleada"
      },
      {
        "id": "bonus_pontos_goleada",
        "tipo": "number",
        "label": "Bônus em pontos por goleada",
        "descricao": "Pontos extras na tabela por goleada (ex: 1 = 4 pts total)",
        "default": 1,
        "min": 0,
        "max": 3,
        "step": 1,
        "required": false,
        "afeta": "regras_override.bonus_pontos_goleada"
      },
      {
        "id": "formato",
        "tipo": "select",
        "label": "Formato do torneio",
        "descricao": "Escolha entre torneio tradicional ou com grupos e playoffs",
        "default": "round_robin",
        "options": [
          {"valor": "round_robin", "label": "Todos contra Todos (tradicional)"},
          {"valor": "grupos", "label": "Grupos + Playoffs (eliminatórias)"}
        ],
        "required": true,
        "afeta": "regras_override.formato"
      },
      {
        "id": "quantidade_grupos",
        "tipo": "select",
        "label": "Quantidade de grupos",
        "descricao": "Quantos grupos dividir os times (mínimo 5 times por grupo)",
        "default": 2,
        "options": [
          {"valor": 2, "label": "2 grupos"},
          {"valor": 4, "label": "4 grupos"}
        ],
        "required": false,
        "dependeDe": "formato",
        "condicao": "grupos",
        "afeta": "regras_override.sistema_grupos.quantidade_grupos"
      },
      {
        "id": "criterio_divisao",
        "tipo": "select",
        "label": "Como dividir os times em grupos?",
        "descricao": "Sorteio aleatório ou por ranking (seed/serpentina)",
        "default": "sorteio",
        "options": [
          {"valor": "sorteio", "label": "Sorteio aleatório"},
          {"valor": "ranking", "label": "Por ranking (seed)"}
        ],
        "required": false,
        "dependeDe": "formato",
        "condicao": "grupos",
        "afeta": "regras_override.sistema_grupos.criterio_divisao"
      },
      {
        "id": "classificados_por_grupo",
        "tipo": "number",
        "label": "Quantos classificam por grupo?",
        "descricao": "Times que avançam para os playoffs de cada grupo",
        "default": 2,
        "min": 1,
        "max": 4,
        "step": 1,
        "required": false,
        "condicional": {"campo": "formato", "valor": "grupos"},
        "afeta": "regras_override.sistema_grupos.classificados_por_grupo"
      },
      {
        "id": "tipo_playoff",
        "tipo": "select",
        "label": "Tipo de playoff",
        "descricao": "Confrontos de ida e volta ou jogo único?",
        "default": "ida_volta",
        "options": [
          {"valor": "ida_volta", "label": "Ida e Volta"},
          {"valor": "jogo_unico", "label": "Jogo Único"}
        ],
        "required": false,
        "dependeDe": "formato",
        "condicao": "grupos",
        "afeta": "regras_override.fases_eliminatorias.tipo"
      },
      {
        "id": "criterio_desempate_playoff",
        "tipo": "select",
        "label": "Critério de desempate nos playoffs",
        "descricao": "O que usar em caso de empate no agregado?",
        "default": "saldo_gols",
        "options": [
          {"valor": "saldo_gols", "label": "Saldo de gols"},
          {"valor": "gols_fora", "label": "Gols fora de casa"}
        ],
        "required": false,
        "dependeDe": "formato",
        "condicao": "grupos",
        "afeta": "regras_override.fases_eliminatorias.criterio_desempate"
      }
    ]
  },

  "metadados": {
    "criado_em": "2025-12-14",
    "autor": "Sistema",
    "fonte": "controllers/pontosCorridosCacheController.js"
  }
}
